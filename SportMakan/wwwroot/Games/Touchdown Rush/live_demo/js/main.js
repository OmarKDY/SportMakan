/*
 Platform.js
 Copyright 2014-2020 Benjamin Tan
 Copyright 2011-2013 John-David Dalton
 Available under MIT license
*/
(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},g="undefined"!==typeof module&&module.exports,f=function(){for(var c,e=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],b=0,t=e.length,d={};b<t;b++)if((c=e[b])&&c[1]in a){for(b=0;b<c.length;b++)d[e[0][b]]=c[b];return d}return!1}(),k={change:f.fullscreenchange,error:f.fullscreenerror},h={request:function(c){return new Promise(function(e,b){var t=function(){this.off("change",
t);e()}.bind(this);this.on("change",t);c=c||a.documentElement;Promise.resolve(c[f.requestFullscreen]())["catch"](b)}.bind(this))},exit:function(){return new Promise(function(c,e){if(this.isFullscreen){var b=function(){this.off("change",b);c()}.bind(this);this.on("change",b);Promise.resolve(a[f.exitFullscreen]())["catch"](e)}else c()}.bind(this))},toggle:function(c){return this.isFullscreen?this.exit():this.request(c)},onchange:function(c){this.on("change",c)},onerror:function(c){this.on("error",c)},
on:function(c,e){var b=k[c];b&&a.addEventListener(b,e,!1)},off:function(c,e){var b=k[c];b&&a.removeEventListener(b,e,!1)},raw:f};f?(Object.defineProperties(h,{isFullscreen:{get:function(){return!!a[f.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[f.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!a[f.fullscreenEnabled]}}}),g?module.exports=h:window.screenfull=h):g?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})();
(function(){function a(m){m=String(m);return m.charAt(0).toUpperCase()+m.slice(1)}function g(m,y){var A=-1,v=m?m.length:0;if("number"==typeof v&&-1<v&&v<=q)for(;++A<v;)y(m[A],A,m);else k(m,y)}function f(m){m=t(m);return/^(?:webOS|i(?:OS|P))/.test(m)?m:a(m)}function k(m,y){for(var A in m)F.call(m,A)&&y(m[A],A,m)}function h(m){return null==m?a(m):z.call(m).slice(8,-1)}function c(m,y){var A=null!=m?typeof m[y]:"number";return!/^(?:boolean|number|string|undefined)$/.test(A)&&("object"==A?!!m[y]:!0)}function e(m){return String(m).replace(/([ -])(?!$)/g,
"$1?")}function b(m,y){var A=null;g(m,function(v,x){A=y(A,v,x,m)});return A}function t(m){return String(m).replace(/^ +| +$/g,"")}function d(m){function y(T){return b(T,function(O,M){var V=M.pattern||e(M);!O&&(O=RegExp("\\b"+V+" *\\d+[.\\w_]*","i").exec(m)||RegExp("\\b"+V+" *\\w+-[\\w]*","i").exec(m)||RegExp("\\b"+V+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(m))&&((O=String(M.label&&!RegExp(V,"i").test(M.label)?M.label:O).split("/"))[1]&&!/[\d.]+/.test(O[0])&&(O[0]+=" "+O[1]),M=M.label||
M,O=f(O[0].replace(RegExp(V,"i"),M).replace(RegExp("; *(?:"+M+"[_-])?","i")," ").replace(RegExp("("+M+")[-_.]?(\\w)","i"),"$1 $2")));return O})}function A(T){return b(T,function(O,M){return O||(RegExp(M+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(m)||0)[1]||null})}var v=u,x=m&&"object"==typeof m&&"String"!=h(m);x&&(v=m,m=null);var G=v.navigator||{},D=G.userAgent||"";m||(m=D);var P=x?!!G.likeChrome:/\bChrome\b/.test(m)&&!/internal|\n/i.test(z.toString()),U=x?"Object":"ScriptBridgingProxyObject",
J=x?"Object":"Environment",Q=x&&v.java?"JavaPackage":h(v.java),S=x?"Object":"RuntimeObject";J=(Q=/\bJava/.test(Q)&&v.java)&&h(v.environment)==J;var W=Q?"a":"\u03b1",B=Q?"b":"\u03b2",I=v.document||{},N=v.operamini||v.opera,Z=w.test(Z=x&&N?N["[[Class]]"]:h(N))?Z:N=null,n,aa=m;x=[];var ba=null,Y=m==D;D=Y&&N&&"function"==typeof N.version&&N.version();var L=function(T){return b(T,function(O,M){return O||RegExp("\\b"+(M.pattern||e(M))+"\\b","i").exec(m)&&(M.label||M)})}([{label:"EdgeHTML",pattern:"Edge"},
"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),C=function(T){return b(T,function(O,M){return O||RegExp("\\b"+(M.pattern||e(M))+"\\b","i").exec(m)&&(M.label||M)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS",
"Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},
{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),K=y([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",
pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),R=function(T){return b(T,function(O,M,V){return O||(M[K]||M[/^[a-z]+(?: +[a-z]+\b)*/i.exec(K)]||RegExp("\\b"+e(V)+
"(?:\\b|\\w*\\d)","i").exec(m))&&V})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),
E=function(T){return b(T,function(O,M){var V=M.pattern||e(M);if(!O&&(O=RegExp("\\b"+V+"(?:/[\\d.]+|[ \\w.]*)","i").exec(m))){var X=O,ca=M.label||M,da={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};V&&ca&&/^Win/i.test(X)&&!/^Windows Phone /i.test(X)&&(da=da[/[\d.]+$/.exec(X)])&&(X="Windows "+da);X=String(X);V&&ca&&(X=X.replace(RegExp(V,
"i"),ca));O=X=f(X.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return O})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},
"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);L&&(L=[L]);/\bAndroid\b/.test(E)&&!K&&(n=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(m))&&(K=t(n[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null);R&&!K?K=y([R]):R&&K&&(K=K.replace(RegExp("^("+e(R)+")[-_.\\s]",
"i"),R+" ").replace(RegExp("^("+e(R)+")[-_.]?(\\w)","i"),R+" $2"));if(n=/\bGoogle TV\b/.exec(K))K=n[0];/\bSimulator\b/i.test(m)&&(K=(K?K+" ":"")+"Simulator");"Opera Mini"==C&&/\bOPiOS\b/.test(m)&&x.push("running in Turbo/Uncompressed mode");"IE"==C&&/\blike iPhone OS\b/.test(m)?(n=d(m.replace(/like iPhone OS/,"")),R=n.manufacturer,K=n.product):/^iP/.test(K)?(C||(C="Safari"),E="iOS"+((n=/ OS ([\d_]+)/i.exec(m))?" "+n[1].replace(/_/g,"."):"")):"Konqueror"==C&&/^Linux\b/i.test(E)?E="Kubuntu":R&&"Google"!=
R&&(/Chrome/.test(C)&&!/\bMobile Safari\b/i.test(m)||/\bVita\b/.test(K))||/\bAndroid\b/.test(E)&&/^Chrome/.test(C)&&/\bVersion\//i.test(m)?(C="Android Browser",E=/\bAndroid\b/.test(E)?E:"Android"):"Silk"==C?(/\bMobi/i.test(m)||(E="Android",x.unshift("desktop mode")),/Accelerated *= *true/i.test(m)&&x.unshift("accelerated")):"UC Browser"==C&&/\bUCWEB\b/.test(m)?x.push("speed mode"):"PaleMoon"==C&&(n=/\bFirefox\/([\d.]+)\b/.exec(m))?x.push("identifying as Firefox "+n[1]):"Firefox"==C&&(n=/\b(Mobile|Tablet|TV)\b/i.exec(m))?
(E||(E="Firefox OS"),K||(K=n[1])):!C||(n=!/\bMinefield\b/i.test(m)&&/\b(?:Firefox|Safari)\b/.exec(C))?(C&&!K&&/[\/,]|^[^(]+?\)/.test(m.slice(m.indexOf(n+"/")+8))&&(C=null),(n=K||R||E)&&(K||R||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(E))&&(C=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(E)?E:n)+" Browser")):"Electron"==C&&(n=(/\bChrome\/([\d.]+)\b/.exec(m)||0)[1])&&x.push("Chromium "+n);D||(D=A(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)",
"Version",e(C),"(?:Firefox|Minefield|NetFront)"]));if(n="iCab"==L&&3<parseFloat(D)&&"WebKit"||/\bOpera\b/.test(C)&&(/\bOPR\b/.test(m)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(m)&&!/^(?:Trident|EdgeHTML)$/.test(L)&&"WebKit"||!L&&/\bMSIE\b/i.test(m)&&("Mac OS"==E?"Tasman":"Trident")||"WebKit"==L&&/\bPlayStation\b(?! Vita\b)/i.test(C)&&"NetFront")L=[n];"IE"==C&&(n=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(m)||0)[1])?(C+=" Mobile",E="Windows Phone "+(/\+$/.test(n)?n:n+".x"),x.unshift("desktop mode")):
/\bWPDesktop\b/i.test(m)?(C="IE Mobile",E="Windows Phone 8.x",x.unshift("desktop mode"),D||(D=(/\brv:([\d.]+)/.exec(m)||0)[1])):"IE"!=C&&"Trident"==L&&(n=/\brv:([\d.]+)/.exec(m))&&(C&&x.push("identifying as "+C+(D?" "+D:"")),C="IE",D=n[1]);if(Y){if(c(v,"global"))if(Q&&(n=Q.lang.System,aa=n.getProperty("os.arch"),E=E||n.getProperty("os.name")+" "+n.getProperty("os.version")),J){try{D=v.require("ringo/engine").version.join("."),C="RingoJS"}catch(T){(n=v.system)&&n.global.system==v.system&&(C="Narwhal",
E||(E=n[0].os||null))}C||(C="Rhino")}else"object"==typeof v.process&&!v.process.browser&&(n=v.process)&&("object"==typeof n.versions&&("string"==typeof n.versions.electron?(x.push("Node "+n.versions.node),C="Electron",D=n.versions.electron):"string"==typeof n.versions.nw&&(x.push("Chromium "+D,"Node "+n.versions.node),C="NW.js",D=n.versions.nw)),C||(C="Node.js",aa=n.arch,E=n.platform,D=(D=/[\d.]+/.exec(n.version))?D[0]:null));else h(n=v.runtime)==U?(C="Adobe AIR",E=n.flash.system.Capabilities.os):
h(n=v.phantom)==S?(C="PhantomJS",D=(n=n.version||null)&&n.major+"."+n.minor+"."+n.patch):"number"==typeof I.documentMode&&(n=/\bTrident\/(\d+)/i.exec(m))?(D=[D,I.documentMode],(n=+n[1]+4)!=D[1]&&(x.push("IE "+D[1]+" mode"),L&&(L[1]=""),D[1]=n),D="IE"==C?String(D[1].toFixed(1)):D[0]):"number"==typeof I.documentMode&&/^(?:Chrome|Firefox)\b/.test(C)&&(x.push("masking as "+C+" "+D),C="IE",D="11.0",L=["Trident"],E="Windows");E=E&&f(E)}D&&(n=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(D)||/(?:alpha|beta)(?: ?\d)?/i.exec(m+
";"+(Y&&G.appMinorVersion))||/\bMinefield\b/i.test(m)&&"a")&&(ba=/b/i.test(n)?"beta":"alpha",D=D.replace(RegExp(n+"\\+?$"),"")+("beta"==ba?B:W)+(/\d+\+?/.exec(n)||""));if("Fennec"==C||"Firefox"==C&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(E))C="Firefox Mobile";else if("Maxthon"==C&&D)D=D.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(K))"Xbox 360"==K&&(E=null),"Xbox 360"==K&&/\bIEMobile\b/.test(m)&&x.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(C)&&(!C||K||/Browser|Mobi/.test(C))||
"Windows CE"!=E&&!/Mobi/i.test(m))if("IE"==C&&Y)try{null===v.external&&x.unshift("platform preview")}catch(T){x.unshift("embedded")}else(/\bBlackBerry\b/.test(K)||/\bBB10\b/.test(m))&&(n=(RegExp(K.replace(/ +/g," *")+"/([.\\d]+)","i").exec(m)||0)[1]||D)?(n=[n,/BB10/.test(m)],E=(n[1]?(K=null,R="BlackBerry"):"Device Software")+" "+n[0],D=null):this!=k&&"Wii"!=K&&(Y&&N||/Opera/.test(C)&&/\b(?:MSIE|Firefox)\b/i.test(m)||"Firefox"==C&&/\bOS X (?:\d+\.){2,}/.test(E)||"IE"==C&&(E&&!/^Win/.test(E)&&5.5<D||
/\bWindows XP\b/.test(E)&&8<D||8==D&&!/\bTrident\b/.test(m)))&&!w.test(n=d.call(k,m.replace(w,"")+";"))&&n.name&&(n="ing as "+n.name+((n=n.version)?" "+n:""),w.test(C)?(/\bIE\b/.test(n)&&"Mac OS"==E&&(E=null),n="identify"+n):(n="mask"+n,C=Z?f(Z.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(n)&&(E=null),Y||(D=null)),L=["Presto"],x.push(n));else C+=" Mobile";if(n=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(m)||0)[1]){n=[parseFloat(n.replace(/\.(\d)$/,".0$1")),n];if("Safari"==C&&"+"==n[1].slice(-1))C=
"WebKit Nightly",ba="alpha",D=n[1].slice(0,-1);else if(D==n[1]||D==(n[2]=(/\bSafari\/([\d.]+\+?)/i.exec(m)||0)[1]))D=null;n[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(m)||0)[1];537.36==n[0]&&537.36==n[2]&&28<=parseFloat(n[1])&&"WebKit"==L&&(L=["Blink"]);Y&&(P||n[1])?(L&&(L[1]="like Chrome"),n=n[1]||(n=n[0],530>n?1:532>n?2:532.05>n?3:533>n?4:534.03>n?5:534.07>n?6:534.1>n?7:534.13>n?8:534.16>n?9:534.24>n?10:534.3>n?11:535.01>n?12:535.02>n?"13+":535.07>n?15:535.11>n?16:535.19>n?17:536.05>n?18:536.1>
n?19:537.01>n?20:537.11>n?"21+":537.13>n?23:537.18>n?24:537.24>n?25:537.36>n?26:"Blink"!=L?"27":"28")):(L&&(L[1]="like Safari"),n=(n=n[0],400>n?1:500>n?2:526>n?3:533>n?4:534>n?"4+":535>n?5:537>n?6:538>n?7:601>n?8:602>n?9:604>n?10:606>n?11:608>n?12:"12"));L&&(L[1]+=" "+(n+="number"==typeof n?".x":/[.+]/.test(n)?"":"+"));"Safari"==C&&(!D||45<parseInt(D))?D=n:"Chrome"==C&&/\bHeadlessChrome/i.test(m)&&x.unshift("headless")}"Opera"==C&&(n=/\bzbov|zvav$/.exec(E))?(C+=" ",x.unshift("desktop mode"),"zvav"==
n?(C+="Mini",D=null):C+="Mobile",E=E.replace(RegExp(" *"+n+"$"),"")):"Safari"==C&&/\bChrome\b/.exec(L&&L[1])?(x.unshift("desktop mode"),C="Chrome Mobile",D=null,/\bOS X\b/.test(E)?(R="Apple",E="iOS 4.3+"):E=null):/\bSRWare Iron\b/.test(C)&&!D&&(D=A("Chrome"));D&&0==D.indexOf(n=/[\d.]+$/.exec(E))&&-1<m.indexOf("/"+n+"-")&&(E=t(E.replace(n,"")));E&&-1!=E.indexOf(C)&&!RegExp(C+" OS").test(E)&&(E=E.replace(RegExp(" *"+e(C)+" *"),""));L&&!/\b(?:Avant|Nook)\b/.test(C)&&(/Browser|Lunascape|Maxthon/.test(C)||
"Safari"!=C&&/^iOS/.test(E)&&/\bSafari\b/.test(L[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(C)&&L[1])&&(n=L[L.length-1])&&x.push(n);x.length&&(x=["("+x.join("; ")+")"]);R&&K&&0>K.indexOf(R)&&x.push("on "+R);K&&x.push((/^on /.test(x[x.length-1])?"":"on ")+K);if(E){var ea=(n=/ ([\d.+]+)$/.exec(E))&&"/"==E.charAt(E.length-n[0].length-1);E={architecture:32,family:n&&!ea?E.replace(n[0],""):E,version:n?n[1]:null,toString:function(){var T=
this.version;return this.family+(T&&!ea?" "+T:"")+(64==this.architecture?" 64-bit":"")}}}(n=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(aa))&&!/\bi686\b/i.test(aa)?(E&&(E.architecture=64,E.family=E.family.replace(RegExp(" *"+n),"")),C&&(/\bWOW64\b/i.test(m)||Y&&/\w(?:86|32)$/.test(G.cpuClass||G.platform)&&!/\bWin64; x64\b/i.test(m))&&x.unshift("32-bit")):E&&/^OS X/.test(E.family)&&"Chrome"==C&&39<=parseFloat(D)&&(E.architecture=64);m||(m=null);v={};v.description=m;v.layout=L&&L[0];v.manufacturer=R;v.name=
C;v.prerelease=ba;v.product=K;v.ua=m;v.version=C&&D;v.os=E||{architecture:null,family:null,version:null,toString:function(){return"null"}};v.parse=d;v.toString=function(){return this.description||""};v.version&&x.unshift(D);v.name&&x.unshift(C);E&&C&&(E!=String(E).split(" ")[0]||E!=C.split(" ")[0]&&!K)&&x.push(K?"("+E+")":"on "+E);x.length&&(v.description=x.join(" "));return v}var l={"function":!0,object:!0},u=l[typeof window]&&window||this,r=l[typeof exports]&&exports;l=l[typeof module]&&module&&
!module.nodeType&&module;var p=r&&l&&"object"==typeof global&&global;!p||p.global!==p&&p.window!==p&&p.self!==p||(u=p);var q=Math.pow(2,53)-1,w=/\bOpera/;p=Object.prototype;var F=p.hasOwnProperty,z=p.toString,H=d();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(u.platform=H,define(function(){return H})):r&&l?k(H,function(m,y){r[y]=m}):u.platform=H}).call(this);
function buildIOSMeta(){for(var a=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],g=0;g<a.length;g++){var f=document.createElement("meta");f.name=a[g].name;f.content=a[g].content;var k=window.document.head.querySelector('meta[name="'+f.name+'"]');k&&k.parentNode.removeChild(k);window.document.head.appendChild(f)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);console.log(window.devicePixelRatio);console.log(window.innerWidth);console.log(window.innerHeight);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();
break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}
function iosInIframe(){try{return window.self!==window.top}catch(a){return!0}}$(document).ready(function(){platform&&"iPhone"===platform.product&&"safari"!==platform.name.toLowerCase()&&!iosInIframe()&&(buildIOSFullscreenPanel(),buildIOSMeta())});jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&"safari"!==platform.name.toLowerCase()&&!iosInIframe()&&iosResize()});var s_iScaleFactor=1,s_oCanvasLeft,s_oCanvasTop,s_bIsIphone,s_bFocus=!0;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function trace(a){console.log(a)}function isIpad(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!a&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:a}function isMobile(){return isIpad()?!0:jQuery.browser.mobile}
function isIOS(){for(var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");a.length;)if(navigator.platform===a.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}
function getSize(a){var g=a.toLowerCase(),f=window.document,k=f.documentElement;if(void 0===window["inner"+a])a=k["client"+a];else if(window["inner"+a]!=k["client"+a]){var h=f.createElement("body");h.id="vpw-test-b";h.style.cssText="overflow:scroll";var c=f.createElement("div");c.id="vpw-test-d";c.style.cssText="position:absolute;top:-1000px";c.innerHTML="<style>@media("+g+":"+k["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+g+":7px!important}}</style>";h.appendChild(c);k.insertBefore(h,f.head);
a=7==c["offset"+a]?k["client"+a]:window["inner"+a];k.removeChild(h)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}
function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var g=getSize("Width");s_bFocus&&_checkOrientation(g,a);var f=Math.min(a/CANVAS_HEIGHT,g/CANVAS_WIDTH),k=Math.round(CANVAS_WIDTH*f);f=Math.round(CANVAS_HEIGHT*f);if(f<a){var h=a-f;f+=h;k+=CANVAS_WIDTH/CANVAS_HEIGHT*h}else k<g&&(h=g-k,k+=h,f+=CANVAS_HEIGHT/CANVAS_WIDTH*h);h=a/2-f/2;var c=g/2-k/2,e=CANVAS_WIDTH/k;if(c*e<-EDGEBOARD_X||
h*e<-EDGEBOARD_Y)f=Math.min(a/(CANVAS_HEIGHT-2*EDGEBOARD_Y),g/(CANVAS_WIDTH-2*EDGEBOARD_X)),k=Math.round(CANVAS_WIDTH*f),f=Math.round(CANVAS_HEIGHT*f),h=(a-f)/2,c=(g-k)/2,e=CANVAS_WIDTH/k;s_iOffsetX=-1*c*e;s_iOffsetY=-1*h*e;0<=h&&(s_iOffsetY=0);0<=c&&(s_iOffsetX=0);null!==s_oGame&&s_oGame.refreshButtonPos();null!==s_oMenu&&s_oMenu.refreshButtonPos();null!==s_oLevelMenu&&s_oLevelMenu.refreshButtonPos();s_bMobile?($("#canvas").css("width",k+"px"),$("#canvas").css("height",f+"px")):(s_oStage.canvas.width=
k,s_oStage.canvas.height=f,s_iScaleFactor=Math.min(k/CANVAS_WIDTH,f/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>h||(h=(a-f)/2);$("#canvas").css("top",h+"px");$("#canvas").css("left",c+"px");fullscreenHandler()}}
function _checkOrientation(a,g){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>g?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function createBitmap(a,g,f){var k=new createjs.Bitmap(a),h=new createjs.Shape;g&&f?h.graphics.beginFill("#fff").drawRect(0,0,g,f):h.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);k.hitArea=h;return k}function createSprite(a,g,f,k,h,c){a=null!==g?new createjs.Sprite(a,g):new createjs.Sprite(a);g=new createjs.Shape;g.graphics.beginFill("#000000").drawRect(-f,-k,h,c);a.hitArea=g;return a}
function randomFloatBetween(a,g,f){"undefined"===typeof f&&(f=2);return parseFloat(Math.min(a+Math.random()*(g-a),g).toFixed(f))}function shuffle(a){for(var g=a.length,f,k;0!==g;)k=Math.floor(Math.random()*g),--g,f=a[g],a[g]=a[k],a[k]=f;return a}function formatTime(a){a/=1E3;var g=Math.floor(a/60);a=parseFloat(a-60*g).toFixed(1);var f="";f=10>g?f+("0"+g+":"):f+(g+":");return 10>a?f+("0"+a):f+a}
function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var g=a.length,f,k;0<g;)k=Math.floor(Math.random()*g),g--,f=a[g],a[g]=a[k],a[k]=f;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var g=document.createEvent("MouseEvents");g.initEvent("click",!0,!0);a.dispatchEvent(g)}}};
(function(){function a(f){var k={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};f=f||window.event;f.type in k?document.body.className=k[f.type]:(document.body.className=this[g]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var g="hidden";g in document?document.addEventListener("visibilitychange",a):(g="mozHidden")in document?document.addEventListener("mozvisibilitychange",
a):(g="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(g="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var g=window.location.search.substring(1).split("&"),f=0;f<g.length;f++){var k=g[f].split("=");if(k[0]==a)return k[1]}}function playSound(a,g,f){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(g),s_aSounds[a].loop(f),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}function setVolume(a,g){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(g)}
function setMute(a,g){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(g)}function isSoundPlaying(a){return s_aSounds[a].playing()}function saveItem(a,g){s_bStorageAvailable&&localStorage.setItem(a,g)}function getItem(a){return s_bStorageAvailable?localStorage.getItem(a):null}
function fullscreenHandler(){ENABLE_FULLSCREEN&&!1!==screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut(),null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut())}if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut();null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a={},g,f,k,h,c,e;this.init=function(b,t,d){g={};k=f=0;h=b;c=t;e=d};this.addSprite=function(b,t){if(!a.hasOwnProperty(b)){var d=new Image;a[b]=g[b]={szPath:t,oSprite:d,bLoaded:!1};f++}};this.getSprite=function(b){return a.hasOwnProperty(b)?a[b].oSprite:null};this._onSpritesLoaded=function(){f=0;c.call(e)};this._onSpriteLoaded=function(){h.call(e);++k===f&&this._onSpritesLoaded()};this.loadSprites=function(){for(var b in g)g[b].oSprite.oSpriteLibrary=this,g[b].oSprite.szKey=
b,g[b].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},g[b].oSprite.onerror=function(t){var d=t.currentTarget;setTimeout(function(){g[d.szKey].oSprite.src=g[d.szKey].szPath},500)},g[b].oSprite.src=g[b].szPath};this.setLoaded=function(b){a[b].bLoaded=!0};this.isLoaded=function(b){return a[b].bLoaded};this.getNumSprites=function(){return f}}
var CANVAS_WIDTH=1500,CANVAS_HEIGHT=768,EDGEBOARD_X=180,EDGEBOARD_Y=20,FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,FONT_GAME="space_marine",STATE_LOADING=0,STATE_MENU=1,STATE_MENU_LEVEL=2,STATE_GAME=3,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_BUT_YES_DOWN=6,ON_PLAYER_TOUCHDOWN=7,ON_PLAYER_TACKLED=8,ON_OPPONENT_HIDE=9,ON_OPPONENT_TACKLE=10,ON_POWERUP_END_MOVE=11,ON_BACK_MENU=12,ON_RESTART=13,ON_NEXT_LEVEL=14,PLAYER_ANIM_RUN=0,PLAYER_ANIM_FALL=
1,PLAYER_ANIM_TOUCHDOWN=2,PLAYER_ANIM_JUMP=3,STARTING_STANDS_SCALE_BONUS=.74,NUM_LEVELS,OPPONENT_FINAL_Y=1070,POWERUP_FINAL_Y=600,TIME_OPPONENT_RUN=3E3,HERO_ACCELERATION,HERO_SUPER_ACCELERATION,HERO_FRICTION,MAX_HERO_SPEED,MAX_DIST_AVOID_OPPONENT_IN_JUMP=150,MIN_POWERUP_X=700,MAX_POWERUP_X=800,SCORE_POWERUP,TIME_EFFECT_POWERUP=1E4,NUM_COLS_PAGE_LEVEL=6,NUM_ROWS_PAGE_LEVEL=2,SOUNDTRACK_VOLUME_IN_GAME=1,ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION,TEXT_SCORE="SCORE",TEXT_LEVEL_SCORE="LEVEL SCORE",TEXT_GAME_OVER=
"GAME OVER",TEXT_CONGRATS="YOU WON!!",TEXT_ERR_LS="YOUR WEB BROWSER DOES NOT SUPPORT STORING SETTING LOCALLY. IN SAFARI, THE MOST COMMON CAUSE OF THIS IS USING 'PRIVATE BROWSING MODE'. SOME INFO MAY NOT SAVE OR SOME FEATURE MAY NOT WORK PROPERLY.",TEXT_CREDITS_DEVELOPED="DEVELOPED BY",TEXT_PRELOADER_CONTINUE="START",TEXT_ARE_SURE="ARE YOU SURE?",TEXT_SELECT_LEVEL="SELECT A LEVEL",TEXT_LEVEL="STAGE",TEXT_LEVEL_CLEARED="STAGE %s CLEARED",TEXT_JUMP="JUMP",TEXT_SHARE_IMAGE="200x200.jpg",TEXT_SHARE_TITLE=
"Congratulations!",TEXT_SHARE_MSG1="You collected <strong>",TEXT_SHARE_MSG2=" points</strong>!<br><br>Share your score with your friends!",TEXT_SHARE_SHARE1="My score is ",TEXT_SHARE_SHARE2=" points! Can you do better";
function CPreloader(){var a,g,f,k,h,c,e,b,t,d;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();d=new createjs.Container;s_oStage.addChild(d)};this.unload=function(){d.removeAllChildren()};this._onImagesLoaded=function(){};this._onAllImagesLoaded=
function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.addChild(l);l=s_oSpriteLibrary.getSprite("200x200");e=createBitmap(l);e.regX=.5*l.width;e.regY=.5*l.height;e.x=CANVAS_WIDTH/2;e.y=CANVAS_HEIGHT/2-80;d.addChild(e);b=new createjs.Shape;b.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(e.x-100,e.y-100,200,200,10);d.addChild(b);e.mask=b;l=s_oSpriteLibrary.getSprite("progress_bar");
k=createBitmap(l);k.x=CANVAS_WIDTH/2-l.width/2;k.y=CANVAS_HEIGHT/2+70;d.addChild(k);a=l.width;g=l.height;h=new createjs.Shape;h.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(k.x,k.y,1,g);d.addChild(h);k.mask=h;f=new createjs.Text("","30px "+FONT_GAME,"#fff");f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2+120;f.textBaseline="alphabetic";f.textAlign="center";d.addChild(f);l=s_oSpriteLibrary.getSprite("but_start");t=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2+100,l,TEXT_PRELOADER_CONTINUE,"Arial","#000",
36,d);t.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);t.setVisible(!1);c=new createjs.Shape;c.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.addChild(c);createjs.Tween.get(c).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(c);d.removeChild(c)})};this._onButStartRelease=function(){s_oMain._allResourcesLoaded()};this.refreshLoader=function(l){f.text=l+"%";100===l&&(s_oMain._allResourcesLoaded(),f.visible=!1,k.visible=!1);h.graphics.clear();l=Math.floor(l*
a/100);h.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(k.x,k.y,l,g)};this._init()}
function CMain(a){var g,f,k=0,h=0,c=STATE_LOADING,e,b,t;this.initContainer=function(){var d=document.getElementById("canvas");s_oStage=new createjs.Stage(d);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage);s_bMobile=isMobile();!1===s_bMobile&&s_oStage.enableMouseOver(20);s_iPrevTime=(new Date).getTime();createjs.Ticker.framerate=FPS;createjs.Ticker.on("tick",this._update);navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;s_oLevelSettings=
new CLevelSettings;e=new CPreloader};this.setLocalStorageLevel=function(d){var l=getItem("touchdownrush_level");if(null===l||l<d)s_iLastLevel=d,saveItem("touchdownrush_level",s_iLastLevel)};this.setLocalStorageScore=function(d,l){saveItem("touchdownrush_score_level_"+l,d)};this.clearLocalStorage=function(){s_iLastLevel=1;s_bStorageAvailable&&localStorage.clear()};this.getScoreTillLevel=function(d){if(!s_bStorageAvailable)return 0;for(var l=0,u=0;u<d-1;u++)l+=parseInt(getItem("touchdownrush_score_level_"+
(u+1)));return l};this.getSavedLevel=function(){if(!s_bStorageAvailable)return 1;var d=getItem("touchdownrush_level");return null===d?1:d};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();this._loadImages();g=f=!0};this.soundLoaded=function(){k++;e.refreshLoader(Math.floor(k/h*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",
filename:"level_win",loop:!1,volume:1,ingamename:"level_win"});s_aSoundsInfo.push({path:"./sounds/",filename:"powerup",loop:!1,volume:1,ingamename:"powerup"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_touchdown",loop:!1,volume:1,ingamename:"crowd_touchdown"});s_aSoundsInfo.push({path:"./sounds/",filename:"enemy",loop:!1,volume:1,ingamename:"enemy"});s_aSoundsInfo.push({path:"./sounds/",filename:"enemy_tackle",loop:!1,volume:1,ingamename:"enemy_tackle"});s_aSoundsInfo.push({path:"./sounds/",
filename:"game_over",loop:!1,volume:1,ingamename:"game_over"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_idle",loop:!0,volume:1,ingamename:"crowd_idle"});s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});h+=s_aSoundsInfo.length;s_aSounds=[];for(var d=0;d<s_aSoundsInfo.length;d++)this.tryToLoadSound(s_aSoundsInfo[d],!1)};this.tryToLoadSound=function(d,l){setTimeout(function(){s_aSounds[d.ingamename]=new Howl({src:[d.path+d.filename+".mp3"],
autoplay:!1,preload:!0,loop:d.loop,volume:d.volume,onload:s_oMain.soundLoaded,onloaderror:function(u,r){for(var p=0;p<s_aSoundsInfo.length;p++)if(u===s_aSounds[s_aSoundsInfo[p].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[p],!0);break}},onplayerror:function(u){for(var r=0;r<s_aSoundsInfo.length;r++)if(u===s_aSounds[s_aSoundsInfo[r].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[r].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[r].ingamename].play();"soundtrack"===
s_aSoundsInfo[r].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},l?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("but_next","./sprites/but_next.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("audio_icon",
"./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("msg_box_big","./sprites/msg_box_big.png");s_oSpriteLibrary.addSprite("msg_box_wide","./sprites/msg_box_wide.png");s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.jpg");s_oSpriteLibrary.addSprite("bg_menu_level","./sprites/bg_menu_level.jpg");s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");
s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("but_settings","./sprites/but_settings.png");s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("key_0","./sprites/key_0.png");s_oSpriteLibrary.addSprite("key_1","./sprites/key_1.png");
s_oSpriteLibrary.addSprite("key_2","./sprites/key_2.png");s_oSpriteLibrary.addSprite("but_left","./sprites/but_left.png");s_oSpriteLibrary.addSprite("but_right","./sprites/but_right.png");s_oSpriteLibrary.addSprite("but_jump","./sprites/but_jump.png");s_oSpriteLibrary.addSprite("post","./sprites/post.png");s_oSpriteLibrary.addSprite("power_up_0","./sprites/power_up_0.png");s_oSpriteLibrary.addSprite("power_up_1","./sprites/power_up_1.png");s_oSpriteLibrary.addSprite("but_level","./sprites/but_level.png");
s_oSpriteLibrary.addSprite("powerup_gui_off","./sprites/powerup_gui_off.png");s_oSpriteLibrary.addSprite("powerup_gui_on","./sprites/powerup_gui_on.png");s_oSpriteLibrary.addSprite("player_falling","./sprites/player/player_falling.png");s_oSpriteLibrary.addSprite("player_jump-0","./sprites/player/player_jump-0.png");s_oSpriteLibrary.addSprite("player_jump-1","./sprites/player/player_jump-1.png");s_oSpriteLibrary.addSprite("player_jump-2","./sprites/player/player_jump-2.png");s_oSpriteLibrary.addSprite("player_running-0",
"./sprites/player/player_running-0.png");s_oSpriteLibrary.addSprite("player_running-1","./sprites/player/player_running-1.png");s_oSpriteLibrary.addSprite("player_touchdown-0","./sprites/player/player_touchdown-0.png");s_oSpriteLibrary.addSprite("player_touchdown-1","./sprites/player/player_touchdown-1.png");for(var d=0;18>d;d++)s_oSpriteLibrary.addSprite("field_loop_"+d,"./sprites/field_loop/field_loop_"+d+".png");for(d=0;39>d;d++)s_oSpriteLibrary.addSprite("end_zone_"+d,"./sprites/end_zone/end_zone_"+
d+".png");for(d=0;18>d;d++)s_oSpriteLibrary.addSprite("enemy_running_"+d,"./sprites/enemy/running/enemy_running_"+d+".png");for(d=0;18>d;d++)s_oSpriteLibrary.addSprite("enemy_tackle_"+d,"./sprites/enemy/tackle/enemy_tackle_"+d+".png");h+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){k++;e.refreshLoader(Math.floor(k/h*100))};this._onAllImagesLoaded=function(){};this._allResourcesLoaded=function(){e.unload();try{saveItem("ls_available","ok"),s_iLastLevel=
this.getSavedLevel()}catch(d){s_bStorageAvailable=!1}s_oSoundTrack=playSound("soundtrack",1,!0);s_oMain.gotoMenu()};this.gotoMenu=function(){new CMenu;c=STATE_MENU};this.gotoLevelMenu=function(){b=new CLevelMenu;c=STATE_MENU_LEVEL};this.gotoSelectCar=function(){new CMenuSelectCar;c=STATE_MENU_SELECT_CAR};this.gotoGame=function(){t=new CGame;c=STATE_GAME};this.levelSelected=function(d){s_iLevelSelected=d;b.unload();d>=s_iLastLevel&&(s_iLastLevel=d);s_oMain.gotoGame()};this.stopUpdateNoBlockAndTick=
function(){f=!1};this.startUpdateNoBlockAndTick=function(){f=!0};this.stopUpdateNoBlock=function(){g=!1;createjs.Ticker.paused=!0};this.startUpdateNoBlock=function(){s_iPrevTime=(new Date).getTime();g=!0;createjs.Ticker.paused=!1};this.stopUpdate=function(){g=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();g=!0;createjs.Ticker.paused=!1;$("#block_game").css("display",
"none");(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)&&s_bAudioActive&&Howler.mute(!1)};this._update=function(d){if(!1!==g){var l=(new Date).getTime();s_iTimeElaps=l-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=l;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);c===STATE_GAME&&f&&t.update();void 0!==s_oStage&&s_oStage.update(d)}};s_oMain=this;HERO_ACCELERATION=a.hero_acceleration;HERO_SUPER_ACCELERATION=a.hero_acceleration_powerup;HERO_FRICTION=a.hero_friction;MAX_HERO_SPEED=
a.max_hero_speed;SCORE_POWERUP=a.score_powerup;ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;this.initContainer()}var s_bMobile,s_bAudioActive=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oSoundTrack=null,s_oDrawLayer,s_oStage,s_oMain=null,s_oSpriteLibrary,s_oLevelSettings,s_iLastLevel,s_iLevelSelected=1,s_bFullscreen=!1,s_bStorageAvailable=!0,s_aSoundsInfo;
function CTextButton(a,g,f,k,h,c,e,b){var t,d,l,u,r,p,q,w,F;this._init=function(z,H,m,y,A,v,x,G){t=!1;u=[];r=[];F=createBitmap(m);d=m.width;l=m.height;w=new createjs.Text(y,x+"px "+A,v);w.textAlign="center";w.textBaseline="alphabetic";w.lineWidth=.9*d;w.x=m.width/2;w.y=Math.floor(m.height/2)+15;q=new createjs.Container;q.x=z;q.y=H;q.regX=m.width/2;q.regY=m.height/2;s_bMobile||(q.cursor="pointer");q.addChild(F,w);!1!==G&&s_oStage.addChild(q);this._initListener()};this.unload=function(){q.off("mousedown");
q.off("pressup");s_oStage.removeChild(q)};this.setVisible=function(z){q.visible=z};this.setAlign=function(z){w.textAlign=z};this.enable=function(){t=!1;F.filters=[];F.cache(0,0,d,l)};this.disable=function(){t=!0;var z=(new createjs.ColorMatrix).adjustSaturation(-100).adjustBrightness(40);F.filters=[new createjs.ColorMatrixFilter(z)];F.cache(0,0,d,l)};this._initListener=function(){q.on("mousedown",this.buttonDown);q.on("pressup",this.buttonRelease)};this.addEventListener=function(z,H,m){u[z]=H;r[z]=
m};this.addEventListenerWithParams=function(z,H,m,y){u[z]=H;r[z]=m;p=y};this.buttonRelease=function(){t||(playSound("click",1,!1),q.scaleX=1,q.scaleY=1,u[ON_MOUSE_UP]&&u[ON_MOUSE_UP].call(r[ON_MOUSE_UP],p))};this.buttonDown=function(){t||(q.scaleX=.9,q.scaleY=.9,u[ON_MOUSE_DOWN]&&u[ON_MOUSE_DOWN].call(r[ON_MOUSE_DOWN]))};this.setPosition=function(z,H){q.x=z;q.y=H};this.changeText=function(z){w.text=z};this.setX=function(z){q.x=z};this.setY=function(z){q.y=z};this.getButtonImage=function(){return q};
this.getX=function(){return q.x};this.getY=function(){return q.y};this.getSprite=function(){return q};this._init(a,g,f,k,h,c,e,b);return this}
function CGfxButton(a,g,f,k){var h,c,e,b=[],t,d,l;this._init=function(u,r,p){h=!1;c=[];e=[];l=createBitmap(p);l.x=u;l.y=r;l.regX=p.width/2;l.regY=p.height/2;l.cursor="pointer";k.addChild(l);this._initListener()};this.unload=function(){l.off("mousedown",t);l.off("pressup",d);k.removeChild(l)};this.setVisible=function(u){l.visible=u};this._initListener=function(){t=l.on("mousedown",this.buttonDown);d=l.on("pressup",this.buttonRelease)};this.addEventListener=function(u,r,p){c[u]=r;e[u]=p};this.addEventListenerWithParams=
function(u,r,p,q){c[u]=r;e[u]=p;b=q};this.enable=function(){h=!1};this.disable=function(){h=!0};this.buttonRelease=function(){h||(playSound("click",1,!1),l.scaleX=1,l.scaleY=1,c[ON_MOUSE_UP]&&c[ON_MOUSE_UP].call(e[ON_MOUSE_UP],b))};this.buttonDown=function(){h||(l.scaleX=.9,l.scaleY=.9,c[ON_MOUSE_DOWN]&&c[ON_MOUSE_DOWN].call(e[ON_MOUSE_DOWN],b))};this.setPosition=function(u,r){l.x=u;l.y=r};this.setX=function(u){l.x=u};this.setY=function(u){l.y=u};this.getButtonImage=function(){return l};this.getX=
function(){return l.x};this.getY=function(){return l.y};this._init(a,g,f);return this}
function CToggle(a,g,f,k,h){var c,e,b,t;this._init=function(d,l,u,r){e=[];b=[];var p=new createjs.SpriteSheet({images:[u],frames:{width:u.width/2,height:u.height,regX:u.width/2/2,regY:u.height/2},animations:{state_true:[0],state_false:[1]}});c=r;t=createSprite(p,"state_"+c,u.width/2/2,u.height/2,u.width/2,u.height);t.x=d;t.y=l;t.stop();t.cursor="pointer";h.addChild(t);this._initListener()};this.unload=function(){t.off("mousedown",this.buttonDown);t.off("pressup",this.buttonRelease);h.removeChild(t)};
this._initListener=function(){t.on("mousedown",this.buttonDown);t.on("pressup",this.buttonRelease)};this.addEventListener=function(d,l,u){e[d]=l;b[d]=u};this.setActive=function(d){c=d;t.gotoAndStop("state_"+c)};this.buttonRelease=function(){t.scaleX=1;t.scaleY=1;playSound("click",1,!1);c=!c;t.gotoAndStop("state_"+c);e[ON_MOUSE_UP]&&e[ON_MOUSE_UP].call(b[ON_MOUSE_UP],c)};this.buttonDown=function(){t.scaleX=.9;t.scaleY=.9;e[ON_MOUSE_DOWN]&&e[ON_MOUSE_DOWN].call(b[ON_MOUSE_DOWN])};this.setPosition=function(d,
l){t.x=d;t.y=l};this.getButtonImage=function(){return t};this._init(a,g,f,k)}
function CMenu(){var a,g,f,k,h,c,e,b,t,d,l,u,r=null,p=null;this._init=function(){e=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(e);b=new CGfxButton(CANVAS_WIDTH/2+150,CANVAS_HEIGHT-150,s_oSpriteLibrary.getSprite("but_play"),s_oStage);b.addEventListener(ON_MOUSE_UP,this._onButPlaySingle,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){var q=s_oSpriteLibrary.getSprite("audio_icon");h=CANVAS_WIDTH-q.height/2-10;c=q.height/2+10;t=new CToggle(h,c,q,s_bAudioActive,s_oStage);
t.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this)}q=s_oSpriteLibrary.getSprite("but_credits");f=q.width/2+10;k=q.height/2+10;d=new CGfxButton(f,k,q,s_oStage);d.addEventListener(ON_MOUSE_UP,this._onButCreditsRelease,this);q=window.document;var w=q.documentElement;r=w.requestFullscreen||w.mozRequestFullScreen||w.webkitRequestFullScreen||w.msRequestFullscreen;p=q.exitFullscreen||q.mozCancelFullScreen||q.webkitExitFullscreen||q.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(r=!1);r&&screenfull.isEnabled&&
(q=s_oSpriteLibrary.getSprite("but_fullscreen"),a=f+q.width/2+10,g=k,u=new CToggle(a,g,q,s_bFullscreen,s_oStage),u.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));s_bStorageAvailable||new CAlertSavingBox(TEXT_ERR_LS,s_oStage);l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(l);createjs.Tween.get(l).to({alpha:0},400).call(function(){l.visible=!1});setVolume("soundtrack",1);this.refreshButtonPos()};this.unload=function(){b.unload();
d.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)t.unload(),t=null;r&&screenfull.isEnabled&&u.unload();s_oStage.removeAllChildren();s_oMenu=null};this.refreshButtonPos=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||t.setPosition(h-s_iOffsetX,s_iOffsetY+c);r&&screenfull.isEnabled&&u.setPosition(a+s_iOffsetX,g+s_iOffsetY);d.setPosition(f+s_iOffsetX,k+s_iOffsetY)};this._onButPlaySingle=function(){s_oMenu.unload();s_oMain.gotoLevelMenu();$(s_oMain).trigger("start_session")};this._onButCreditsRelease=
function(){new CCreditsPanel};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){r&&screenfull.isEnabled&&u.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?p.call(window.document):r.call(window.document.documentElement);sizeHandler()};s_oMenu=this;this._init()}var s_oMenu=null;
function CGame(){var a=!1,g,f,k,h,c,e,b,t,d,l,u,r,p,q,w,F,z,H,m,y,A,v,x,G,D,P,U,J,Q,S,W;this._init=function(){b=s_iLevelSelected;c=s_oMain.getScoreTillLevel(b);y=[{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0},{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0}];P=new createjs.Container;s_oStage.addChild(P);var B=s_oSpriteLibrary.getSprite("bg_game");A=createBitmap(B);A.regX=B.width/2;A.regY=B.height;A.x=CANVAS_WIDTH/2;A.y=521;P.addChild(A);x=new CField(0,
516,P);x.show();G=new CFieldEndZone(0,516,P);B=s_oSpriteLibrary.getSprite("post");v=createBitmap(B);v.regX=B.width/2;v.regY=B.height;v.x=CANVAS_WIDTH-450;v.y=518;P.addChild(v);U=new createjs.Container;P.addChild(U);J=new CPlayer(CANVAS_WIDTH/2,CANVAS_HEIGHT-s_iOffsetY,P);J.addEventListener(ON_PLAYER_TOUCHDOWN,this._onWinLevel,this);J.addEventListener(ON_PLAYER_TACKLED,this._onEndLevel,this);D=new CInterface(c);this.reset();Q=new CHelpPanel;Q.show();S=new CEndPanel;S.addEventListener(ON_RESTART,this.restart,
this);S.addEventListener(ON_BACK_MENU,this.onExit,this);W=new CNextLevelPanel;W.addEventListener(ON_RESTART,this.restart,this);W.addEventListener(ON_BACK_MENU,this.onExit,this);W.addEventListener(ON_NEXT_LEVEL,this._onNextLevel,this);playSound("crowd_idle",1,!0)};this.unload=function(){a=!1;stopSound("crowd_idle");D.unload();s_oStage.removeAllChildren()};this.reset=function(){g=h=f=k=!1;t=e=0;F=[];z=[];d=s_oLevelSettings.getEnemiesSpawn(b);l=s_oLevelSettings.getStartingEnemySpawn(b);u=s_oLevelSettings.getEnemySpawnNumber(b);
m=s_oLevelSettings.getPowerUps(b);c=s_oMain.getScoreTillLevel(b);r=parseFloat(((1-STARTING_STANDS_SCALE_BONUS)/d).toFixed(3));this._createSpawnArray();G.reset();J.reset();D.reset(c,b);A.scaleX=A.scaleY=STARTING_STANDS_SCALE_BONUS;v.scaleX=v.scaleY=.2;setVolume("crowd_idle",1);$(s_oMain).trigger("start_level",b)};this.restart=function(){$(s_oMain).trigger("restart_level",b);for(var B=0;B<z.length;B++)z[B].unload();this.reset();this.startCountdown()};this.refreshButtonPos=function(){D.refreshButtonPos();
J.setY(CANVAS_HEIGHT-s_iOffsetY)};this.onKeyDown=function(B){if(J.isJumping()||h||J.getCurAnim()===PLAYER_ANIM_TOUCHDOWN)return B.preventDefault(),!1;B||(B=window.event);switch(B.keyCode){case 37:f=!0;J.moveLeft(!0);break;case 39:f=!0;J.moveRight(!0);break;case 32:f=!0,J.jump()}B.preventDefault();return!1};this.onKeyUp=function(B){if(h)return B.preventDefault(),!1;B||(B=window.event);f=!1;switch(B.keyCode){case 37:J.moveLeft(!1);break;case 39:J.moveRight(!1)}B.preventDefault();return!1};this.moveLeft=
function(B){B&&(f||J.isJumping())||h||(f=B,J.moveLeft(B))};this.moveRight=function(B){B&&(f||J.isJumping())||h||(f=B,J.moveRight(B))};this.moveJump=function(B){B&&(f||J.isJumping())||h||(f=B)&&J.jump()};this.startCountdown=function(){J.show();this._spawnEnemy();a=!0};this._createSpawnArray=function(){H=[];var B=s_iOffsetX+50,I=Math.floor(Math.random()*(CANVAS_WIDTH-s_iOffsetX-s_iOffsetX+1))+s_iOffsetX+50;for(I/=s_oLevelSettings.getEnemiesSpawn(b);B<CANVAS_WIDTH-s_iOffsetX;)H.push(B),B+=I;H=shuffle(H)};
this.onExitFromHelp=function(){this.startCountdown()};this._spawnEnemy=function(){for(var B=Math.floor(Math.random()*u)+1,I=0;I<B&&0!==d;I++){d--;var N=!1;0===d&&(k=N=!0);N=new COpponent(N,H.pop(),526,U);N.addEventListener(ON_OPPONENT_HIDE,this.checkTouchDown,this);N.addEventListener(ON_OPPONENT_TACKLE,this.checkCollision,this);F.push(N);N=A.scaleX+r;(new createjs.Tween.get(A)).to({scaleX:N,scaleY:N},l);N=v.scaleX+r;(new createjs.Tween.get(v)).to({scaleX:N,scaleY:N,x:v.x+750*r},l);-1!==m.indexOf(F.length)&&
this._spawnPowerUp()}};this._spawnPowerUp=function(){var B=new CPowerUp(Math.floor(Math.random()*(MAX_POWERUP_X-MIN_POWERUP_X+1))+MIN_POWERUP_X,510,Math.floor(2*Math.random()),U);B.addEventListener(ON_POWERUP_END_MOVE,this._checkCollisionWithPowerUp,this);z.push(B)};this.checkTouchDown=function(B){B&&!h&&this._showTouchdown()};this.checkCollision=function(B){if(!h){var I=J.getRect(),N=Math.abs(B.x-I.x);if(I.intersects(B))if(J.isJumping()&&N>MAX_DIST_AVOID_OPPONENT_IN_JUMP)this.refreshScore(Math.floor(N/
200));else{h=!0;p=0;var Z=this;q=setInterval(function(){Z.tremble()},20);playSound("enemy_tackle",1,!1);J.changeAnim(PLAYER_ANIM_FALL);for(B=0;B<z.length;B++)z[B].stopTween()}else this.refreshScore(Math.floor(N/200))}};this._checkCollisionWithPowerUp=function(B,I){if(!h&&J.getRect().intersects(B))switch(playSound("powerup",1,!1),I){case 0:this.refreshScore(SCORE_POWERUP);new CScoreText(SCORE_POWERUP,CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oStage);break;case 1:J.setAcceleration(HERO_SUPER_ACCELERATION,2*
MAX_HERO_SPEED),w=0,g=!0,D.showPowerUpGui()}};this.tremble=function(){var B=y[p];P.x+=B.x;P.y+=B.y;p++;p===y.length&&(p=0,clearInterval(q))};this.refreshScore=function(B){e+=B;c+=B;D.refreshScore(c)};this._showTouchdown=function(){playSound("crowd_touchdown",1,!1);G.show();var B=A.scaleX+r;(new createjs.Tween.get(A)).to({scaleX:B,scaleY:B},1200);B=v.scaleX+r;(new createjs.Tween.get(v)).to({scaleX:B,scaleY:B,x:v.x+500,y:v.y+60},1E3);setTimeout(function(){J.changeAnim(PLAYER_ANIM_TOUCHDOWN)},500)};
this._manageOpponentDepth=function(){U.sortChildren(function(B,I,N){return B.y>I.y?1:B.y<I.y?-1:0})};this.endZonePlayed=function(){};this._onEndLevel=function(){$(s_oMain).trigger("end_level",b);setVolume("crowd_idle",0);setTimeout(function(){S.show(c,TEXT_GAME_OVER)},2E3)};this._onWinLevel=function(){setVolume("crowd_idle",0);$(s_oMain).trigger("end_level",b);$(s_oMain).trigger("save_score",c);b===NUM_LEVELS?setTimeout(function(){S.show(c,TEXT_CONGRATS)},2E3):(s_oMain.setLocalStorageLevel(b+1),s_oMain.setLocalStorageScore(e,
b),setTimeout(function(){W.show(e,c,b)},2E3))};this._onNextLevel=function(){b++;this.reset();this.startCountdown()};this.onExit=function(){this.unload();s_oMain.gotoMenu();$(s_oMain).trigger("show_interlevel_ad");$(s_oMain).trigger("end_session");$(s_oMain).trigger("share_event",c)};this.getPlayerX=function(){return J.getX()};this.update=function(){if(!1!==a){J.update();this._manageOpponentDepth();for(var B=0;B<F.length;B++)F[B].update();h||(x.update(),G.update(),t+=s_iTimeElaps,!k&&t>l&&(t=0,this._spawnEnemy()),
g&&(w+=s_iTimeElaps,w>TIME_EFFECT_POWERUP?(g=!1,D.hidePowerUpGui(),J.setAcceleration(HERO_ACCELERATION,MAX_HERO_SPEED)):D.refreshPowerUpTime(w)))}};s_oGame=this;this._init()}var s_oGame=null;
function CInterface(a){var g,f,k,h,c,e,b,t,d,l,u,r,p,q,w,F,z,H,m,y,A,v,x,G,D,P,U,J=null,Q=null,S,W;this._init=function(B){if(s_bMobile){var I=s_oSpriteLibrary.getSprite("but_left");b=I.width/2+150;t=CANVAS_HEIGHT-I.height/2-20;D=new CGfxButton(b,t,I,s_oStage);D.addEventListener(ON_MOUSE_DOWN,this._onLeftDown,this);D.addEventListener(ON_MOUSE_UP,this._onLeftUp,this);I=s_oSpriteLibrary.getSprite("but_right");c=CANVAS_WIDTH-I.width/2-150;e=CANVAS_HEIGHT-I.height/2-20;P=new CGfxButton(c,e,I,s_oStage);
P.addEventListener(ON_MOUSE_DOWN,this._onRightDown,this);P.addEventListener(ON_MOUSE_UP,this._onRightUp,this);I=s_oSpriteLibrary.getSprite("but_jump");k=CANVAS_WIDTH/2;h=CANVAS_HEIGHT-I.height/2-20;U=new CGfxButton(k,h,I,s_oStage);U.addEventListener(ON_MOUSE_DOWN,this._onJumpDown,this);U.addEventListener(ON_MOUSE_UP,this._onJumpUp,this)}else document.onkeydown=s_oGame.onKeyDown,document.onkeyup=s_oGame.onKeyUp;I=s_oSpriteLibrary.getSprite("but_exit");g=CANVAS_WIDTH-I.width/2-10;f=I.height/2+10;A=
new CGfxButton(g,f,I,s_oStage);A.addEventListener(ON_MOUSE_UP,this._onExit,this);!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(w=g-I.width,F=f,I=s_oSpriteLibrary.getSprite("audio_icon"),x=new CToggle(w,F,I,s_bAudioActive,s_oStage),x.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),d=w-I.width/2,l=F):(d=g-I.width,l=f);I=window.document;var N=I.documentElement;J=N.requestFullscreen||N.mozRequestFullScreen||N.webkitRequestFullScreen||N.msRequestFullscreen;Q=I.exitFullscreen||I.mozCancelFullScreen||
I.webkitExitFullscreen||I.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(J=!1);J&&screenfull.isEnabled&&(I=s_oSpriteLibrary.getSprite("but_fullscreen"),G=new CToggle(d,l,I,s_bFullscreen,s_oStage),G.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));I=s_oSpriteLibrary.getSprite("but_settings");S=new CGUIExpandible(g,f,I,s_oStage);S.addButton(A);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||S.addButton(x);J&&screenfull.isEnabled&&S.addButton(G);p=10;q=40;m=new createjs.Text(TEXT_SCORE,"40px "+FONT_GAME,
"#fff");m.x=p;m.y=q;m.textBaseline="alphabetic";m.textAlign="left";m.shadow=new createjs.Shadow("#000000",2,2,5);s_oStage.addChild(m);H=new createjs.Text(B,"40px "+FONT_GAME,"#fff");H.x=m.x+20;H.y=q;H.textBaseline="alphabetic";H.textAlign="left";H.shadow=new createjs.Shadow("#000000",2,2,5);s_oStage.addChild(H);u=CANVAS_WIDTH/2;r=40;y=new createjs.Text(TEXT_LEVEL+" "+s_iLevelSelected,"40px "+FONT_GAME,"#fff");y.x=u;y.y=r;y.textBaseline="alphabetic";y.textAlign="center";y.shadow=new createjs.Shadow("#000000",
2,2,5);s_oStage.addChild(y);v=new CPowerUpGui(s_oStage);W=new CAreYouSurePanel;W.addEventListener(ON_BUT_YES_DOWN,this._onExitYes,this);z=new CRollingScore;this.refreshButtonPos()};this.unload=function(){A.unload();A=null;S.unload();W.unload();!1===DISABLE_SOUND_MOBILE&&(x.unload(),x=null);J&&screenfull.isEnabled&&G.unload();s_bMobile?(D.unload(),P.unload(),U.unload()):(document.onkeydown=null,document.onkeyup=null);s_oStage.removeAllChildren();s_oInterface=null};this.reset=function(B,I){H.text=B;
y.text=TEXT_LEVEL+" "+I;v.reset()};this.refreshButtonPos=function(){m.x=p+s_iOffsetX;m.y=q+s_iOffsetY;H.x=m.x+m.getBounds().width+20;H.y=m.y;y.y=r+s_iOffsetY;S.refreshPos();s_bMobile&&(D.setPosition(b+s_iOffsetX,t-s_iOffsetY),P.setPosition(c-s_iOffsetX,e-s_iOffsetY),U.setPosition(k,h-s_iOffsetY));v.refreshButtonPos()};this.refreshScore=function(B){z.rolling(H,null,B)};this.refreshPowerUpTime=function(B){v.refreshTime(B)};this.showPowerUpGui=function(){v.show()};this.hidePowerUpGui=function(){v.hide()};
this._onLeftDown=function(){s_oGame.moveLeft(!0)};this._onRightDown=function(){s_oGame.moveRight(!0)};this._onJumpDown=function(){s_oGame.moveJump(!0)};this._onLeftUp=function(){s_oGame.moveLeft(!1)};this._onRightUp=function(){s_oGame.moveRight(!1)};this._onJumpUp=function(){s_oGame.moveJump(!1)};this._onExit=function(){W.show(TEXT_ARE_SURE)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){J&&screenfull.isEnabled&&G.setActive(s_bFullscreen)};
this._onFullscreenRelease=function(){s_bFullscreen?Q.call(window.document):J.call(window.document.documentElement);sizeHandler()};this._onExitYes=function(){s_oGame.onExit()};s_oInterface=this;this._init(a);return this}var s_oInterface=null;
function CHelpPanel(){var a,g,f,k,h,c,e,b,t,d,l,u=this;this._init=function(){l=new createjs.Container;l.visible=!1;s_oStage.addChild(l);k=new createjs.Shape;k.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);f=k.on("click",function(){});l.addChild(k);var r=s_oSpriteLibrary.getSprite("msg_box_wide"),p=createBitmap(r);p.regX=r.width/2;p.regY=r.height/2;p.x=CANVAS_WIDTH/2;p.y=CANVAS_HEIGHT/2;l.addChild(p);a=[];if(s_bMobile){p=s_oSpriteLibrary.getSprite("but_left");var q=
s_oSpriteLibrary.getSprite("but_right");r=s_oSpriteLibrary.getSprite("but_jump")}else p=s_oSpriteLibrary.getSprite("key_0"),q=s_oSpriteLibrary.getSprite("key_1"),r=s_oSpriteLibrary.getSprite("key_2");h=createBitmap(p);h.regX=p.width/2;h.regY=p.height/2;h.x=CANVAS_WIDTH/2-340;h.y=CANVAS_HEIGHT/2+130;l.addChild(h);a.push(h);c=createBitmap(q);c.regX=q.width/2;c.regY=q.height/2;c.x=CANVAS_WIDTH/2-220;c.y=CANVAS_HEIGHT/2+130;l.addChild(c);a.push(c);p=[];for(q=0;18>q;q++)p.push(s_oSpriteLibrary.getSprite("player_running_"+
q));t=this._attachPlayerRun();t.gotoAndPlay("anim");e=createBitmap(r);e.regX=r.width/2;e.regY=r.height/2;e.x=CANVAS_WIDTH/2+240;e.y=CANVAS_HEIGHT/2+130;l.addChild(e);a.push(e);p=[];for(q=0;26>q;q++)p.push(s_oSpriteLibrary.getSprite("player_jump_"+q));d=this._attachPlayerJump();d.on("animationend",this._onEndJump,this);b=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oSpriteLibrary.getSprite("but_next"),l);b.addEventListener(ON_MOUSE_UP,this._onStart,this);this._playAnims()};this.unload=function(){k.off("click",
f)};this.show=function(){l.alpha=0;l.visible=!0;createjs.Tween.get(l).to({alpha:1},500)};this.hide=function(){createjs.Tween.get(l).to({alpha:0},500,createjs.Ease.cubicOut).call(function(){clearInterval(g);l.visible=!1})};this._attachPlayerRun=function(){var r={images:[s_oSpriteLibrary.getSprite("player_running-0"),s_oSpriteLibrary.getSprite("player_running-1")],frames:[[1,1,404,403,0,-74,-45],[407,1,413,416,0,-68,-32],[822,1,421,429,0,-66,-19],[1245,1,420,440,0,-64,-8],[1,443,427,444,0,-58,-4],[430,
443,438,440,0,-53,-8],[870,443,447,432,0,-46,-16],[1319,443,454,416,0,-35,-32],[1,889,479,404,0,-22,-44],[482,889,507,407,0,-22,-41],[991,889,523,421,0,-39,-27],[1516,889,506,433,0,-65,-15],[1,1324,510,440,0,-74,-8],[513,1324,503,440,0,-75,-8],[1018,1324,475,436,0,-75,-12],[1495,1324,443,426,0,-75,-22],[1,1,421,410,1,-78,-38],[424,1,401,396,1,-83,-52]],animations:{start:0,anim:[0,17]}};r=new createjs.SpriteSheet(r);r=new createjs.Sprite(r,"start");r.scaleX=r.scaleY=.4;r.x=CANVAS_WIDTH/2-320;r.y=CANVAS_HEIGHT/
2+70;r.regX=304.5;r.regY=448;l.addChild(r);return r};this._attachPlayerJump=function(r,p){var q={images:[s_oSpriteLibrary.getSprite("player_jump-0"),s_oSpriteLibrary.getSprite("player_jump-1"),s_oSpriteLibrary.getSprite("player_jump-2")],frames:[[1,1,405,403,0,-266,-309],[408,1,415,457,0,-253,-255],[825,1,421,503,0,-243,-209],[1248,1,428,547,0,-227,-165],[1,550,438,581,0,-218,-131],[441,550,452,608,0,-213,-104],[895,550,481,632,0,-210,-80],[1378,550,545,655,0,-202,-57],[1,1207,589,678,0,-196,-34],
[592,1207,628,696,0,-197,-16],[1222,1207,663,705,0,-202,-7],[1,1,695,702,1,-207,-10],[698,1,724,693,1,-211,-19],[1,705,746,679,1,-215,-33],[749,705,761,660,1,-219,-52],[1,1386,767,638,1,-223,-74],[770,1386,754,614,1,-226,-98],[1,1,692,586,2,-232,-126],[695,1,644,556,2,-238,-156],[1341,1,588,525,2,-239,-187],[1,589,539,503,2,-238,-209],[542,589,518,489,2,-240,-223],[1062,589,488,472,2,-244,-240],[1552,589,447,452,2,-249,-260],[1,1094,420,429,2,-257,-283],[423,1094,404,403,2,-266,-309]],animations:{start:0,
anim:[0,25,"stop_anim"],stop_anim:25}};q=new createjs.SpriteSheet(q);q=new createjs.Sprite(q,"start");q.scaleX=q.scaleY=.4;q.x=CANVAS_WIDTH/2+180;q.y=CANVAS_HEIGHT/2-35;q.regX=304.5;q.regY=448;l.addChild(q);return q};this._playAnims=function(){var r=t.x+130,p=t.x;c.scaleX=c.scaleY=.9;createjs.Tween.get(t,{loop:!0}).to({x:r},2E3,createjs.Ease.cubicOut).call(function(){c.scaleX=c.scaleY=1;h.scaleX=h.scaleY=.9}).to({x:p},2E3,createjs.Ease.cubicOut).call(function(){h.scaleX=h.scaleY=1;c.scaleX=c.scaleY=
.9});g=setInterval(function(){e.scaleX=e.scaleY=.9;d.gotoAndPlay("anim")},3E3)};this._onEndJump=function(r){"anim"===r.currentTarget.currentAnimation&&(e.scaleX=e.scaleY=1)};this._onStart=function(){b.disable();u.hide();s_oGame.onExitFromHelp()};this._init()}
function CLevelSettings(){var a,g,f,k;this._init=function(){a=[16,20,22,24,26,28,30,30,32,34,36,38];g=[1500,1200,1E3,1200,1100,1E3,1E3,1200,1100,800,700,600];f=[1,1,1,2,2,2,2,3,3,2,2,2];k=[[4],[4],[5],[6],[7],[8],[9],[10],[11],[12],[4,9],[5,10]];NUM_LEVELS=a.length};this.getEnemiesSpawn=function(h){return a[h-1]};this.getStartingEnemySpawn=function(h){return g[h-1]};this.getEnemySpawnNumber=function(h){return f[h-1]};this.getPowerUps=function(h){return k[h-1]};this._init()}
function CLevelMenu(){var a,g,f,k,h,c,e,b,t,d,l,u,r,p,q,w,F,z,H,m=null,y=null;this._init=function(){e=0;z=new createjs.Container;s_oStage.addChild(z);var A=createBitmap(s_oSpriteLibrary.getSprite("bg_menu_level"));z.addChild(A);p=new createjs.Shape;p.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);p.alpha=.5;z.addChild(p);q=new createjs.Container;q.x=CANVAS_WIDTH/2;z.addChild(q);r=s_oSpriteLibrary.getSprite("msg_box_wide");A=createBitmap(r);q.addChild(A);new CTLText(q,0,0,r.width,
46,80,"center","#ffffff",FONT_GAME,1,20,2,TEXT_SELECT_LEVEL,!0,!0,!0,!1);A=s_oSpriteLibrary.getSprite("but_exit");h=CANVAS_WIDTH-A.width/2-10;c=A.height/2+10;w=new CGfxButton(h,c,A,s_oStage);w.addEventListener(ON_MOUSE_UP,this._onExit,this);q.regX=r.width/2;q.regY=r.height/2;b=-r.height/2;t=A.height;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)A=s_oSpriteLibrary.getSprite("audio_icon"),f=h-A.width/2-10,k=c,F=new CToggle(f,k,A,s_bAudioActive,s_oStage),F.addEventListener(ON_MOUSE_UP,this._onAudioToggle,
this);A=window.document;var v=A.documentElement;m=v.requestFullscreen||v.mozRequestFullScreen||v.webkitRequestFullScreen||v.msRequestFullscreen;y=A.exitFullscreen||A.mozCancelFullScreen||A.webkitExitFullscreen||A.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(m=!1);m&&screenfull.isEnabled&&(A=s_oSpriteLibrary.getSprite("but_fullscreen"),a=A.width/4+10,g=A.height/2+10,H=new CToggle(a,g,A,s_bFullscreen,s_oStage),H.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));this._checkBoundLimits();l=[];
A=Math.floor((r.width-100)/NUM_COLS_PAGE_LEVEL)/2;for(var x=v=0;x<NUM_COLS_PAGE_LEVEL;x++)l.push(v),v+=2*A;u=[];this._createNewLevelPage(0,NUM_LEVELS);this.refreshButtonPos();p.alpha=0;q.y=b;z.visible=!0;createjs.Tween.get(p).to({alpha:.7},500);createjs.Tween.get(q).to({y:CANVAS_HEIGHT/2},1E3,createjs.Ease.bounceOut)};this.unload=function(){for(var A=0;A<d.length;A++)d[A].unload();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||F.unload();m&&screenfull.isEnabled&&H.unload();w.unload();s_oStage.removeAllChildren();
s_oLevelMenu=null};this.refreshButtonPos=function(){w.setPosition(h-s_iOffsetX,c+s_iOffsetY);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||F.setPosition(f-s_iOffsetX,s_iOffsetY+k);m&&screenfull.isEnabled&&H.setPosition(a+s_iOffsetX,g+s_iOffsetY)};this._checkBoundLimits=function(){for(var A=s_oSpriteLibrary.getSprite("but_level"),v=0,x=CANVAS_HEIGHT-2*EDGEBOARD_Y-2*t,G=0;v<x;)v+=A.height+20,G++;NUM_ROWS_PAGE_LEVEL>G&&(NUM_ROWS_PAGE_LEVEL=G);x=v=0;G=CANVAS_WIDTH-2*EDGEBOARD_X;for(A=s_oSpriteLibrary.getSprite("but_level");x<
G;)x+=A.width/2+5,v++;NUM_COLS_PAGE_LEVEL>v&&(NUM_COLS_PAGE_LEVEL=v)};this._createNewLevelPage=function(A,v){var x=new createjs.Container;q.addChild(x);u.push(x);d=[];for(var G=0,D=0,P=1,U=!1,J=s_oSpriteLibrary.getSprite("but_level"),Q=A;Q<v;Q++){var S=new CLevelBut(l[G]+J.width/4,D+J.height/2,Q+1,J,Q+1>s_iLastLevel?!1:!0,x);S.addEventListenerWithParams(ON_MOUSE_UP,this._onButLevelRelease,this,Q);d.push(S);G++;if(G===l.length&&(G=0,D+=J.height+70,P++,P>NUM_ROWS_PAGE_LEVEL&&Q!==v-1)){U=!0;break}}x.x=
r.width/2;x.y=r.height/2;x.regX=x.getBounds().width/2;x.regY=x.getBounds().height/2;U&&this._createNewLevelPage(Q+1,v)};this._onRight=function(){u[e].visible=!1;e++;e>=u.length&&(e=0);u[e].visible=!0};this._onLeft=function(){u[e].visible=!1;e--;0>e&&(e=u.length-1);u[e].visible=!0};this._onButLevelRelease=function(A){s_oLevelMenu.unload();s_oMain.levelSelected(A+1)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){m&&screenfull.isEnabled&&
H.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?y.call(window.document):m.call(window.document.documentElement);sizeHandler()};this._onExit=function(){s_oLevelMenu.unload();s_oMain.gotoMenu()};s_oLevelMenu=this;this._init()}var s_oLevelMenu=null;
function CLevelBut(a,g,f,k,h,c){var e,b,t,d=[],l=[],u,r,p,q;this._init=function(F,z,H,m,y){b=[];t=[];q=new createjs.Container;w.addChild(q);var A=new createjs.SpriteSheet({images:[m],frames:{width:m.width/2,height:m.height,regX:m.width/2/2,regY:m.height/2},animations:{state_true:[0],state_false:[1]}});e=y;p=createSprite(A,"state_"+e,m.width/2/2,m.height/2,m.width/2,m.height);p.mouseEnabled=y;p.x=F;p.y=z;p.stop();s_bMobile||(q.cursor="pointer");q.addChild(p);d.push(p);u=new createjs.Text(H,"60px "+
FONT_GAME,"#00397a");u.x=F;u.y=z+10;u.textAlign="center";u.textBaseline="alphabetic";u.lineWidth=200;u.outline=6;q.addChild(u);r=new createjs.Text(H,"60px "+FONT_GAME,"#fff");r.x=F;r.y=z+10;r.textAlign="center";r.textBaseline="alphabetic";r.lineWidth=200;q.addChild(r);y||(r.color="#b4b4b4",u.color="#0264d3");this._initListener()};this.unload=function(){q.off("mousedown",this.buttonDown);q.off("pressup",this.buttonRelease);q.removeChild(p)};this._initListener=function(){q.on("mousedown",this.buttonDown);
q.on("pressup",this.buttonRelease)};this.viewBut=function(F){q.addChild(F)};this.addEventListener=function(F,z,H){b[F]=z;t[F]=H};this.addEventListenerWithParams=function(F,z,H,m){b[F]=z;t[F]=H;l=m};this.ifClickable=function(){return!0===q.mouseEnabled?1:0};this.setActive=function(F,z){e=z;d[F].gotoAndStop("state_"+e);d[F].mouseEnabled=!0;e?(r.color="#00397a",u.color="#fff"):(r.color="#b4b4b4",u.color="#0264d3")};this.buttonRelease=function(){e&&(playSound("click",1,!1),b[ON_MOUSE_UP]&&b[ON_MOUSE_UP].call(t[ON_MOUSE_UP],
l))};this.buttonDown=function(){b[ON_MOUSE_DOWN]&&b[ON_MOUSE_DOWN].call(t[ON_MOUSE_DOWN],l)};this.setPosition=function(F,z){q.x=F;q.y=z};this.setVisible=function(F){q.visible=F};var w=c;this._init(a,g,f,k,h,c)}
function CCreditsPanel(){var a,g,f,k,h,c,e;this._init=function(){e=new createjs.Container;s_oStage.addChild(e);var b=new createjs.Shape;b.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);e.addChild(b);b=s_oSpriteLibrary.getSprite("msg_box");a=createBitmap(b);a.regX=b.width/2;a.regY=b.height/2;a.x=CANVAS_WIDTH/2;a.y=CANVAS_HEIGHT/2;e.addChild(a);h=new createjs.Shape;h.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);h.alpha=.01;h.on("click",this._onLogoButRelease);
e.addChild(h);b=s_oSpriteLibrary.getSprite("but_exit");f=new CGfxButton(980,240,b,e);f.addEventListener(ON_MOUSE_UP,this.unload,this);k=new createjs.Text(TEXT_CREDITS_DEVELOPED,"26px "+FONT_GAME,"#fff");k.textAlign="center";k.textBaseline="alphabetic";k.x=CANVAS_WIDTH/2;k.y=330;e.addChild(k);b=s_oSpriteLibrary.getSprite("logo_ctl");g=createBitmap(b);g.regX=b.width/2;g.regY=b.height/2;g.x=CANVAS_WIDTH/2;g.y=CANVAS_HEIGHT/2;e.addChild(g);c=new createjs.Text("www.codethislab.com","16px "+FONT_GAME,"#fff");
c.textAlign="center";c.textBaseline="alphabetic";c.x=CANVAS_WIDTH/2;c.y=440;e.addChild(c)};this.unload=function(){h.off("click",this._onLogoButRelease);f.unload();f=null;s_oStage.removeChild(e)};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en","_blank")};this._init()}
function CAlertSavingBox(a,g){var f,k;this._init=function(e){k=new createjs.Container;c.addChild(k);var b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.alpha=.5;b.on("click",function(){});k.addChild(b);b=s_oSpriteLibrary.getSprite("msg_box");var t=createBitmap(b);t.x=.5*CANVAS_WIDTH;t.y=.5*CANVAS_HEIGHT;t.regX=.5*b.width;t.regY=.5*b.height;k.addChild(t);new CTLText(k,CANVAS_WIDTH/2-b.width/2,CANVAS_HEIGHT/2-140,b.width,190,40,"center","#ffffff",FONT_GAME,
1,20,10,e,!0,!0,!0,!1);f=new CGfxButton(CANVAS_WIDTH/2,475,s_oSpriteLibrary.getSprite("but_exit"),k);f.addEventListener(ON_MOUSE_UP,this._onButOk,this)};this._onButOk=function(){h.unload()};this.unload=function(){f.unload();c.removeChild(k)};var h=this;var c=g;this._init(a)}
function CAreYouSurePanel(){var a,g,f,k,h,c,e,b,t=this;this._init=function(){a=[];g=[];e=new createjs.Container;e.visible=!1;s_oStage.addChild(e);b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.alpha=.5;b.on("click",function(){});e.addChild(b);var d=s_oSpriteLibrary.getSprite("msg_box");f=createBitmap(d);f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2;f.regX=.5*d.width;f.regY=.5*d.height;e.addChild(f);k=new CTLText(e,CANVAS_WIDTH/2-d.width/2,CANVAS_HEIGHT/2-d.height/
2,d.width,150,70,"center","#ffffff",FONT_GAME,1,40,10,TEXT_ARE_SURE,!0,!0,!0,!1);h=new CGfxButton(CANVAS_WIDTH/2+150,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_yes"),e);h.addEventListener(ON_MOUSE_UP,this._onButYes,this);c=new CGfxButton(CANVAS_WIDTH/2-150,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_no"),e);c.addEventListener(ON_MOUSE_UP,this._onButNo,this)};this.addEventListener=function(d,l,u){a[d]=l;g[d]=u};this.show=function(d){k.refreshText(d);e.alpha=0;e.visible=!0;createjs.Tween.get(e).to({alpha:1},
300,createjs.Ease.quartOut).call(function(){s_oMain.stopUpdateNoBlock()})};this.hide=function(){s_oMain.startUpdateNoBlock();createjs.Tween.get(e).to({alpha:0},500,createjs.Ease.quartOut).call(function(){e.visible=!1})};this.unload=function(){c.unload();h.unload()};this._onButYes=function(){t.hide();a[ON_BUT_YES_DOWN]&&a[ON_BUT_YES_DOWN].call(g[ON_BUT_YES_DOWN])};this._onButNo=function(){t.hide()};this._init()}
function CGUIExpandible(a,g,f,k){var h,c,e,b,t,d,l,u;this._init=function(p,q,w,F){b=[];d=new createjs.Container;d.x=p;d.y=q;F.addChild(d);l=new createjs.Container;d.addChild(l);u=new createjs.Container;d.addChild(u);e=!1;t=new CGfxButton(0,0,w,u);t.addEventListener(ON_MOUSE_UP,this._onMenu,this);c=h=85};this.unload=function(){t.unload();k.removeChild(d)};this.refreshPos=function(){d.x=a-s_iOffsetX;d.y=g+s_iOffsetY};this.addButton=function(p){p=p.getButtonImage();p.x=0;p.y=0;p.visible=0;l.addChildAt(p,
0);b.push(p)};this._onMenu=function(){(e=!e)?r._expand():r._collapse()};this._expand=function(){for(var p=0;p<b.length;p++)b[p].visible=!0,createjs.Tween.get(b[p],{override:!0}).wait(300*p/2).to({y:h+p*c},300,createjs.Ease.cubicOut)};this._collapse=function(){for(var p=0;p<b.length;p++){var q=b[b.length-1-p];createjs.Tween.get(q,{override:!0}).wait(300*p/2).to({y:0},300,createjs.Ease.cubicOut).call(function(w){w.visible=!1},[q])}};var r=this;this._init(a,g,f,k)}
function CField(a,g,f){var k=!1,h,c,e,b;this._init=function(d,l){b=new createjs.Container;b.visible=!1;b.x=d;b.y=l;t.addChild(b);e=[];for(var u=0;18>u;u++){var r=createBitmap(s_oSpriteLibrary.getSprite("field_loop_"+u));b.addChild(r);e.push(r);0<u&&(r.visible=!1)}};this.show=function(){h=e.length;e[0].visible=!0;c=0;k=b.visible=!0};this.hide=function(){b.visible=!1};this.playToFrame=function(d){e[c].visible=!1;c=d;e[c].visible=!0};this.nextFrame=function(){e[c].visible=!1;c++;e[c].visible=!0};this.update=
function(){!1!==k&&(c===h-1?this.playToFrame(0):this.nextFrame())};var t=f;this._init(a,g)}
function CFieldEndZone(a,g,f){var k=!1,h,c,e,b;this._init=function(d,l){b=new createjs.Container;b.visible=!1;b.x=d;b.y=l;t.addChild(b);e=[];for(var u=0;39>u;u++){var r=createBitmap(s_oSpriteLibrary.getSprite("end_zone_"+u));b.addChild(r);e.push(r);0<u&&(r.visible=!1)}};this.show=function(){h=e.length;e[0].visible=!0;c=0;k=b.visible=!0};this.hide=function(){b.visible=!1};this.reset=function(){for(var d=0;d<e.length;d++)e[d].visible=!1;b.visible=!1};this.playToFrame=function(d){e[c].visible=!1;c=d;
e[c].visible=!0};this.nextFrame=function(){e[c].visible=!1;c++;e[c].visible=!0};this.update=function(){!1!==k&&(c===h-1?(k=!1,s_oGame.endZonePlayed()):this.nextFrame())};var t=f;this._init(a,g)}
function CPlayer(a,g,f){var k=!1,h,c=!1,e=!1,b,t,d,l,u,r,p,q,w,F,z,H,m=this,y;this._init=function(v,x){h=!1;t=v;d=x;r=0;l=HERO_ACCELERATION;u=MAX_HERO_SPEED;z=[];H=[];y=new createjs.Container;y.x=v;y.y=x;A.addChild(y);w=[];F=[];F[PLAYER_ANIM_RUN]=18;F[PLAYER_ANIM_FALL]=9;F[PLAYER_ANIM_TOUCHDOWN]=50;F[PLAYER_ANIM_JUMP]=26;var G={images:[s_oSpriteLibrary.getSprite("player_running-0"),s_oSpriteLibrary.getSprite("player_running-1")],frames:[[1,1,404,403,0,-74,-45],[407,1,413,416,0,-68,-32],[822,1,421,
429,0,-66,-19],[1245,1,420,440,0,-64,-8],[1,443,427,444,0,-58,-4],[430,443,438,440,0,-53,-8],[870,443,447,432,0,-46,-16],[1319,443,454,416,0,-35,-32],[1,889,479,404,0,-22,-44],[482,889,507,407,0,-22,-41],[991,889,523,421,0,-39,-27],[1516,889,506,433,0,-65,-15],[1,1324,510,440,0,-74,-8],[513,1324,503,440,0,-75,-8],[1018,1324,475,436,0,-75,-12],[1495,1324,443,426,0,-75,-22],[1,1,421,410,1,-78,-38],[424,1,401,396,1,-83,-52]],animations:{start:0,anim:[0,F[PLAYER_ANIM_RUN]-1]}};G=new createjs.SpriteSheet(G);
w[PLAYER_ANIM_RUN]=new createjs.Sprite(G,"start");w[PLAYER_ANIM_RUN].regX=304.5;w[PLAYER_ANIM_RUN].regY=448;y.addChild(w[PLAYER_ANIM_RUN]);G={images:[s_oSpriteLibrary.getSprite("player_falling")],frames:[[1,1,404,403,0,-74,-45],[407,1,404,403,0,-74,-45],[813,1,424,403,0,-63,-45],[1239,1,449,400,0,-50,-48],[1,406,477,377,0,-36,-71],[480,406,550,309,0,-16,-139],[1032,406,550,309,0,-16,-139],[1,785,582,248,0,-4,-200],[585,785,596,88,0,-7,-360]],animations:{start:0,anim:[0,F[PLAYER_ANIM_FALL]-1,"stop_anim"],
stop_anim:F[PLAYER_ANIM_FALL]}};G=new createjs.SpriteSheet(G);w[PLAYER_ANIM_FALL]=new createjs.Sprite(G,"start");w[PLAYER_ANIM_FALL].on("animationend",this._onPlayerFall,this);w[PLAYER_ANIM_FALL].visible=!1;w[PLAYER_ANIM_FALL].regX=304.5;w[PLAYER_ANIM_FALL].regY=448;y.addChild(w[PLAYER_ANIM_FALL]);G={images:[s_oSpriteLibrary.getSprite("player_touchdown-0"),s_oSpriteLibrary.getSprite("player_touchdown-1")],frames:[[1,1,401,396,0,-83,-52],[404,1,385,386,0,-95,-62],[791,1,361,370,0,-113,-78],[1154,1,
343,357,0,-128,-91],[1499,1,322,362,0,-135,-86],[1,399,304,370,0,-138,-78],[307,399,296,377,0,-142,-71],[605,399,289,384,0,-145,-64],[896,399,281,383,0,-149,-65],[1179,399,277,383,0,-150,-65],[1458,399,273,381,0,-152,-67],[1733,399,269,378,0,-157,-70],[1,785,260,377,0,-172,-71],[263,785,241,375,0,-192,-73],[506,785,218,374,0,-202,-74],[726,785,197,376,0,-204,-72],[925,785,215,378,0,-201,-70],[1142,785,223,380,0,-194,-68],[1367,785,230,381,0,-184,-67],[1599,785,238,383,0,-182,-65],[1,1170,261,383,
0,-183,-65],[264,1170,279,383,0,-185,-65],[545,1170,286,382,0,-188,-66],[833,1170,294,379,0,-195,-69],[1129,1170,291,376,0,-201,-72],[1422,1170,275,373,0,-210,-75],[1699,1170,259,368,0,-215,-80],[1,1555,241,363,0,-218,-84],[244,1555,236,353,0,-210,-86],[482,1555,251,345,0,-189,-89],[735,1555,283,335,0,-154,-92],[1020,1555,307,326,0,-131,-94],[1329,1555,301,315,0,-137,-97],[1632,1555,287,318,0,-149,-89],[1,1,289,283,1,-148,-120],[292,1,282,259,1,-157,-142],[576,1,259,234,1,-188,-166],[1,286,244,211,
1,-213,-185],[247,286,237,195,1,-229,-199],[486,286,229,178,1,-242,-210],[717,286,224,161,1,-246,-221],[1,499,231,154,1,-253,-229],[234,499,241,145,1,-260,-237],[477,499,241,153,1,-264,-228],[720,499,223,154,1,-270,-226],[1,655,190,156,1,-277,-224],[193,655,184,155,1,-266,-224],[379,655,184,155,1,-268,-223],[565,655,181,157,1,-275,-221],[748,655,183,161,1,-275,-216],[1,818,188,169,1,-275,-207],[191,818,192,180,1,-273,-196],[385,818,196,188,1,-273,-188],[583,818,199,193,1,-273,-183],[784,818,203,199,
1,-272,-177],[1,1019,207,204,1,-271,-172],[210,1019,208,207,1,-270,-169],[420,1019,207,206,1,-271,-170],[629,1019,219,202,1,-269,-174],[1,1228,240,193,1,-269,-183],[243,1228,258,181,1,-268,-195],[503,1228,274,168,1,-268,-208],[1,1423,294,145,1,-268,-231],[297,1423,315,134,1,-267,-242],[614,1423,328,136,1,-267,-240],[1,1570,333,136,1,-266,-240],[336,1570,334,128,1,-265,-248],[672,1570,328,114,1,-265,-262]],animations:{start:0,anim:[0,F[PLAYER_ANIM_TOUCHDOWN]-1,"stop_anim"],stop_anim:F[PLAYER_ANIM_TOUCHDOWN]-
1}};G=new createjs.SpriteSheet(G);w[PLAYER_ANIM_TOUCHDOWN]=new createjs.Sprite(G,"start");w[PLAYER_ANIM_TOUCHDOWN].on("animationend",this._onPlayerTouchdown,this);w[PLAYER_ANIM_TOUCHDOWN].visible=!1;w[PLAYER_ANIM_TOUCHDOWN].regX=304.5;w[PLAYER_ANIM_TOUCHDOWN].regY=448;y.addChild(w[PLAYER_ANIM_TOUCHDOWN]);G={images:[s_oSpriteLibrary.getSprite("player_jump-0"),s_oSpriteLibrary.getSprite("player_jump-1"),s_oSpriteLibrary.getSprite("player_jump-2")],frames:[[1,1,405,403,0,-266,-309],[408,1,415,457,0,
-253,-255],[825,1,421,503,0,-243,-209],[1248,1,428,547,0,-227,-165],[1,550,438,581,0,-218,-131],[441,550,452,608,0,-213,-104],[895,550,481,632,0,-210,-80],[1378,550,545,655,0,-202,-57],[1,1207,589,678,0,-196,-34],[592,1207,628,696,0,-197,-16],[1222,1207,663,705,0,-202,-7],[1,1,695,702,1,-207,-10],[698,1,724,693,1,-211,-19],[1,705,746,679,1,-215,-33],[749,705,761,660,1,-219,-52],[1,1386,767,638,1,-223,-74],[770,1386,754,614,1,-226,-98],[1,1,692,586,2,-232,-126],[695,1,644,556,2,-238,-156],[1341,1,
588,525,2,-239,-187],[1,589,539,503,2,-238,-209],[542,589,518,489,2,-240,-223],[1062,589,488,472,2,-244,-240],[1552,589,447,452,2,-249,-260],[1,1094,420,429,2,-257,-283],[423,1094,404,403,2,-266,-309]],animations:{start:0,anim:[0,F[PLAYER_ANIM_JUMP]-1,"stop_anim"],stop_anim:F[PLAYER_ANIM_JUMP]}};G=new createjs.SpriteSheet(G);w[PLAYER_ANIM_JUMP]=new createjs.Sprite(G,"start");w[PLAYER_ANIM_JUMP].on("animationend",this._onPlayerJump);w[PLAYER_ANIM_JUMP].visible=!1;w[PLAYER_ANIM_JUMP].x=-200;w[PLAYER_ANIM_JUMP].y=
-220;w[PLAYER_ANIM_JUMP].regX=304.5;w[PLAYER_ANIM_JUMP].regY=448;y.addChild(w[PLAYER_ANIM_JUMP]);b=PLAYER_ANIM_RUN};this.addEventListener=function(v,x,G){z[v]=x;H[v]=G};this.show=function(){w[b].visible=!0;w[b].gotoAndPlay("anim");y.visible=!0;p=y.getBounds().width-200;q=y.getBounds().height;k=!0};this.hide=function(){k=!1;y.visible=!1};this.reset=function(){e=c=h=k=!1;r=0;l=HERO_ACCELERATION;u=MAX_HERO_SPEED;y.alpha=1;y.x=t;y.y=d;w[PLAYER_ANIM_RUN].visible=!1;w[PLAYER_ANIM_FALL].visible=!1;w[PLAYER_ANIM_TOUCHDOWN].visible=
!1;w[PLAYER_ANIM_JUMP].visible=!1;b=PLAYER_ANIM_RUN};this.changeAnim=function(v){w[b].visible=!1;w[b].gotoAndStop("start");b=v;w[b].visible=!0;w[b].gotoAndPlay("anim")};this.jump=function(){h=!0;this.changeAnim(PLAYER_ANIM_JUMP)};this.moveLeft=function(v){c=v};this.moveRight=function(v){e=v};this.setAcceleration=function(v,x){l=v;u=x};this.setY=function(v){y.y=v};this._onPlayerFall=function(v){"anim"===v.currentTarget.currentAnimation&&(m.hide(),z[ON_PLAYER_TACKLED]&&z[ON_PLAYER_TACKLED].call(H[ON_PLAYER_TACKLED]))};
this._onPlayerTouchdown=function(v){"anim"===v.currentTarget.currentAnimation&&((new createjs.Tween.get(y)).to({alpha:0},500),z[ON_PLAYER_TOUCHDOWN]&&z[ON_PLAYER_TOUCHDOWN].call(H[ON_PLAYER_TOUCHDOWN]))};this._onPlayerJump=function(v){"anim"===v.currentTarget.currentAnimation&&(h=!1,m.changeAnim(PLAYER_ANIM_RUN))};this.getRect=function(){return new createjs.Rectangle(y.x-p/2,y.y-q,p,q)};this.isJumping=function(){return h};this.getCurAnim=function(){return b};this.getX=function(){return y.x};this._updateMove=
function(){b===PLAYER_ANIM_RUN&&(c&&(r-=l),e&&(r+=l),y.x+=r,r*=HERO_FRICTION,r>u&&(r=u),r<-u&&(r=-u),.1>Math.abs(r)&&(r=0),y.x+r>CANVAS_WIDTH-s_iOffsetX&&(y.x=CANVAS_WIDTH-r-s_iOffsetX),y.x-r<s_iOffsetX&&(y.x=r+s_iOffsetX))};this.update=function(){!1!==k&&this._updateMove()};var A=f;this._init(a,g)}
function COpponent(a,g,f,k){var h,c,e=!1,b,t,d,l,u,r,p,q,w,F,z,H=this;this._init=function(y,A){w=[];F=[];h=y;c=A;z=new createjs.Container;z.x=y;z.y=A;z.scaleX=z.scaleY=.1;m.addChild(z);q=[];q[PLAYER_ANIM_RUN]=18;q[PLAYER_ANIM_FALL]=18;p=[];p[PLAYER_ANIM_RUN]=[];for(var v=0;v<q[PLAYER_ANIM_RUN];v++){var x=s_oSpriteLibrary.getSprite("enemy_running_"+v),G=createBitmap(x);G.visible=!1;G.regX=x.width/2;G.regY=x.height;z.addChild(G);p[PLAYER_ANIM_RUN].push(G);u=x.width-500;r=x.height}p[PLAYER_ANIM_FALL]=
[];for(v=0;v<q[PLAYER_ANIM_FALL];v++)x=s_oSpriteLibrary.getSprite("enemy_tackle_"+v),G=createBitmap(x),G.visible=!1,G.regX=x.width/2,G.regY=x.height,z.addChild(G),p[PLAYER_ANIM_FALL].push(G);b=PLAYER_ANIM_RUN;this.show()};this.addEventListener=function(y,A,v){w[y]=A;F[y]=v};this.reset=function(){z.x=h;z.y=c;z.scaleX=z.scaleY=.1;for(var y=0;y<q[PLAYER_ANIM_RUN];y++)p[PLAYER_ANIM_RUN][y].visible=!1;for(y=0;y<q[PLAYER_ANIM_FALL];y++)p[PLAYER_ANIM_FALL][y].visible=!1;b=PLAYER_ANIM_RUN};this.show=function(){e=
!1;t=1;this.reset();H._startRun()};this._startRun=function(){d=q[b];p[b][0].visible=!0;l=Math.floor(Math.random()*p[PLAYER_ANIM_RUN].length);z.alpha=0;z.visible=!0;(new createjs.Tween.get(z)).to({alpha:1},500);(new createjs.Tween.get(z)).to({scaleX:1,scaleY:1,y:OPPONENT_FINAL_Y},TIME_OPPONENT_RUN,createjs.Ease.cubicIn).call(function(){if(w[ON_OPPONENT_TACKLE]){var y=new createjs.Rectangle(z.x-u/2,z.y-r,u,r);w[ON_OPPONENT_TACKLE].call(F[ON_OPPONENT_TACKLE],y)}});(new createjs.Tween.get(z)).wait(2500).call(function(){s_oGame.getPlayerX()>
z.x&&(t=-1);H._changeAnim(PLAYER_ANIM_FALL,Math.floor(4*Math.random()));playSound("enemy",1,!1)});setTimeout(function(){},2500);e=!0};this.hide=function(){e=!1;z.visible=!1;w[ON_OPPONENT_HIDE]&&w[ON_OPPONENT_HIDE].call(F[ON_OPPONENT_HIDE],a)};this.playToFrame=function(y){p[b][l].visible=!1;l=y;p[b][l].scaleX=t;p[b][l].visible=!0};this.nextFrame=function(){p[b][l].visible=!1;l++;p[b][l].scaleX=t;p[b][l].visible=!0};this._changeAnim=function(y,A){e=!1;p[b][l].visible=!1;b=y;l=A;p[b][l].visible=!0;d=
q[b];e=!0};this.update=function(){!1!==e&&(l===d-1?b===PLAYER_ANIM_RUN?this.playToFrame(0):this.hide():this.nextFrame())};var m=k;this._init(g,f)}
function CEndPanel(){var a,g,f,k,h,c,e,b,t,d,l,u,r=this;this._init=function(){f=[];k=[];l=new createjs.Container;l.visible=!1;s_oStage.addChild(l);c=new createjs.Shape;c.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);c.alpha=0;h=c.on("click",function(){});l.addChild(c);u=new createjs.Container;u.x=CANVAS_WIDTH/2;l.addChild(u);var p=s_oSpriteLibrary.getSprite("msg_box_wide"),q=createBitmap(p);u.addChild(q);e=new CTLText(u,0,0,p.width,120,80,"center","#ffffff",FONT_GAME,1,40,10,
"",!0,!0,!0,!1);b=new CTLText(u,0,p.height/2-60,p.width,80,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);t=new CGfxButton(p.width/2-250,p.height/2+120,s_oSpriteLibrary.getSprite("but_home"),u);t.addEventListener(ON_MOUSE_UP,this._onHome,this);d=new CGfxButton(p.width/2+250,p.height/2+120,s_oSpriteLibrary.getSprite("but_restart"),u);d.addEventListener(ON_MOUSE_UP,this._onRestart,this);a=-p.height/2;u.regX=p.width/2;u.regY=p.height/2};this.unload=function(){t.unload();d.unload();c.off("click",
h)};this.addEventListener=function(p,q,w){f[p]=q;k[p]=w};this.show=function(p,q){setVolume("soundtrack",0);(q===TEXT_CONGRATS?playSound("level_win",1,!1):playSound("game_over",1,!1)).on("end",function(){setVolume("soundtrack",1)});e.refreshText(q);b.refreshText(TEXT_SCORE+": "+p);c.alpha=0;u.y=a;l.visible=!0;createjs.Tween.get(c).to({alpha:.7},500);createjs.Tween.get(u).wait(400).to({y:CANVAS_HEIGHT/2},1E3,createjs.Ease.bounceOut).call(function(){r.enableButtons()})};this.hide=function(){createjs.Tween.get(u).to({y:a},
1E3,createjs.Ease.backIn).call(function(){l.visible=!1;f[g]&&f[g].call(k[g])})};this.enableButtons=function(){t.enable();d.enable()};this.disableButtons=function(){t.disable();d.disable()};this._onHome=function(){r.disableButtons();g=ON_BACK_MENU;r.hide()};this._onRestart=function(){r.disableButtons();$(s_oMain).trigger("show_interlevel_ad");g=ON_RESTART;r.hide()};this._init()}
function CPowerUp(a,g,f,k){var h,c,e,b;this._init=function(t,d,l){h=l;c=[];e=[];b=new createjs.Container;b.scaleX=b.scaleY=.1;b.x=t;b.y=d;k.addChild(b);d={images:[s_oSpriteLibrary.getSprite("power_up_"+h)],framerate:15,frames:{width:286,height:404},animations:{start:0,anim:[0,14]}};d=new createjs.SpriteSheet(d);d=createSprite(d,"anim",0,0,286,404);b.addChild(d);b.regX=143;b.regY=202;b.alpha=0;var u=(t-MIN_POWERUP_X)/(MAX_POWERUP_X-MIN_POWERUP_X)*1140;(new createjs.Tween.get(b)).to({alpha:1},500);
(new createjs.Tween.get(b)).to({scaleX:1,scaleY:1,x:u,y:POWERUP_FINAL_Y},1.5*TIME_OPPONENT_RUN,createjs.Ease.cubicIn).call(function(){if(c[ON_POWERUP_END_MOVE]){var r=new createjs.Rectangle(u-143,POWERUP_FINAL_Y-202,286,404);c[ON_POWERUP_END_MOVE].call(e[ON_POWERUP_END_MOVE],r,h);k.removeChild(b)}})};this.unload=function(){k.removeChild(b)};this.addEventListener=function(t,d,l){c[t]=d;e[t]=l};this.stopTween=function(){createjs.Tween.removeTweens(b)};this._init(a,g,f)}
function CNextLevelPanel(){var a,g,f,k,h,c,e,b,t,d,l,u,r,p,q=this;this._init=function(){f=[];k=[];r=new createjs.Container;r.visible=!1;s_oStage.addChild(r);c=new createjs.Shape;c.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);c.alpha=0;h=c.on("click",function(){});r.addChild(c);p=new createjs.Container;p.x=CANVAS_WIDTH/2;r.addChild(p);var w=s_oSpriteLibrary.getSprite("msg_box_wide"),F=createBitmap(w);p.addChild(F);b=new CTLText(p,0,0,w.width,120,80,"center","#ffffff",FONT_GAME,
1,40,10,"",!0,!0,!0,!1);e=new CTLText(p,0,w.height/2-70,w.width,60,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);t=new CTLText(p,0,w.height/2,w.width,60,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);d=new CGfxButton(w.width/2-250,w.height/2+120,s_oSpriteLibrary.getSprite("but_home"),p);d.addEventListener(ON_MOUSE_UP,this._onHome,this);l=new CGfxButton(w.width/2,w.height/2+120,s_oSpriteLibrary.getSprite("but_restart"),p);l.addEventListener(ON_MOUSE_UP,this._onRestart,this);u=new CGfxButton(w.width/
2+250,w.height/2+120,s_oSpriteLibrary.getSprite("but_next"),p);u.addEventListener(ON_MOUSE_UP,this._onNext,this);a=-w.height/2;p.regX=w.width/2;p.regY=w.height/2};this.unload=function(){d.unload();l.unload();c.off("click",h)};this.addEventListener=function(w,F,z){f[w]=F;k[w]=z};this.show=function(w,F,z){setVolume("soundtrack",0);playSound("level_win",1,!1).on("end",function(){setVolume("soundtrack",1)});b.refreshText(sprintf(TEXT_LEVEL_CLEARED,z));e.refreshText(TEXT_LEVEL_SCORE+": "+w);t.refreshText(TEXT_SCORE+
": "+F);c.alpha=0;p.y=a;r.visible=!0;createjs.Tween.get(c).to({alpha:.7},500);createjs.Tween.get(p).wait(400).to({y:CANVAS_HEIGHT/2},1E3,createjs.Ease.bounceOut).call(function(){q.enableButtons()})};this.hide=function(){createjs.Tween.get(p).to({y:a},1E3,createjs.Ease.backIn).call(function(){r.visible=!1;f[g]&&f[g].call(k[g])})};this.enableButtons=function(){d.enable();u.enable();l.enable()};this.disableButtons=function(){d.disable();u.disable();l.disable()};this._onHome=function(){q.disableButtons();
g=ON_BACK_MENU;q.hide()};this._onRestart=function(){q.disableButtons();$(s_oMain).trigger("show_interlevel_ad");g=ON_RESTART;q.hide()};this._onNext=function(){q.disableButtons();$(s_oMain).trigger("show_interlevel_ad");g=ON_NEXT_LEVEL;q.hide()};this._init()}var MS_ROLLING_SCORE=400;
function CRollingScore(){var a=null,g=null;this.rolling=function(f,k,h){a=createjs.Tween.get(f).to({text:h},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(a);f.color="#fff"}).addEventListener("change",function(){f.text=Math.floor(f.text)});null!==k&&(g=createjs.Tween.get(k).to({text:h},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(g)}).addEventListener("change",function(){k.text=Math.floor(k.text)}))};return this}
function CScoreText(a,g,f,k){var h;this._init=function(c,e,b){h=new createjs.Text("+"+c," 80px "+FONT_GAME,"#fff");h.textAlign="center";h.x=e;h.y=b;h.alpha=0;h.shadow=new createjs.Shadow("#000",1,1,1);k.addChild(h);var t=this;createjs.Tween.get(h).to({alpha:1},200,createjs.Ease.quadIn).call(function(){t.moveUp()})};this.moveUp=function(){var c=h.y-400,e=this;createjs.Tween.get(h).to({y:c},1500,createjs.Ease.sineIn).call(function(){e.unload()});createjs.Tween.get(h).wait(800).to({alpha:0},500)};this.unload=
function(){k.removeChild(h)};this._init(a,g,f)}
function CPowerUpGui(a){var g,f,k,h,c,e,b;this._init=function(){var t=s_oSpriteLibrary.getSprite("powerup_gui_off");k=t.width;h=t.height;g=CANVAS_WIDTH-t.width-10;f=CANVAS_HEIGHT-t.height-10;b=new createjs.Container;b.x=g;b.y=f;b.visible=!1;a.addChild(b);var d=createBitmap(t);b.addChild(d);d=createBitmap(s_oSpriteLibrary.getSprite("powerup_gui_on"));b.addChild(d);e=new createjs.Shape;e.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,t.width,t.height);b.addChild(e);d.mask=e;c=new createjs.Text("00:00",
"20px "+FONT_GAME,"#fff");c.x=t.width/2;c.y=-10;c.textBaseline="alphabetic";c.textAlign="center";b.addChild(c)};this.refreshButtonPos=function(){b.x=g-s_iOffsetX;b.y=f-s_iOffsetY};this.reset=function(){b.visible=!1};this.show=function(){this.refreshTime(0);b.x+=k+10;b.visible=!0;createjs.Tween.get(b).to({x:g-s_iOffsetX},1E3,createjs.Ease.backOut)};this.hide=function(){createjs.Tween.get(b).to({x:b.x+k+10},1E3,createjs.Ease.backIn).call(function(){b.visible=!1})};this.refreshTime=function(t){c.text=
formatTime(TIME_EFFECT_POWERUP-t);e.graphics.clear();t=Math.floor((100-Math.floor(t/TIME_EFFECT_POWERUP*100))*k/100);e.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,t,h)};this._init()}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var a=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(a--,this._oText.font=a+"px "+this._szFont,this._oText.lineHeight=Math.round(a*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>a););this._iFontSize=a}},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(a){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(a,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(a)},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){null!==this._oText&&(this._oText.outline=a)},setShadow:function(a,g,f,k){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(a,g,f,k))},setColor:function(a){this._oText.color=a},setAlpha:function(a){this._oText.alpha=a},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},
refreshText:function(a){""===a&&(a=" ");null===this._oText&&this.__createText(a);this._oText.text=a;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(a,g,f,k,h,c,e,b,t,d,l,u,r,p,q,w,F){this._oContainer=a;this._x=g;this._y=f;this._iWidth=k;this._iHeight=h;this._bMultiline=w;this._iFontSize=c;this._szAlign=e;this._szColor=b;this._szFont=t;this._iPaddingH=l;this._iPaddingV=u;this._bVerticalAlign=q;this._bFitText=p;this._bDebug=F;this._oDebugShape=null;this._fLineHeightFactor=d;this._oText=null;r&&this.__createText(r)};