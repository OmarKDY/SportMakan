/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
(function(){function a(e){e=String(e);return e.charAt(0).toUpperCase()+e.slice(1)}function g(e,v){var u=-1,C=e?e.length:0;if("number"==typeof C&&-1<C&&C<=w)for(;++u<C;)v(e[u],u,e);else h(e,v)}function f(e){e=String(e).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(e)?e:a(e)}function h(e,v){for(var u in e)A.call(e,u)&&v(e[u],u,e)}function k(e){return null==e?a(e):q.call(e).slice(8,-1)}function n(e,v){var u=null!=e?typeof e[v]:"number";return!/^(?:boolean|number|string|undefined)$/.test(u)&&
("object"==u?!!e[v]:!0)}function l(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,v){var u=null;g(e,function(C,x){u=v(u,C,x,e)});return u}function c(e){function v(T){return b(T,function(M,L){var V=L.pattern||l(L);!M&&(M=RegExp("\\b"+V+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+V+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+V+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((M=String(L.label&&!RegExp(V,"i").test(L.label)?L.label:M).split("/"))[1]&&!/[\d.]+/.test(M[0])&&(M[0]+=
" "+M[1]),L=L.label||L,M=f(M[0].replace(RegExp(V,"i"),L).replace(RegExp("; *(?:"+L+"[_-])?","i")," ").replace(RegExp("("+L+")[-_.]?(\\w)","i"),"$1 $2")));return M})}function u(T){return b(T,function(M,L){return M||(RegExp(L+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}var C=t,x=e&&"object"==typeof e&&"String"!=k(e);x&&(C=e,e=null);var G=C.navigator||{},B=G.userAgent||"";e||(e=B);var S=x?!!G.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(q.toString()),
Q=x?"Object":"ScriptBridgingProxyObject",N=x?"Object":"Environment",O=x&&C.java?"JavaPackage":k(C.java),I=x?"Object":"RuntimeObject";N=(O=/\bJava/.test(O)&&C.java)&&k(C.environment)==N;var W=O?"a":"\u03b1",U=O?"b":"\u03b2",R=C.document||{},H=C.operamini||C.opera,D=z.test(D=x&&H?H["[[Class]]"]:k(H))?D:H=null,r,P=e;x=[];var aa=null,Z=e==B;B=Z&&H&&"function"==typeof H.version&&H.version();var J=function(T){return b(T,function(M,L){return M||RegExp("\\b"+(L.pattern||l(L))+"\\b","i").exec(e)&&(L.label||
L)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),E=function(T){return b(T,function(M,L){return M||RegExp("\\b"+(L.pattern||l(L))+"\\b","i").exec(e)&&(L.label||L)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),K=v([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),X=function(T){return b(T,function(M,L,V){return M||(L[K]||L[/^[a-z]+(?: +[a-z]+\b)*/i.exec(K)]||RegExp("\\b"+l(V)+"(?:\\b|\\w*\\d)","i").exec(e))&&V})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),F=function(T){return b(T,function(M,L){var V=L.pattern||l(L);if(!M&&(M=RegExp("\\b"+V+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))){var Y=M,ba=L.label||L,ca={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};V&&ba&&/^Win/i.test(Y)&&!/^Windows Phone /i.test(Y)&&(ca=ca[/[\d.]+$/.exec(Y)])&&(Y="Windows "+ca);Y=String(Y);V&&ba&&(Y=Y.replace(RegExp(V,"i"),ba));M=Y=f(Y.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,
"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return M})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X",
"Macintosh","Mac","Windows 98;","Windows "]);J&&(J=[J]);X&&!K&&(K=v([X]));if(r=/\bGoogle TV\b/.exec(K))K=r[0];/\bSimulator\b/i.test(e)&&(K=(K?K+" ":"")+"Simulator");"Opera Mini"==E&&/\bOPiOS\b/.test(e)&&x.push("running in Turbo/Uncompressed mode");"IE"==E&&/\blike iPhone OS\b/.test(e)?(r=c(e.replace(/like iPhone OS/,"")),X=r.manufacturer,K=r.product):/^iP/.test(K)?(E||(E="Safari"),F="iOS"+((r=/ OS ([\d_]+)/i.exec(e))?" "+r[1].replace(/_/g,"."):"")):"Konqueror"!=E||/buntu/i.test(F)?X&&"Google"!=X&&
(/Chrome/.test(E)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(K))||/\bAndroid\b/.test(F)&&/^Chrome/.test(E)&&/\bVersion\//i.test(e)?(E="Android Browser",F=/\bAndroid\b/.test(F)?F:"Android"):"Silk"==E?(/\bMobi/i.test(e)||(F="Android",x.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&x.unshift("accelerated")):"PaleMoon"==E&&(r=/\bFirefox\/([\d.]+)\b/.exec(e))?x.push("identifying as Firefox "+r[1]):"Firefox"==E&&(r=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(F||(F="Firefox OS"),K||(K=r[1])):!E||
(r=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(E))?(E&&!K&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(r+"/")+8))&&(E=null),(r=K||X||F)&&(K||X||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(F))&&(E=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(F)?F:r)+" Browser")):"Electron"==E&&(r=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&x.push("Chromium "+r):F="Kubuntu";B||(B=u(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",l(E),
"(?:Firefox|Minefield|NetFront)"]));if(r="iCab"==J&&3<parseFloat(B)&&"WebKit"||/\bOpera\b/.test(E)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(J)&&"WebKit"||!J&&/\bMSIE\b/i.test(e)&&("Mac OS"==F?"Tasman":"Trident")||"WebKit"==J&&/\bPlayStation\b(?! Vita\b)/i.test(E)&&"NetFront")J=[r];"IE"==E&&(r=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(E+=" Mobile",F="Windows Phone "+(/\+$/.test(r)?r:r+".x"),x.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?
(E="IE Mobile",F="Windows Phone 8.x",x.unshift("desktop mode"),B||(B=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=E&&"Trident"==J&&(r=/\brv:([\d.]+)/.exec(e))&&(E&&x.push("identifying as "+E+(B?" "+B:"")),E="IE",B=r[1]);if(Z){if(n(C,"global"))if(O&&(r=O.lang.System,P=r.getProperty("os.arch"),F=F||r.getProperty("os.name")+" "+r.getProperty("os.version")),N){try{B=C.require("ringo/engine").version.join("."),E="RingoJS"}catch(T){(r=C.system)&&r.global.system==C.system&&(E="Narwhal",F||(F=r[0].os||null))}E||
(E="Rhino")}else"object"==typeof C.process&&!C.process.browser&&(r=C.process)&&("object"==typeof r.versions&&("string"==typeof r.versions.electron?(x.push("Node "+r.versions.node),E="Electron",B=r.versions.electron):"string"==typeof r.versions.nw&&(x.push("Chromium "+B,"Node "+r.versions.node),E="NW.js",B=r.versions.nw)),E||(E="Node.js",P=r.arch,F=r.platform,B=(B=/[\d.]+/.exec(r.version))?B[0]:null));else k(r=C.runtime)==Q?(E="Adobe AIR",F=r.flash.system.Capabilities.os):k(r=C.phantom)==I?(E="PhantomJS",
B=(r=r.version||null)&&r.major+"."+r.minor+"."+r.patch):"number"==typeof R.documentMode&&(r=/\bTrident\/(\d+)/i.exec(e))?(B=[B,R.documentMode],(r=+r[1]+4)!=B[1]&&(x.push("IE "+B[1]+" mode"),J&&(J[1]=""),B[1]=r),B="IE"==E?String(B[1].toFixed(1)):B[0]):"number"==typeof R.documentMode&&/^(?:Chrome|Firefox)\b/.test(E)&&(x.push("masking as "+E+" "+B),E="IE",B="11.0",J=["Trident"],F="Windows");F=F&&f(F)}B&&(r=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(B)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(Z&&G.appMinorVersion))||
/\bMinefield\b/i.test(e)&&"a")&&(aa=/b/i.test(r)?"beta":"alpha",B=B.replace(RegExp(r+"\\+?$"),"")+("beta"==aa?U:W)+(/\d+\+?/.exec(r)||""));if("Fennec"==E||"Firefox"==E&&/\b(?:Android|Firefox OS)\b/.test(F))E="Firefox Mobile";else if("Maxthon"==E&&B)B=B.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(K))"Xbox 360"==K&&(F=null),"Xbox 360"==K&&/\bIEMobile\b/.test(e)&&x.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(E)&&(!E||K||/Browser|Mobi/.test(E))||"Windows CE"!=F&&!/Mobi/i.test(e))if("IE"==
E&&Z)try{null===C.external&&x.unshift("platform preview")}catch(T){x.unshift("embedded")}else(/\bBlackBerry\b/.test(K)||/\bBB10\b/.test(e))&&(r=(RegExp(K.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||B)?(r=[r,/BB10/.test(e)],F=(r[1]?(K=null,X="BlackBerry"):"Device Software")+" "+r[0],B=null):this!=h&&"Wii"!=K&&(Z&&H||/Opera/.test(E)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==E&&/\bOS X (?:\d+\.){2,}/.test(F)||"IE"==E&&(F&&!/^Win/.test(F)&&5.5<B||/\bWindows XP\b/.test(F)&&8<B||8==B&&!/\bTrident\b/.test(e)))&&
!z.test(r=c.call(h,e.replace(z,"")+";"))&&r.name&&(r="ing as "+r.name+((r=r.version)?" "+r:""),z.test(E)?(/\bIE\b/.test(r)&&"Mac OS"==F&&(F=null),r="identify"+r):(r="mask"+r,E=D?f(D.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(r)&&(F=null),Z||(B=null)),J=["Presto"],x.push(r));else E+=" Mobile";if(r=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1]){r=[parseFloat(r.replace(/\.(\d)$/,".0$1")),r];if("Safari"==E&&"+"==r[1].slice(-1))E="WebKit Nightly",aa="alpha",B=r[1].slice(0,-1);else if(B==
r[1]||B==(r[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1]))B=null;r[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1];537.36==r[0]&&537.36==r[2]&&28<=parseFloat(r[1])&&"WebKit"==J&&(J=["Blink"]);Z&&(S||r[1])?(J&&(J[1]="like Chrome"),r=r[1]||(r=r[0],530>r?1:532>r?2:532.05>r?3:533>r?4:534.03>r?5:534.07>r?6:534.1>r?7:534.13>r?8:534.16>r?9:534.24>r?10:534.3>r?11:535.01>r?12:535.02>r?"13+":535.07>r?15:535.11>r?16:535.19>r?17:536.05>r?18:536.1>r?19:537.01>r?20:537.11>r?"21+":537.13>r?23:537.18>r?24:537.24>r?25:537.36>
r?26:"Blink"!=J?"27":"28")):(J&&(J[1]="like Safari"),r=(r=r[0],400>r?1:500>r?2:526>r?3:533>r?4:534>r?"4+":535>r?5:537>r?6:538>r?7:601>r?8:"8"));J&&(J[1]+=" "+(r+="number"==typeof r?".x":/[.+]/.test(r)?"":"+"));"Safari"==E&&(!B||45<parseInt(B))&&(B=r)}"Opera"==E&&(r=/\bzbov|zvav$/.exec(F))?(E+=" ",x.unshift("desktop mode"),"zvav"==r?(E+="Mini",B=null):E+="Mobile",F=F.replace(RegExp(" *"+r+"$"),"")):"Safari"==E&&/\bChrome\b/.exec(J&&J[1])&&(x.unshift("desktop mode"),E="Chrome Mobile",B=null,/\bOS X\b/.test(F)?
(X="Apple",F="iOS 4.3+"):F=null);B&&0==B.indexOf(r=/[\d.]+$/.exec(F))&&-1<e.indexOf("/"+r+"-")&&(F=String(F.replace(r,"")).replace(/^ +| +$/g,""));J&&!/\b(?:Avant|Nook)\b/.test(E)&&(/Browser|Lunascape|Maxthon/.test(E)||"Safari"!=E&&/^iOS/.test(F)&&/\bSafari\b/.test(J[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(E)&&J[1])&&(r=J[J.length-1])&&x.push(r);x.length&&(x=["("+x.join("; ")+")"]);X&&K&&0>K.indexOf(X)&&x.push("on "+X);K&&x.push((/^on /.test(x[x.length-
1])?"":"on ")+K);if(F){var da=(r=/ ([\d.+]+)$/.exec(F))&&"/"==F.charAt(F.length-r[0].length-1);F={architecture:32,family:r&&!da?F.replace(r[0],""):F,version:r?r[1]:null,toString:function(){var T=this.version;return this.family+(T&&!da?" "+T:"")+(64==this.architecture?" 64-bit":"")}}}(r=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(P))&&!/\bi686\b/i.test(P)?(F&&(F.architecture=64,F.family=F.family.replace(RegExp(" *"+r),"")),E&&(/\bWOW64\b/i.test(e)||Z&&/\w(?:86|32)$/.test(G.cpuClass||G.platform)&&!/\bWin64; x64\b/i.test(e))&&
x.unshift("32-bit")):F&&/^OS X/.test(F.family)&&"Chrome"==E&&39<=parseFloat(B)&&(F.architecture=64);e||(e=null);C={};C.description=e;C.layout=J&&J[0];C.manufacturer=X;C.name=E;C.prerelease=aa;C.product=K;C.ua=e;C.version=E&&B;C.os=F||{architecture:null,family:null,version:null,toString:function(){return"null"}};C.parse=c;C.toString=function(){return this.description||""};C.version&&x.unshift(B);C.name&&x.unshift(E);F&&E&&(F!=String(F).split(" ")[0]||F!=E.split(" ")[0]&&!K)&&x.push(K?"("+F+")":"on "+
F);x.length&&(C.description=x.join(" "));return C}var d={"function":!0,object:!0},t=d[typeof window]&&window||this,p=d[typeof exports]&&exports;d=d[typeof module]&&module&&!module.nodeType&&module;var m=p&&d&&"object"==typeof global&&global;!m||m.global!==m&&m.window!==m&&m.self!==m||(t=m);var w=Math.pow(2,53)-1,z=/\bOpera/;m=Object.prototype;var A=m.hasOwnProperty,q=m.toString,y=c();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t.platform=y,define(function(){return y})):p&&
d?h(y,function(e,v){p[v]=e}):t.platform=y}).call(this);
function buildIOSMeta(){for(var a=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],g=0;g<a.length;g++){var f=document.createElement("meta");f.name=a[g].name;f.content=a[g].content;var h=window.document.head.querySelector('meta[name="'+f.name+'"]');h&&h.parentNode.removeChild(h);window.document.head.appendChild(f)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);console.log(window.devicePixelRatio);console.log(window.innerWidth);console.log(window.innerHeight);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();
break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}
function iosInIframe(){try{return window.self!==window.top}catch(a){return!0}}function isIOSLessThen13(){var a=platform.os,g=a.family.toLowerCase();a=parseFloat(a.version);return"ios"===g&&13>a?!0:!1}$(document).ready(function(){platform&&"iPhone"===platform.product&&"safari"===platform.name.toLowerCase()&&isIOSLessThen13()&&!iosInIframe()&&(buildIOSFullscreenPanel(),buildIOSMeta())});
jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&"safari"===platform.name.toLowerCase()&&isIOSLessThen13()&&!iosInIframe()&&iosResize()});var s_iScaleFactor=1,s_oCanvasLeft,s_oCanvasTop,s_bFocus=!0;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function trace(a){console.log(a)}function isIOS(){for(var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");a.length;)if(navigator.platform===a.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}
function isIpad(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!a&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:a}function isMobile(){return isIpad()?!0:jQuery.browser.mobile}
function getSize(a){var g=a.toLowerCase(),f=window.document,h=f.documentElement;if(void 0===window["inner"+a])a=h["client"+a];else if(window["inner"+a]!=h["client"+a]){var k=f.createElement("body");k.id="vpw-test-b";k.style.cssText="overflow:scroll";var n=f.createElement("div");n.id="vpw-test-d";n.style.cssText="position:absolute;top:-1000px";n.innerHTML="<style>@media("+g+":"+h["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+g+":7px!important}}</style>";k.appendChild(n);h.insertBefore(k,f.head);
a=7==n["offset"+a]?h["client"+a]:window["inner"+a];h.removeChild(k)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}
function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var g=getSize("Width");s_bFocus&&_checkOrientation(g,a);var f=Math.min(a/CANVAS_HEIGHT,g/CANVAS_WIDTH),h=Math.round(CANVAS_WIDTH*f);f=Math.round(CANVAS_HEIGHT*f);if(f<a){var k=a-f;f+=k;h+=CANVAS_WIDTH/CANVAS_HEIGHT*k}else h<g&&(k=g-h,h+=k,f+=CANVAS_HEIGHT/CANVAS_WIDTH*k);k=a/2-f/2;var n=g/2-h/2,l=CANVAS_WIDTH/h;if(n*l<-EDGEBOARD_X||
k*l<-EDGEBOARD_Y)f=Math.min(a/(CANVAS_HEIGHT-2*EDGEBOARD_Y),g/(CANVAS_WIDTH-2*EDGEBOARD_X)),h=Math.round(CANVAS_WIDTH*f),f=Math.round(CANVAS_HEIGHT*f),k=(a-f)/2,n=(g-h)/2,l=CANVAS_WIDTH/h;s_iOffsetX=-1*n*l;s_iOffsetY=-1*k*l;0<=k&&(s_iOffsetY=0);0<=n&&(s_iOffsetX=0);null!==s_oGame&&s_oGame.refreshButtonPos();null!==s_oMenu&&s_oMenu.refreshButtonPos();null!==s_oLevelMenu&&s_oLevelMenu.refreshButtonPos();s_bMobile?($("#canvas").css("width",h+"px"),$("#canvas").css("height",f+"px")):s_oStage&&(s_oStage.canvas.width=
h,s_oStage.canvas.height=f,s_iScaleFactor=Math.min(h/CANVAS_WIDTH,f/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>k||(k=(a-f)/2);$("#canvas").css("top",k+"px");$("#canvas").css("left",n+"px");fullscreenHandler()}}
function _checkOrientation(a,g){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>g?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function createBitmap(a,g,f){var h=new createjs.Bitmap(a),k=new createjs.Shape;g&&f?k.graphics.beginFill("#fff").drawRect(0,0,g,f):k.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);h.hitArea=k;return h}function createSprite(a,g,f,h,k,n){a=null!==g?new createjs.Sprite(a,g):new createjs.Sprite(a);g=new createjs.Shape;g.graphics.beginFill("#000000").drawRect(-f,-h,k,n);a.hitArea=g;return a}
function randomFloatBetween(a,g,f){"undefined"===typeof f&&(f=2);return parseFloat(Math.min(a+Math.random()*(g-a),g).toFixed(f))}function shuffle(a){for(var g=a.length,f,h;0!==g;)h=Math.floor(Math.random()*g),--g,f=a[g],a[g]=a[h],a[h]=f;return a}function formatTime(a){a/=1E3;var g=Math.floor(a/60);a=parseFloat(a-60*g).toFixed(1);var f="";f=10>g?f+("0"+g+":"):f+(g+":");return 10>a?f+("0"+a):f+a}
function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var g=a.length,f,h;0<g;)h=Math.floor(Math.random()*g),g--,f=a[g],a[g]=a[h],a[h]=f;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var g=document.createEvent("MouseEvents");g.initEvent("click",!0,!0);a.dispatchEvent(g)}}};
(function(){function a(f){var h={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};f=f||window.event;f.type in h?document.body.className=h[f.type]:(document.body.className=this[g]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var g="hidden";g in document?document.addEventListener("visibilitychange",a):(g="mozHidden")in document?document.addEventListener("mozvisibilitychange",
a):(g="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(g="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var g=window.location.search.substring(1).split("&"),f=0;f<g.length;f++){var h=g[f].split("=");if(h[0]==a)return h[1]}}function playSound(a,g,f){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(g),s_aSounds[a].loop(f),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}function setVolume(a,g){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(g)}
function setMute(a,g){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(g)}function isSoundPlaying(a){return s_aSounds[a].playing()}function saveItem(a,g){s_bStorageAvailable&&localStorage.setItem(a,g)}function getItem(a){return s_bStorageAvailable?localStorage.getItem(a):null}
function fullscreenHandler(){ENABLE_FULLSCREEN&&!1!==screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut(),null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut())}if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut();null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a={},g,f,h,k,n,l;this.init=function(b,c,d){g={};h=f=0;k=b;n=c;l=d};this.addSprite=function(b,c){if(a.hasOwnProperty(b))return!1;var d=new Image;a[b]=g[b]={szPath:c,oSprite:d,bLoaded:!1};f++;return!0};this.getSprite=function(b){return a.hasOwnProperty(b)?a[b].oSprite:null};this._onSpritesLoaded=function(){f=0;n.call(l)};this._onSpriteLoaded=function(){k.call(l);++h===f&&this._onSpritesLoaded()};this.loadSprites=function(){for(var b in g)g[b].oSprite.oSpriteLibrary=this,
g[b].oSprite.szKey=b,g[b].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},g[b].oSprite.onerror=function(c){var d=c.currentTarget;setTimeout(function(){g[d.szKey].oSprite.src=g[d.szKey].szPath},500)},g[b].oSprite.src=g[b].szPath};this.setLoaded=function(b){a[b].bLoaded=!0};this.isLoaded=function(b){return a[b].bLoaded};this.getNumSprites=function(){return f}}
var CANVAS_WIDTH=1500,CANVAS_HEIGHT=768,EDGEBOARD_X=180,EDGEBOARD_Y=20,LOCALSTORAGE_STRING="rugbyrush_",FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,FONT_GAME="impact",STATE_LOADING=0,STATE_MENU=1,STATE_MENU_LEVEL=2,STATE_SELECT_TEAM=3,STATE_GAME=4,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_BUT_YES_DOWN=6,ON_PLAYER_TOUCHDOWN=7,ON_PLAYER_TACKLED=8,ON_OPPONENT_HIDE=9,ON_OPPONENT_TACKLE=10,ON_POWERUP_END_MOVE=11,ON_BACK_MENU=12,ON_RESTART=13,ON_NEXT_LEVEL=
14,ON_END_LOADING=15,ON_END_COUNTDOWN=16,PLAYER_ANIM_RUN=0,PLAYER_ANIM_FALL=1,PLAYER_ANIM_TOUCHDOWN=2,PLAYER_ANIM_JUMP=3,STARTING_STANDS_SCALE_BONUS=.74,NUM_LEVELS,NUM_TEAMS=12,OPPONENT_FINAL_Y=1070,POWERUP_FINAL_Y=600,TIME_OPPONENT_RUN=3E3,HERO_ACCELERATION,HERO_SUPER_ACCELERATION,HERO_FRICTION,MAX_HERO_SPEED,MAX_DIST_AVOID_OPPONENT_IN_JUMP=150,MIN_POWERUP_X=700,MAX_POWERUP_X=800,SCORE_POWERUP,TIME_EFFECT_POWERUP=1E4,NUM_COLS_PAGE_LEVEL=6,NUM_ROWS_PAGE_LEVEL=2,SOUNDTRACK_VOLUME_IN_GAME=.4,TEAM_EASY=
[0,2,5,11],TEAM_MEDIUM=[1,7,9],TEAM_HARD=[3,4,6,8,10],DEFAULT_TEAM_SEQ=[0,2,5,10,1,6,8,3,4,7,9],ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION;
function CPreloader(){var a,g,f,h,k,n,l,b,c,d;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();d=new createjs.Container;s_oStage.addChild(d)};this.unload=function(){d.removeAllChildren()};this._onImagesLoaded=function(){};this._onAllImagesLoaded=
function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var t=new createjs.Shape;t.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.addChild(t);t=s_oSpriteLibrary.getSprite("200x200");l=createBitmap(t);l.regX=.5*t.width;l.regY=.5*t.height;l.x=CANVAS_WIDTH/2;l.y=CANVAS_HEIGHT/2-80;d.addChild(l);b=new createjs.Shape;b.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(l.x-100,l.y-100,200,200,10);d.addChild(b);l.mask=b;t=s_oSpriteLibrary.getSprite("progress_bar");
h=createBitmap(t);h.x=CANVAS_WIDTH/2-t.width/2;h.y=CANVAS_HEIGHT/2+70;d.addChild(h);a=t.width;g=t.height;k=new createjs.Shape;k.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(h.x,h.y,1,g);d.addChild(k);h.mask=k;f=new createjs.Text("","30px "+FONT_GAME,"#fff");f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2+120;f.textBaseline="alphabetic";f.textAlign="center";d.addChild(f);t=s_oSpriteLibrary.getSprite("but_start");c=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2+100,t,TEXT_PRELOADER_CONTINUE,"Arial","#000",
36,"center",0,d);c.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);c.setVisible(!1);n=new createjs.Shape;n.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.addChild(n);createjs.Tween.get(n).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(n);d.removeChild(n)})};this._onButStartRelease=function(){s_oMain._allResourcesLoaded()};this.refreshLoader=function(t){f.text=t+"%";100===t&&(s_oMain._allResourcesLoaded(),f.visible=!1,h.visible=!1);k.graphics.clear();
t=Math.floor(t*a/100);k.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(h.x,h.y,t,g)};this._init()}
function CMain(a){var g,f,h=0,k=0,n=STATE_LOADING,l,b;this.initContainer=function(){var c=document.getElementById("canvas");s_oStage=new createjs.Stage(c);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage);s_bMobile=isMobile();!1===s_bMobile&&s_oStage.enableMouseOver(20);s_iPrevTime=(new Date).getTime();createjs.Ticker.framerate=FPS;createjs.Ticker.on("tick",this._update);navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;s_oLevelSettings=
new CLevelSettings;l=new CPreloader;s_aTeamLoaded=[];for(c=0;c<NUM_TEAMS;c++)s_aTeamLoaded[c]=!1};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();this._loadImages();g=f=!0};this.soundLoaded=function(){h++;l.refreshLoader(Math.floor(h/k*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",filename:"level_win",
loop:!1,volume:1,ingamename:"level_win"});s_aSoundsInfo.push({path:"./sounds/",filename:"powerup",loop:!1,volume:1,ingamename:"powerup"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_touchdown",loop:!1,volume:1,ingamename:"crowd_touchdown"});s_aSoundsInfo.push({path:"./sounds/",filename:"enemy",loop:!1,volume:1,ingamename:"enemy"});s_aSoundsInfo.push({path:"./sounds/",filename:"enemy_tackle",loop:!1,volume:1,ingamename:"enemy_tackle"});s_aSoundsInfo.push({path:"./sounds/",filename:"game_over",
loop:!1,volume:1,ingamename:"game_over"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_idle",loop:!0,volume:1,ingamename:"crowd_idle"});s_aSoundsInfo.push({path:"./sounds/",filename:"countdown_1",loop:!0,volume:1,ingamename:"countdown_1"});s_aSoundsInfo.push({path:"./sounds/",filename:"countdown_2",loop:!0,volume:1,ingamename:"countdown_2"});s_aSoundsInfo.push({path:"./sounds/",filename:"countdown_3",loop:!0,volume:1,ingamename:"countdown_3"});s_aSoundsInfo.push({path:"./sounds/",filename:"go",
loop:!0,volume:1,ingamename:"go"});s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});k+=s_aSoundsInfo.length;s_aSounds=[];for(var c=0;c<s_aSoundsInfo.length;c++)this.tryToLoadSound(s_aSoundsInfo[c],!1)};this.tryToLoadSound=function(c,d){setTimeout(function(){s_aSounds[c.ingamename]=new Howl({src:[c.path+c.filename+".mp3"],autoplay:!1,preload:!0,loop:c.loop,volume:c.volume,onload:s_oMain.soundLoaded,onloaderror:function(t,p){for(var m=0;m<s_aSoundsInfo.length;m++)if(t===
s_aSounds[s_aSoundsInfo[m].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[m],!0);break}},onplayerror:function(t){for(var p=0;p<s_aSoundsInfo.length;p++)if(t===s_aSounds[s_aSoundsInfo[p].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[p].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[p].ingamename].play();"soundtrack"===s_aSoundsInfo[p].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},d?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,
this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("but_next","./sprites/but_next.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("msg_box_big","./sprites/msg_box_big.png");s_oSpriteLibrary.addSprite("msg_box_wide",
"./sprites/msg_box_wide.png");s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.jpg");s_oSpriteLibrary.addSprite("bg_menu_level","./sprites/bg_menu_level.jpg");s_oSpriteLibrary.addSprite("bg_menu_level","./sprites/bg_menu_level.jpg");s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");s_oSpriteLibrary.addSprite("but_fullscreen",
"./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("but_settings","./sprites/but_settings.png");s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("key_0","./sprites/key_0.png");s_oSpriteLibrary.addSprite("key_1","./sprites/key_1.png");s_oSpriteLibrary.addSprite("key_2","./sprites/key_2.png");s_oSpriteLibrary.addSprite("but_left","./sprites/but_left.png");s_oSpriteLibrary.addSprite("but_right",
"./sprites/but_right.png");s_oSpriteLibrary.addSprite("but_jump","./sprites/but_jump.png");s_oSpriteLibrary.addSprite("post","./sprites/post.png");s_oSpriteLibrary.addSprite("power_up_0","./sprites/power_up_0.png");s_oSpriteLibrary.addSprite("power_up_1","./sprites/power_up_1.png");s_oSpriteLibrary.addSprite("but_level","./sprites/but_level.png");s_oSpriteLibrary.addSprite("powerup_gui_off","./sprites/powerup_gui_off.png");s_oSpriteLibrary.addSprite("powerup_gui_on","./sprites/powerup_gui_on.png");
s_oSpriteLibrary.addSprite("but_delete_save","./sprites/but_delete_save.png");s_oSpriteLibrary.addSprite("countdown_0","./sprites/countdown_0.png");s_oSpriteLibrary.addSprite("countdown_1","./sprites/countdown_1.png");s_oSpriteLibrary.addSprite("countdown_2","./sprites/countdown_2.png");s_oSpriteLibrary.addSprite("countdown_3","./sprites/countdown_3.png");s_oSpriteLibrary.addSprite("progress_loading","./sprites/progress_loading.png");s_oSpriteLibrary.addSprite("flags","./sprites/flags.png");s_oSpriteLibrary.addSprite("team_selection",
"./sprites/team_selection.png");s_oSpriteLibrary.addSprite("but_go","./sprites/but_go.png");for(var c=0;c<NUM_TEAMS;c++)s_oSpriteLibrary.addSprite("team_"+c,"./sprites/player_team_panels/team_"+c+".png"),s_oSpriteLibrary.addSprite("but_flag_"+c,"./sprites/but_flag_"+c+".png");for(c=0;18>c;c++)s_oSpriteLibrary.addSprite("field_loop_"+c,"./sprites/field_loop/field_loop_"+c+".png");for(c=0;39>c;c++)s_oSpriteLibrary.addSprite("end_zone_"+c,"./sprites/end_zone/end_zone_"+c+".png");k+=s_oSpriteLibrary.getNumSprites();
s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){h++;l.refreshLoader(Math.floor(h/k*100))};this._onAllImagesLoaded=function(){};this._allResourcesLoaded=function(){l.unload();try{saveItem(LOCALSTORAGE_STRING+"ls_available","ok")}catch(c){s_bStorageAvailable=!1}s_oSoundTrack=playSound("soundtrack",1,!0);s_oMain.gotoMenu()};this.createOpponentSeq=function(){if(s_bStorageAvailable){s_aTeamSeq=[];for(var c=[],d=0;d<TEAM_EASY.length;d++)c[d]=TEAM_EASY[d];var t=[];for(d=0;d<TEAM_MEDIUM.length;d++)t[d]=
TEAM_MEDIUM[d];var p=[];for(d=0;d<TEAM_HARD.length;d++)p[d]=TEAM_HARD[d];-1!==c.indexOf(s_iTeamSelected)?c.splice(c.indexOf(s_iTeamSelected),1):-1!==t.indexOf(s_iTeamSelected)?t.splice(t.indexOf(s_iTeamSelected),1):-1!==p.indexOf(s_iTeamSelected)&&p.splice(p.indexOf(s_iTeamSelected),1);c=shuffle(c);s_aTeamSeq=s_aTeamSeq.concat(c);t=shuffle(t);s_aTeamSeq=s_aTeamSeq.concat(t);p=shuffle(p);s_aTeamSeq=s_aTeamSeq.concat(p);setTeam();setOpponentSeq()}else DEFAULT_TEAM_SEQ.splice(DEFAULT_TEAM_SEQ.indexOf(s_iTeamSelected),
1),s_aTeamSeq=DEFAULT_TEAM_SEQ};this.gotoMenu=function(){new CMenu;n=STATE_MENU};this.gotoLevelMenu=function(){new CLevelMenu;n=STATE_MENU_LEVEL};this.gotoChooseMenu=function(){new CChooseMenu;n=STATE_SELECT_TEAM};this.gotoGame=function(){b=new CGame;n=STATE_GAME};this.levelSelected=function(c){s_iLevelSelected=c;trace("level selected "+s_iLevelSelected);c>=s_iLastLevel&&(s_iLastLevel=c)};this.stopUpdateNoBlockAndTick=function(){f=!1};this.startUpdateNoBlockAndTick=function(){f=!0};this.stopUpdateNoBlock=
function(){g=!1;createjs.Ticker.paused=!0};this.startUpdateNoBlock=function(){s_iPrevTime=(new Date).getTime();g=!0;createjs.Ticker.paused=!1};this.stopUpdate=function(){g=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();g=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)&&s_bAudioActive&&Howler.mute(!1)};
this._update=function(c){if(!1!==g){var d=(new Date).getTime();s_iTimeElaps=d-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=d;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);n===STATE_GAME&&f&&b.update();void 0!==s_oStage&&s_oStage.update(c)}};s_oMain=this;HERO_ACCELERATION=a.hero_acceleration;HERO_SUPER_ACCELERATION=a.hero_acceleration_powerup;HERO_FRICTION=a.hero_friction;MAX_HERO_SPEED=a.max_hero_speed;SCORE_POWERUP=a.score_powerup;s_bAudioActive=a.audio_enable_on_startup;
ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;this.initContainer()}var s_bMobile,s_bAudioActive=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oSoundTrack=null,s_oDrawLayer,s_oStage,s_oMain=null,s_oSpriteLibrary,s_oLevelSettings,s_iLastLevel=1,s_iLevelSelected=1,s_bFullscreen=!1,s_bStorageAvailable=!0,s_aSoundsInfo,s_aTeamLoaded,s_aTeamSeq,s_iTeamSelected=0;
function CTextButton(a,g,f,h,k,n,l,b,c,d){var t,p,m,w,z,A,q,y,e,v;this._init=function(u,C,x,G,B,S,Q,N,O){t=!1;p=1;m=[];w=[];v=createBitmap(x);y=new createjs.Container;y.x=u;y.y=C;y.regX=x.width/2;y.regY=x.height/2;s_bMobile||(y.cursor="pointer");y.addChild(v,e);d.addChild(y);e=new CTLText(y,10,5,x.width-20,x.height-10,Q,N,S,B,1,O,0,G,!0,!0,!1,!1);this._initListener()};this.unload=function(){y.off("mousedown",z);y.off("pressup",A);d.removeChild(y)};this.setVisible=function(u){y.visible=u};this.setAlign=
function(u){e.textAlign=u};this.setTextX=function(u){e.x=u};this.setScale=function(u){p=y.scaleX=y.scaleY=u};this.enable=function(){t=!1};this.disable=function(){t=!0};this._initListener=function(){z=y.on("mousedown",this.buttonDown);A=y.on("pressup",this.buttonRelease)};this.addEventListener=function(u,C,x){m[u]=C;w[u]=x};this.addEventListenerWithParams=function(u,C,x,G){m[u]=C;w[u]=x;q=G};this.buttonRelease=function(){t||(playSound("click",1,!1),y.scaleX=p,y.scaleY=p,m[ON_MOUSE_UP]&&m[ON_MOUSE_UP].call(w[ON_MOUSE_UP],
q))};this.buttonDown=function(){t||(y.scaleX=.9*p,y.scaleY=.9*p,m[ON_MOUSE_DOWN]&&m[ON_MOUSE_DOWN].call(w[ON_MOUSE_DOWN]))};this.setPosition=function(u,C){y.x=u;y.y=C};this.tweenPosition=function(u,C,x,G,B,S,Q){createjs.Tween.get(y).wait(G).to({x:u,y:C},x,B).call(function(){void 0!==S&&S.call(Q)})};this.changeText=function(u){e.refreshText(u)};this.setX=function(u){y.x=u};this.setY=function(u){y.y=u};this.getButtonImage=function(){return y};this.getX=function(){return y.x};this.getY=function(){return y.y};
this.getSprite=function(){return y};this.getScale=function(){return y.scaleX};this._init(a,g,f,h,k,n,l,b,c)}
function CGfxButton(a,g,f,h){var k,n,l,b=[],c,d,t;this._init=function(p,m,w){k=!1;n=[];l=[];t=createBitmap(w);t.x=p;t.y=m;t.regX=w.width/2;t.regY=w.height/2;t.cursor="pointer";h.addChild(t);this._initListener()};this.unload=function(){t.off("mousedown",c);t.off("pressup",d);h.removeChild(t)};this.setVisible=function(p){t.visible=p};this._initListener=function(){c=t.on("mousedown",this.buttonDown);d=t.on("pressup",this.buttonRelease)};this.addEventListener=function(p,m,w){n[p]=m;l[p]=w};this.addEventListenerWithParams=
function(p,m,w,z){n[p]=m;l[p]=w;b=z};this.enable=function(){k=!1};this.disable=function(){k=!0};this.buttonRelease=function(){k||(playSound("click",1,!1),t.scaleX=1,t.scaleY=1,n[ON_MOUSE_UP]&&n[ON_MOUSE_UP].call(l[ON_MOUSE_UP],b))};this.buttonDown=function(){k||(t.scaleX=.9,t.scaleY=.9,n[ON_MOUSE_DOWN]&&n[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN],b))};this.setPosition=function(p,m){t.x=p;t.y=m};this.setX=function(p){t.x=p};this.setY=function(p){t.y=p};this.getButtonImage=function(){return t};this.getX=
function(){return t.x};this.getY=function(){return t.y};this._init(a,g,f);return this}
function CToggle(a,g,f,h,k){var n,l,b,c;this._init=function(d,t,p,m){l=[];b=[];var w=new createjs.SpriteSheet({images:[p],frames:{width:p.width/2,height:p.height,regX:p.width/2/2,regY:p.height/2},animations:{state_true:[0],state_false:[1]}});n=m;c=createSprite(w,"state_"+n,p.width/2/2,p.height/2,p.width/2,p.height);c.x=d;c.y=t;c.stop();c.cursor="pointer";k.addChild(c);this._initListener()};this.unload=function(){c.off("mousedown",this.buttonDown);c.off("pressup",this.buttonRelease);k.removeChild(c)};
this._initListener=function(){c.on("mousedown",this.buttonDown);c.on("pressup",this.buttonRelease)};this.addEventListener=function(d,t,p){l[d]=t;b[d]=p};this.setActive=function(d){n=d;c.gotoAndStop("state_"+n)};this.buttonRelease=function(){c.scaleX=1;c.scaleY=1;playSound("click",1,!1);n=!n;c.gotoAndStop("state_"+n);l[ON_MOUSE_UP]&&l[ON_MOUSE_UP].call(b[ON_MOUSE_UP],n)};this.buttonDown=function(){c.scaleX=.9;c.scaleY=.9;l[ON_MOUSE_DOWN]&&l[ON_MOUSE_DOWN].call(b[ON_MOUSE_DOWN])};this.setPosition=function(d,
t){c.x=d;c.y=t};this.getButtonImage=function(){return c};this._init(a,g,f,h)}
function CMenu(){var a,g,f,h,k,n,l,b,c,d,t,p,m=null,w,z,A,q=null,y=null,e;this._init=function(){c=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(c);d=new CGfxButton(CANVAS_WIDTH/2-200,CANVAS_HEIGHT-160,s_oSpriteLibrary.getSprite("but_play"),s_oStage);d.addEventListener(ON_MOUSE_UP,this._onButPlaySingle,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){var v=s_oSpriteLibrary.getSprite("audio_icon");l=CANVAS_WIDTH-v.height/2-10;b=v.height/2+10;t=new CToggle(l,b,v,s_bAudioActive,
s_oStage);t.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this)}v=s_oSpriteLibrary.getSprite("but_credits");k=v.width/2+10;n=v.height/2+10;p=new CGfxButton(k,n,v,s_oStage);p.addEventListener(ON_MOUSE_UP,this._onButCreditsRelease,this);v=window.document;var u=v.documentElement;q=u.requestFullscreen||u.mozRequestFullScreen||u.webkitRequestFullScreen||u.msRequestFullscreen;y=v.exitFullscreen||v.mozCancelFullScreen||v.webkitExitFullscreen||v.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(q=!1);q&&screenfull.isEnabled&&
(v=s_oSpriteLibrary.getSprite("but_fullscreen"),f=k+v.width/2+10,h=n,A=new CToggle(f,h,v,s_bFullscreen,s_oStage),A.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));s_bStorageAvailable&&null!==getStoredTeamSelected()&&(v=s_oSpriteLibrary.getSprite("but_delete_save"),a=v.width/2+10,g=CANVAS_HEIGHT-v.height/2-10,m=new CGfxButton(a,g,v,s_oStage),m.addEventListener(ON_MOUSE_UP,this._onDelete,this),s_iTeamSelected=getStoredTeamSelected(),s_aTeamSeq=getOpponentSeq(),s_iLastLevel=getSavedLevel(),
trace("s_iLastLevel "+s_iLastLevel));s_bStorageAvailable||new CAlertSavingBox(TEXT_ERR_LS,s_oStage);z=new CAreYouSurePanel;z.addEventListener(ON_BUT_YES_DOWN,this._onConfirmDelete,this);e=new CLoaderResourcesPanel(s_oStage);e.addEventListener(ON_END_LOADING,this._onEndLoading,this);w=new createjs.Shape;w.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(w);createjs.Tween.get(w).to({alpha:0},400).call(function(){w.visible=!1});setVolume("soundtrack",1);this.refreshButtonPos()};
this.unload=function(){e.unload();d.unload();p.unload();null!==m&&m.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)t.unload(),t=null;q&&screenfull.isEnabled&&A.unload();s_oStage.removeAllChildren();s_oMenu=null};this.refreshButtonPos=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||t.setPosition(l-s_iOffsetX,s_iOffsetY+b);q&&screenfull.isEnabled&&A.setPosition(f+s_iOffsetX,h+s_iOffsetY);p.setPosition(k+s_iOffsetX,n+s_iOffsetY);null!==m&&m.setPosition(a+s_iOffsetX,g-s_iOffsetY)};this._onButPlaySingle=
function(){if(null===m)s_oMenu.unload(),s_oMain.gotoChooseMenu();else if(s_aTeamLoaded[s_iTeamSelected])s_oMenu.unload(),s_oMain.gotoLevelMenu();else{for(var v=[],u=0;2>u;u++)v.push({name:"player"+s_iTeamSelected+"_run_"+u,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_run_"+u+".png"});for(u=0;6>u;u++)v.push({name:"player"+s_iTeamSelected+"_touchdown_"+u,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_touchdown_"+u+".png"});for(u=0;7>u;u++)v.push({name:"player"+
s_iTeamSelected+"_jump_"+u,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_jump_"+u+".png"});v.push({name:"player"+s_iTeamSelected+"_falling",path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_falling.png"});e.start(v)}$(s_oMain).trigger("start_session")};this._onEndLoading=function(){s_aTeamLoaded[s_iTeamSelected]=!0;s_oMenu.unload();s_oMain.gotoLevelMenu()};this._onButCreditsRelease=function(){new CCreditsPanel};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);
s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){q&&screenfull.isEnabled&&A.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?y.call(window.document):q.call(window.document.documentElement);sizeHandler()};this._onDelete=function(){z.show(TEXT_CONFIRM_DELETE)};this._onConfirmDelete=function(){clearLocalStorage();m.unload();m=null};s_oMenu=this;this._init()}var s_oMenu=null;
function CGame(){var a=!1,g,f,h,k,n,l,b,c,d,t,p,m,w,z,A,q,y,e,v,u,C,x,G,B,S,Q,N,O,I,W,U,R,H;this._init=function(){b=s_iLevelSelected;n=getScoreTillLevel(b);trace("tot score "+n+" at level "+b);C=[{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0},{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0}];N=new createjs.Container;s_oStage.addChild(N);var D=s_oSpriteLibrary.getSprite("bg_game");x=createBitmap(D);x.regX=D.width/2;x.regY=D.height;x.x=CANVAS_WIDTH/2;
x.y=521;N.addChild(x);B=new CField(0,516,N);B.show();S=new CFieldEndZone(0,516,N);D=s_oSpriteLibrary.getSprite("post");G=createBitmap(D);G.regX=D.width/2;G.regY=D.height;G.x=CANVAS_WIDTH-450;G.y=518;N.addChild(G);O=new createjs.Container;N.addChild(O);I=new CPlayer(CANVAS_WIDTH/2,CANVAS_HEIGHT-s_iOffsetY,N);I.addEventListener(ON_PLAYER_TOUCHDOWN,this._onWinLevel,this);I.addEventListener(ON_PLAYER_TACKLED,this._onEndLevel,this);Q=new CInterface(n);W=new CHelpPanel;H=new CCountdownController(CANVAS_WIDTH/
2,CANVAS_HEIGHT/2,s_oStage);H.addEventListener(ON_END_COUNTDOWN,this.endCountDown,this);this.reset();1===b?W.show():s_oGame.startCountdown();U=new CEndPanel;U.addEventListener(ON_RESTART,this.restart,this);U.addEventListener(ON_BACK_MENU,this.onExit,this);R=new CNextLevelPanel;R.addEventListener(ON_RESTART,this.restart,this);R.addEventListener(ON_BACK_MENU,this.onExit,this);R.addEventListener(ON_NEXT_LEVEL,this._onNextLevel,this);playSound("crowd_idle",1,!0)};this.unload=function(){a=!1;stopSound("crowd_idle");
Q.unload();s_oStage.removeAllChildren()};this.reset=function(){g=k=f=h=!1;c=l=0;y=[];e=[];d=s_oLevelSettings.getEnemiesSpawn(b);t=s_oLevelSettings.getStartingEnemySpawn(b);p=s_oLevelSettings.getEnemySpawnNumber(b);u=s_oLevelSettings.getPowerUps(b);n=getScoreTillLevel(b);m=parseFloat(((1-STARTING_STANDS_SCALE_BONUS)/d).toFixed(3));q=s_aTeamSeq[b-1];this._createSpawnArray();S.reset();I.reset();Q.reset(n,b);H.reset();x.scaleX=x.scaleY=STARTING_STANDS_SCALE_BONUS;G.scaleX=G.scaleY=.2;G.x=CANVAS_WIDTH-
450;G.y=518;setVolume("crowd_idle",1);setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);$(s_oMain).trigger("start_level",b)};this.restart=function(){$(s_oMain).trigger("restart_level",b);for(var D=0;D<e.length;D++)e[D].unload();this.reset();this.startCountdown()};this.refreshButtonPos=function(){Q.refreshButtonPos();I.setY(CANVAS_HEIGHT-s_iOffsetY)};this.onKeyDown=function(D){if(I.isJumping()||k||I.getCurAnim()===PLAYER_ANIM_TOUCHDOWN)return D.preventDefault(),!1;D||(D=window.event);switch(D.keyCode){case 37:f=
!0;I.moveLeft(!0);break;case 39:f=!0;I.moveRight(!0);break;case 32:f=!0,U.isVisible()?U._onRestart():W.isVisible()?W._onStart():R.isVisible()?R._onNext():I.jump()}D.preventDefault();return!1};this.onKeyUp=function(D){if(k)return D.preventDefault(),!1;D||(D=window.event);f=!1;switch(D.keyCode){case 37:I.moveLeft(!1);break;case 39:I.moveRight(!1)}D.preventDefault();return!1};this.moveLeft=function(D){D&&(f||I.isJumping())||k||(f=D,I.moveLeft(D))};this.moveRight=function(D){D&&(f||I.isJumping())||k||
(f=D,I.moveRight(D))};this.moveJump=function(D){D&&(f||I.isJumping())||k||I.getCurAnim()===PLAYER_ANIM_TOUCHDOWN||(f=D)&&I.jump()};this._createSpawnArray=function(){v=[];var D=s_iOffsetX+50,r=Math.floor(Math.random()*(CANVAS_WIDTH-s_iOffsetX-s_iOffsetX+1))+s_iOffsetX+50;for(r/=s_oLevelSettings.getEnemiesSpawn(b);D<CANVAS_WIDTH-s_iOffsetX;)v.push(D),D+=r;v=shuffle(v)};this.startCountdown=function(){H.start();I.show();h=a=!0};this.endCountDown=function(){Q._initKeyListeners();c=0;h=!1;this._spawnEnemy()};
this._spawnEnemy=function(){for(var D=Math.floor(Math.random()*p)+1,r=0;r<D&&0!==d;r++){d--;var P=!1;0===d&&(h=P=!0);P=new COpponent(P,q,v.pop(),526,O);P.addEventListener(ON_OPPONENT_HIDE,this.checkTouchDown,this);P.addEventListener(ON_OPPONENT_TACKLE,this.checkCollision,this);y.push(P);P=x.scaleX+m;(new createjs.Tween.get(x)).to({scaleX:P,scaleY:P},t);P=G.scaleX+m;(new createjs.Tween.get(G)).to({scaleX:P,scaleY:P,x:G.x+750*m},t);-1!==u.indexOf(y.length)&&this._spawnPowerUp()}};this._spawnPowerUp=
function(){var D=new CPowerUp(Math.floor(Math.random()*(MAX_POWERUP_X-MIN_POWERUP_X+1))+MIN_POWERUP_X,510,Math.floor(2*Math.random()),O);D.addEventListener(ON_POWERUP_END_MOVE,this._checkCollisionWithPowerUp,this);e.push(D)};this.checkTouchDown=function(D){D&&!k&&this._showTouchdown()};this.checkCollision=function(D){if(!k){var r=I.getRect(),P=Math.abs(D.x-r.x);if(r.intersects(D))if(I.isJumping()&&P>MAX_DIST_AVOID_OPPONENT_IN_JUMP)this.refreshScore(Math.floor(P/200));else{k=!0;w=0;var aa=this;z=setInterval(function(){aa.tremble()},
20);playSound("enemy_tackle",1,!1);I.changeAnim(PLAYER_ANIM_FALL);for(D=0;D<e.length;D++)e[D].stopTween()}else this.refreshScore(Math.floor(P/200))}};this._checkCollisionWithPowerUp=function(D,r){if(!k&&I.getRect().intersects(D))switch(playSound("powerup",1,!1),r){case 0:this.refreshScore(SCORE_POWERUP);new CScoreText(SCORE_POWERUP,CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oStage);break;case 1:I.setAcceleration(HERO_SUPER_ACCELERATION,2*MAX_HERO_SPEED),A=0,g=!0,Q.showPowerUpGui()}};this.tremble=function(){var D=
C[w];N.x+=D.x;N.y+=D.y;w++;w===C.length&&(w=0,clearInterval(z))};this.refreshScore=function(D){l+=D;n+=D;Q.refreshScore(n)};this._showTouchdown=function(){playSound("crowd_touchdown",1,!1);S.show();var D=x.scaleX+m;(new createjs.Tween.get(x)).to({scaleX:D,scaleY:D},1200);D=G.scaleX+m;(new createjs.Tween.get(G)).to({scaleX:D,scaleY:D,x:G.x+500,y:G.y+60},1E3);setTimeout(function(){I.changeAnim(PLAYER_ANIM_TOUCHDOWN)},500)};this._manageOpponentDepth=function(){O.sortChildren(function(D,r,P){return D.y>
r.y?1:D.y<r.y?-1:0})};this.endZonePlayed=function(){};this._onEndLevel=function(){$(s_oMain).trigger("end_level",b);setVolume("crowd_idle",0);setTimeout(function(){U.show(n,TEXT_GAME_OVER)},2E3)};this._onWinLevel=function(){setVolume("crowd_idle",0);$(s_oMain).trigger("end_level",b);$(s_oMain).trigger("save_score",n);b===NUM_LEVELS?setTimeout(function(){U.show(n,TEXT_CONGRATS)},2E3):(setLocalStorageLevel(b+1),setLocalStorageScore(l,b),setTimeout(function(){R.show(l,n,b)},2E3))};this._onNextLevel=
function(){s_oGame.unload();s_oMain.gotoLevelMenu()};this.onExit=function(){this.unload();s_oMain.gotoMenu();$(s_oMain).trigger("show_interlevel_ad");$(s_oMain).trigger("end_session");$(s_oMain).trigger("share_event",n)};this.getPlayerX=function(){return I.getX()};this.update=function(){if(!1!==a){I.update();this._manageOpponentDepth();for(var D=0;D<y.length;D++)y[D].update();k||(B.update(),S.update(),c+=s_iTimeElaps,!h&&c>t&&(c=0,this._spawnEnemy()),g&&(A+=s_iTimeElaps,A>TIME_EFFECT_POWERUP?(g=!1,
Q.hidePowerUpGui(),I.setAcceleration(HERO_ACCELERATION,MAX_HERO_SPEED)):Q.refreshPowerUpTime(A)))}};s_oGame=this;this._init()}var s_oGame=null;
function CInterface(a){var g,f,h,k,n,l,b,c,d,t,p,m,w,z,A,q,y,e,v,u,C,x,G,B,S,Q,N,O=null,I=null,W,U;this._init=function(R){if(s_bMobile){var H=s_oSpriteLibrary.getSprite("but_left");b=H.width/2+150;c=CANVAS_HEIGHT-H.height/2-20;S=new CGfxButton(b,c,H,s_oStage);S.addEventListener(ON_MOUSE_DOWN,this._onLeftDown,this);S.addEventListener(ON_MOUSE_UP,this._onLeftUp,this);H=s_oSpriteLibrary.getSprite("but_right");n=CANVAS_WIDTH-H.width/2-150;l=CANVAS_HEIGHT-H.height/2-20;Q=new CGfxButton(n,l,H,s_oStage);
Q.addEventListener(ON_MOUSE_DOWN,this._onRightDown,this);Q.addEventListener(ON_MOUSE_UP,this._onRightUp,this);H=s_oSpriteLibrary.getSprite("but_jump");h=CANVAS_WIDTH/2;k=CANVAS_HEIGHT-H.height/2-30;N=new CTextButton(h,k,H,TEXT_JUMP,FONT_GAME,"#fff",100,"center",0,s_oStage);N.addEventListener(ON_MOUSE_DOWN,this._onJumpDown,this);N.addEventListener(ON_MOUSE_UP,this._onJumpUp,this)}else document.onkeydown=s_oGame.onKeyDown,document.onkeyup=s_oGame.onKeyUp;H=s_oSpriteLibrary.getSprite("but_exit");g=CANVAS_WIDTH-
H.width/2-10;f=H.height/2+10;C=new CGfxButton(g,f,H,s_oStage);C.addEventListener(ON_MOUSE_UP,this._onExit,this);!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(A=g-H.width,q=f,H=s_oSpriteLibrary.getSprite("audio_icon"),G=new CToggle(A,q,H,s_bAudioActive,s_oStage),G.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),d=A-H.width/2,t=q):(d=g-H.width,t=f);H=window.document;var D=H.documentElement;O=D.requestFullscreen||D.mozRequestFullScreen||D.webkitRequestFullScreen||D.msRequestFullscreen;I=H.exitFullscreen||
H.mozCancelFullScreen||H.webkitExitFullscreen||H.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(O=!1);O&&screenfull.isEnabled&&(H=s_oSpriteLibrary.getSprite("but_fullscreen"),B=new CToggle(d,t,H,s_bFullscreen,s_oStage),B.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));H=s_oSpriteLibrary.getSprite("but_settings");W=new CGUIExpandible(g,f,H,s_oStage);W.addButton(C);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||W.addButton(G);O&&screenfull.isEnabled&&W.addButton(B);w=10;z=40;v=new createjs.Text(TEXT_SCORE,
"40px "+FONT_GAME,"#fff");v.x=w;v.y=z;v.textBaseline="alphabetic";v.textAlign="left";v.shadow=new createjs.Shadow("#000000",2,2,5);s_oStage.addChild(v);e=new createjs.Text(R,"40px "+FONT_GAME,"#fff");e.x=v.x+20;e.y=z;e.textBaseline="alphabetic";e.textAlign="left";e.shadow=new createjs.Shadow("#000000",2,2,5);s_oStage.addChild(e);p=CANVAS_WIDTH/2;m=40;u=new createjs.Text(TEXT_LEVEL+" "+s_iLevelSelected,"40px "+FONT_GAME,"#fff");u.x=p;u.y=m;u.textBaseline="alphabetic";u.textAlign="center";u.shadow=
new createjs.Shadow("#000000",2,2,5);s_oStage.addChild(u);x=new CPowerUpGui(s_oStage);U=new CAreYouSurePanel;U.addEventListener(ON_BUT_YES_DOWN,this._onExitYes,this);y=new CRollingScore;this.refreshButtonPos()};this.unload=function(){C.unload();C=null;W.unload();U.unload();!1===DISABLE_SOUND_MOBILE&&(G.unload(),G=null);O&&screenfull.isEnabled&&B.unload();s_bMobile?(S.unload(),Q.unload(),N.unload()):(document.onkeydown=null,document.onkeyup=null);s_oStage.removeAllChildren();s_oInterface=null};this.reset=
function(R,H){e.text=R;u.text=TEXT_LEVEL+" "+H;x.reset();s_bMobile||(document.onkeydown=s_oGame.onKeyDown,document.onkeyup=s_oGame.onKeyUp)};this.removeKeyListener=function(){document.onkeydown=null;document.onkeyup=null};this._initKeyListeners=function(){s_bMobile||(document.onkeydown=s_oGame.onKeyDown,document.onkeyup=s_oGame.onKeyUp)};this.refreshButtonPos=function(){v.x=w+s_iOffsetX;v.y=z+s_iOffsetY;e.x=v.x+v.getBounds().width+20;e.y=v.y;u.y=m+s_iOffsetY;W.refreshPos();s_bMobile&&(S.setPosition(b+
s_iOffsetX,c-s_iOffsetY),Q.setPosition(n-s_iOffsetX,l-s_iOffsetY),N.setPosition(h,k-s_iOffsetY));x.refreshButtonPos()};this.refreshScore=function(R){y.rolling(e,null,R)};this.refreshPowerUpTime=function(R){x.refreshTime(R)};this.showPowerUpGui=function(){x.show()};this.hidePowerUpGui=function(){x.hide()};this._onLeftDown=function(){s_oGame.moveLeft(!0)};this._onRightDown=function(){s_oGame.moveRight(!0)};this._onJumpDown=function(){s_oGame.moveJump(!0)};this._onLeftUp=function(){s_oGame.moveLeft(!1)};
this._onRightUp=function(){s_oGame.moveRight(!1)};this._onJumpUp=function(){s_oGame.moveJump(!1)};this._onExit=function(){U.show(TEXT_ARE_SURE)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){O&&screenfull.isEnabled&&B.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?I.call(window.document):O.call(window.document.documentElement);sizeHandler()};this._onExitYes=function(){s_oGame.onExit()};s_oInterface=
this;this._init(a);return this}var s_oInterface=null;
function CHelpPanel(){var a,g,f,h,k,n,l,b,c,d,t=this;this._init=function(){d=new createjs.Container;d.visible=!1;s_oStage.addChild(d);f=new createjs.Shape;f.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g=f.on("click",function(){});d.addChild(f);var p=s_oSpriteLibrary.getSprite("msg_box_wide"),m=createBitmap(p);m.regX=p.width/2;m.regY=p.height/2;m.x=CANVAS_WIDTH/2;m.y=CANVAS_HEIGHT/2;d.addChild(m);if(s_bMobile){p=s_oSpriteLibrary.getSprite("but_left");m=s_oSpriteLibrary.getSprite("but_right");
var w=s_oSpriteLibrary.getSprite("but_jump");n=new CTextButton(CANVAS_WIDTH/2+240,CANVAS_HEIGHT/2+130,w,TEXT_JUMP,FONT_GAME,"#fff",100,"center",0,d);n.setScale(.65)}else p=s_oSpriteLibrary.getSprite("key_0"),m=s_oSpriteLibrary.getSprite("key_1"),w=s_oSpriteLibrary.getSprite("key_2"),n=createBitmap(w),n.regX=w.width/2,n.regY=w.height/2,n.x=CANVAS_WIDTH/2+240,n.y=CANVAS_HEIGHT/2+130,d.addChild(n);h=createBitmap(p);h.regX=p.width/2;h.regY=p.height/2;h.x=CANVAS_WIDTH/2-310;h.y=CANVAS_HEIGHT/2+130;d.addChild(h);
k=createBitmap(m);k.regX=m.width/2;k.regY=m.height/2;k.x=CANVAS_WIDTH/2-190;k.y=CANVAS_HEIGHT/2+130;d.addChild(k);b=this._attachPlayerRun();b.gotoAndPlay("anim");c=this._attachPlayerJump();c.on("animationend",this._onEndJump,this);l=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oSpriteLibrary.getSprite("but_next"),d);l.addEventListener(ON_MOUSE_UP,this._onStart,this);this._playAnims()};this.unload=function(){f.off("click",g)};this.show=function(){d.alpha=0;d.visible=!0;createjs.Tween.get(d).to({alpha:1},
500)};this.hide=function(){createjs.Tween.get(d).to({alpha:0},500,createjs.Ease.cubicOut).call(function(){clearInterval(a);d.visible=!1})};this._attachPlayerRun=function(){var p={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_run_0"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_run_1")],frames:[[1,1,609,448,0,0,0],[612,1,609,448,0,0,0],[1223,1,609,448,0,0,0],[1,451,609,448,0,0,0],[612,451,609,448,0,0,0],[1223,451,609,448,0,0,0],[1,901,609,448,0,0,0],[612,901,609,448,0,0,0],
[1223,901,609,448,0,0,0],[1,1351,609,448,0,0,0],[612,1351,609,448,0,0,0],[1223,1351,609,448,0,0,0],[1,1,609,448,1,0,0],[612,1,609,448,1,0,0],[1223,1,609,448,1,0,0],[1,451,609,448,1,0,0],[612,451,609,448,1,0,0],[1223,451,609,448,1,0,0]],animations:{start:0,anim:[0,17]}};p=new createjs.SpriteSheet(p);p=new createjs.Sprite(p,"start");p.scaleX=p.scaleY=.4;p.x=CANVAS_WIDTH/2-320;p.y=CANVAS_HEIGHT/2+70;p.regX=304.5;p.regY=448;d.addChild(p);return p};this._attachPlayerJump=function(p,m){var w={images:[s_oSpriteLibrary.getSprite("player"+
s_iTeamSelected+"_jump_0"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_1"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_2"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_3"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_4"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_5"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_6")],frames:[[1,1,993,712,0,0,0],[996,1,993,712,0,0,0],[1,715,993,712,0,0,0],[996,715,993,712,0,0,0],
[1,1,993,712,1,0,0],[996,1,993,712,1,0,0],[1,715,993,712,1,0,0],[996,715,993,712,1,0,0],[1,1,993,712,2,0,0],[996,1,993,712,2,0,0],[1,715,993,712,2,0,0],[996,715,993,712,2,0,0],[1,1,993,712,3,0,0],[996,1,993,712,3,0,0],[1,715,993,712,3,0,0],[996,715,993,712,3,0,0],[1,1,993,712,4,0,0],[996,1,993,712,4,0,0],[1,715,993,712,4,0,0],[996,715,993,712,4,0,0],[1,1,993,712,5,0,0],[996,1,993,712,5,0,0],[1,715,993,712,5,0,0],[996,715,993,712,5,0,0],[1,1,993,712,6,0,0],[996,1,993,712,6,0,0]],animations:{start:0,
anim:[0,25,"stop_anim"],stop_anim:25}};w=new createjs.SpriteSheet(w);w=new createjs.Sprite(w,"start");w.scaleX=w.scaleY=.4;w.x=CANVAS_WIDTH/2+180;w.y=CANVAS_HEIGHT/2-35;w.regX=304.5;w.regY=448;d.addChild(w);return w};this._playAnims=function(){var p=b.x+130,m=b.x;k.scaleX=k.scaleY=.9;createjs.Tween.get(b,{loop:!0}).to({x:p},2E3,createjs.Ease.cubicOut).call(function(){k.scaleX=k.scaleY=1;h.scaleX=h.scaleY=.9}).to({x:m},2E3,createjs.Ease.cubicOut).call(function(){h.scaleX=h.scaleY=1;k.scaleX=k.scaleY=
.9});a=setInterval(function(){s_bMobile?n.setScale(.6):n.scaleX=n.scaleY=.9;c.gotoAndPlay("anim")},3E3)};this._onEndJump=function(p){"anim"===p.currentTarget.currentAnimation&&(s_bMobile?n.setScale(.65):n.scaleX=n.scaleY=1)};this._onStart=function(){s_oInterface.removeKeyListener();l.disable();t.hide();s_oGame.startCountdown()};this.isVisible=function(){return d.visible};this._init()}
function CLevelSettings(){var a,g,f,h;this._init=function(){a=[16,18,20,22,24,26,28,30,32,34,36];g=[1500,1400,1300,1400,1300,1300,1200,1100,1600,1500,1400];f=[1,1,1,2,2,2,2,2,3,3,3];h=[[4],[4],[5],[6],[7],[8],[9],[10],[11],[12],[4,9]];NUM_LEVELS=a.length};this.getEnemiesSpawn=function(k){return a[k-1]};this.getStartingEnemySpawn=function(k){return g[k-1]};this.getEnemySpawnNumber=function(k){return f[k-1]};this.getPowerUps=function(k){return h[k-1]};this._init()}
function CLevelMenu(){var a,g,f,h,k,n,l,b,c,d,t,p,m,w,z,A,q,y=null,e=null;this._init=function(){l=0;A=new createjs.Container;s_oStage.addChild(A);var v=createBitmap(s_oSpriteLibrary.getSprite("bg_menu_level"));A.addChild(v);p=new createjs.Shape;p.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);p.alpha=.5;A.addChild(p);m=new createjs.Container;m.x=CANVAS_WIDTH/2+90;A.addChild(m);new CTLText(m,0,0,600,46,80,"center","#ffffff",FONT_GAME,1,20,2,TEXT_SELECT_LEVEL,!0,!0,!0,!1);v=s_oSpriteLibrary.getSprite("but_exit");
k=CANVAS_WIDTH-v.width/2-10;n=v.height/2+10;w=new CGfxButton(k,n,v,s_oStage);w.addEventListener(ON_MOUSE_UP,this._onExit,this);c=[];v=[{x:0,y:150},{x:200,y:150},{x:400,y:150},{x:600,y:150},{x:0,y:350},{x:200,y:350},{x:400,y:350},{x:600,y:350},{x:100,y:550},{x:300,y:550},{x:500,y:550}];for(var u=0;u<NUM_LEVELS;u++){var C=new CLevelBut(v[u].x,v[u].y,s_aTeamSeq[u],u+1,getLevelScore(u+1),u+1>s_iLastLevel?!1:!0,m);C.addEventListenerWithParams(ON_MOUSE_UP,this._onButLevelRelease,this,u);c.push(C)}m.regX=
m.getBounds().width/2;m.regY=m.getBounds().height/2;b=-m.getBounds().height/2;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)v=s_oSpriteLibrary.getSprite("audio_icon"),f=k-v.width/2-10,h=n,z=new CToggle(f,h,v,s_bAudioActive,s_oStage),z.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);v=window.document;u=v.documentElement;y=u.requestFullscreen||u.mozRequestFullScreen||u.webkitRequestFullScreen||u.msRequestFullscreen;e=v.exitFullscreen||v.mozCancelFullScreen||v.webkitExitFullscreen||v.msExitFullscreen;
!1===ENABLE_FULLSCREEN&&(y=!1);y&&screenfull.isEnabled&&(v=s_oSpriteLibrary.getSprite("but_fullscreen"),a=v.width/4+10,g=v.height/2+10,q=new CToggle(a,g,v,s_bFullscreen,s_oStage),q.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));t=new CLoaderResourcesPanel(s_oStage);t.addEventListener(ON_END_LOADING,this._onEndLoading,this);this.refreshButtonPos();p.alpha=0;m.y=b;A.visible=!0;createjs.Tween.get(p).to({alpha:.7},500);createjs.Tween.get(m).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.cubicOut)};
this.unload=function(){for(var v=0;v<c.length;v++)c[v].unload();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||z.unload();y&&screenfull.isEnabled&&q.unload();w.unload();t.unload();s_oStage.removeAllChildren();s_oLevelMenu=null};this.refreshButtonPos=function(){w.setPosition(k-s_iOffsetX,n+s_iOffsetY);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||z.setPosition(f-s_iOffsetX,s_iOffsetY+h);y&&screenfull.isEnabled&&q.setPosition(a+s_iOffsetX,g+s_iOffsetY)};this._onRight=function(){l++;l>=(void 0).length&&(l=
0)};this._onLeft=function(){l--;0>l&&(l=(void 0).length-1)};this._onButLevelRelease=function(v){d=s_aTeamSeq[v];s_oMain.levelSelected(v+1);if(s_aTeamLoaded[d])s_oLevelMenu.unload(),s_oMain.gotoGame();else{v=[];for(var u=0;18>u;u++)v.push({name:"player"+d+"_run_ahead_"+u,path:"./sprites/player_"+d+"/enemy/running/player"+d+"_run_ahead_"+u+".png"});for(u=0;18>u;u++)v.push({name:"player"+d+"_tackle_"+u,path:"./sprites/player_"+d+"/enemy/tackle/player"+d+"_tackle_"+u+".png"});t.start(v)}};this._onEndLoading=
function(){s_aTeamLoaded[d]=!0;s_oLevelMenu.unload();s_oMain.gotoGame()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this.resetFullscreenBut=function(){y&&screenfull.isEnabled&&q.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?e.call(window.document):y.call(window.document.documentElement);sizeHandler()};this._onExit=function(){s_oLevelMenu.unload();s_oMain.gotoMenu()};s_oLevelMenu=this;this._init()}var s_oLevelMenu=null;
function CLevelBut(a,g,f,h,k,n,l){var b,c,d,t=[],p=[],m,w,z,A,q;this._init=function(e,v,u,C,x,G){c=[];d=[];q=new createjs.Container;q.x=e;q.y=v;y.addChild(q);e=s_oSpriteLibrary.getSprite("but_level");v={images:[e],frames:{width:e.width/2,height:e.height,regX:e.width/2/2,regY:e.height/2},animations:{state_true:[0],state_false:[1]}};v=new createjs.SpriteSheet(v);b=G;A=createSprite(v,"state_"+b,e.width/2/2,e.height/2,e.width/2,e.height);s_bMobile||(q.cursor="pointer");q.addChild(A);t.push(A);G="#fff";
!1===b&&(G="#cacaca");w=new CTLText(q,-80,-80,160,30,30,"center","#00397a",FONT_GAME,1,0,0,TEXT_LEVEL+" "+C,!0,!0,!0,!1);w.setOutline(4);new CTLText(q,-80,-80,160,30,30,"center",G,FONT_GAME,1,0,0,TEXT_LEVEL+" "+C,!0,!0,!0,!1);v={images:[s_oSpriteLibrary.getSprite("but_flag_"+u)],frames:{width:124,height:98,regX:62,regY:49},animations:{state_true:[0],state_false:[1]}};v=new createjs.SpriteSheet(v);m=createSprite(v,"state_"+b,62,62,124,98);m.y=4;q.addChild(m);0<x&&(z=new CTLText(q,-84,64,168,20,20,
"center","#00397a",FONT_GAME,1,0,0,TEXT_SCORE+" "+x,!0,!0,!0,!1),z.setOutline(4),new CTLText(q,-84,64,168,20,20,"center",G,FONT_GAME,1,0,0,TEXT_SCORE+" "+x,!0,!0,!0,!1));this._initListener()};this.unload=function(){q.off("mousedown",this.buttonDown);q.off("pressup",this.buttonRelease);q.removeChild(A)};this._initListener=function(){q.on("mousedown",this.buttonDown);q.on("pressup",this.buttonRelease)};this.viewBut=function(e){q.addChild(e)};this.addEventListener=function(e,v,u){c[e]=v;d[e]=u};this.addEventListenerWithParams=
function(e,v,u,C){c[e]=v;d[e]=u;p=C};this.ifClickable=function(){return!0===q.mouseEnabled?1:0};this.setActive=function(e,v){b=v;t[e].gotoAndStop("state_"+b);t[e].mouseEnabled=!0};this.buttonRelease=function(){b&&(playSound("click",1,!1),c[ON_MOUSE_UP]&&c[ON_MOUSE_UP].call(d[ON_MOUSE_UP],p))};this.buttonDown=function(){c[ON_MOUSE_DOWN]&&c[ON_MOUSE_DOWN].call(d[ON_MOUSE_DOWN],p)};this.setPosition=function(e,v){q.x=e;q.y=v};this.setVisible=function(e){q.visible=e};var y=l;this._init(a,g,f,h,k,n,l)}
function CCreditsPanel(){var a,g,f,h,k,n,l,b;this._init=function(){b=new createjs.Container;s_oStage.addChild(b);var c=new createjs.Shape;c.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.addChild(c);c=s_oSpriteLibrary.getSprite("msg_box");g=createBitmap(c);g.regX=c.width/2;g.regY=c.height/2;g.x=CANVAS_WIDTH/2;g.y=CANVAS_HEIGHT/2;b.addChild(g);n=new createjs.Shape;n.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n.alpha=.01;a=n.on("click",this._onLogoButRelease);
b.addChild(n);c=s_oSpriteLibrary.getSprite("but_exit");h=new CGfxButton(980,240,c,b);h.addEventListener(ON_MOUSE_UP,this.unload,this);k=new createjs.Text(TEXT_CREDITS_DEVELOPED,"26px "+FONT_GAME,"#fff");k.textAlign="center";k.textBaseline="alphabetic";k.x=CANVAS_WIDTH/2;k.y=330;b.addChild(k);c=s_oSpriteLibrary.getSprite("logo_ctl");f=createBitmap(c);f.regX=c.width/2;f.regY=c.height/2;f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2;b.addChild(f);l=new createjs.Text("www.codethislab.com","26px "+FONT_GAME,"#fff");
l.textAlign="center";l.textBaseline="alphabetic";l.x=CANVAS_WIDTH/2;l.y=450;b.addChild(l)};this.unload=function(){n.off("click",a);h.unload();h=null;s_oStage.removeChild(b)};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en","_blank")};this._init()}
function CAlertSavingBox(a,g){var f,h;this._init=function(l){h=new createjs.Container;n.addChild(h);var b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.alpha=.5;b.on("click",function(){});h.addChild(b);b=s_oSpriteLibrary.getSprite("msg_box");var c=createBitmap(b);c.x=.5*CANVAS_WIDTH;c.y=.5*CANVAS_HEIGHT;c.regX=.5*b.width;c.regY=.5*b.height;h.addChild(c);new CTLText(h,CANVAS_WIDTH/2-b.width/2,CANVAS_HEIGHT/2-140,b.width,190,40,"center","#ffffff",FONT_GAME,
1,20,10,l,!0,!0,!0,!1);f=new CGfxButton(CANVAS_WIDTH/2,475,s_oSpriteLibrary.getSprite("but_exit"),h);f.addEventListener(ON_MOUSE_UP,this._onButOk,this)};this._onButOk=function(){k.unload()};this.unload=function(){f.unload();n.removeChild(h)};var k=this;var n=g;this._init(a)}
function CAreYouSurePanel(){var a,g,f,h,k,n,l,b,c=this;this._init=function(){a=[];g=[];l=new createjs.Container;l.visible=!1;s_oStage.addChild(l);b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.alpha=.5;b.on("click",function(){});l.addChild(b);var d=s_oSpriteLibrary.getSprite("msg_box");f=createBitmap(d);f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2;f.regX=.5*d.width;f.regY=.5*d.height;l.addChild(f);h=new CTLText(l,CANVAS_WIDTH/2-d.width/2,CANVAS_HEIGHT/2-d.height/
2,d.width,150,70,"center","#ffffff",FONT_GAME,1,40,10,TEXT_ARE_SURE,!0,!0,!0,!1);k=new CGfxButton(CANVAS_WIDTH/2+150,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_yes"),l);k.addEventListener(ON_MOUSE_UP,this._onButYes,this);n=new CGfxButton(CANVAS_WIDTH/2-150,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_no"),l);n.addEventListener(ON_MOUSE_UP,this._onButNo,this)};this.addEventListener=function(d,t,p){a[d]=t;g[d]=p};this.show=function(d){h.refreshText(d);l.alpha=0;l.visible=!0;createjs.Tween.get(l).to({alpha:1},
300,createjs.Ease.quartOut).call(function(){s_oMain.stopUpdateNoBlock()})};this.hide=function(){s_oMain.startUpdateNoBlock();createjs.Tween.get(l).to({alpha:0},500,createjs.Ease.quartOut).call(function(){l.visible=!1})};this.unload=function(){n.unload();k.unload()};this._onButYes=function(){c.hide();a[ON_BUT_YES_DOWN]&&a[ON_BUT_YES_DOWN].call(g[ON_BUT_YES_DOWN])};this._onButNo=function(){c.hide()};this._init()}
function CGUIExpandible(a,g,f,h){var k,n,l,b,c,d,t,p;this._init=function(w,z,A,q){b=[];d=new createjs.Container;d.x=w;d.y=z;q.addChild(d);t=new createjs.Container;d.addChild(t);p=new createjs.Container;d.addChild(p);l=!1;c=new CGfxButton(0,0,A,p);c.addEventListener(ON_MOUSE_UP,this._onMenu,this);n=k=85};this.unload=function(){c.unload();h.removeChild(d)};this.refreshPos=function(){d.x=a-s_iOffsetX;d.y=g+s_iOffsetY};this.addButton=function(w){w=w.getButtonImage();w.x=0;w.y=0;w.visible=0;t.addChildAt(w,
0);b.push(w)};this._onMenu=function(){(l=!l)?m._expand():m._collapse()};this._expand=function(){for(var w=0;w<b.length;w++)b[w].visible=!0,createjs.Tween.get(b[w],{override:!0}).wait(300*w/2).to({y:k+w*n},300,createjs.Ease.cubicOut)};this._collapse=function(){for(var w=0;w<b.length;w++){var z=b[b.length-1-w];createjs.Tween.get(z,{override:!0}).wait(300*w/2).to({y:0},300,createjs.Ease.cubicOut).call(function(A){A.visible=!1},[z])}};var m=this;this._init(a,g,f,h)}
function CField(a,g,f){var h=!1,k,n,l,b;this._init=function(d,t){b=new createjs.Container;b.visible=!1;b.x=d;b.y=t;c.addChild(b);l=[];for(var p=0;18>p;p++){var m=createBitmap(s_oSpriteLibrary.getSprite("field_loop_"+p));b.addChild(m);l.push(m);0<p&&(m.visible=!1)}};this.show=function(){k=l.length;l[0].visible=!0;n=0;h=b.visible=!0};this.hide=function(){b.visible=!1};this.playToFrame=function(d){l[n].visible=!1;n=d;l[n].visible=!0};this.nextFrame=function(){l[n].visible=!1;n++;l[n].visible=!0};this.update=
function(){!1!==h&&(n===k-1?this.playToFrame(0):this.nextFrame())};var c=f;this._init(a,g)}
function CFieldEndZone(a,g,f){var h=!1,k,n,l,b;this._init=function(d,t){b=new createjs.Container;b.visible=!1;b.x=d;b.y=t;c.addChild(b);l=[];for(var p=0;39>p;p++){var m=createBitmap(s_oSpriteLibrary.getSprite("end_zone_"+p));b.addChild(m);l.push(m);0<p&&(m.visible=!1)}};this.show=function(){k=l.length;l[0].visible=!0;n=0;h=b.visible=!0};this.hide=function(){b.visible=!1};this.reset=function(){for(var d=0;d<l.length;d++)l[d].visible=!1;b.visible=!1};this.playToFrame=function(d){l[n].visible=!1;n=d;
l[n].visible=!0};this.nextFrame=function(){l[n].visible=!1;n++;l[n].visible=!0};this.update=function(){!1!==h&&(n===k-1?(h=!1,s_oGame.endZonePlayed()):this.nextFrame())};var c=f;this._init(a,g)}
function CPlayer(a,g,f){var h=!1,k,n=!1,l=!1,b,c,d,t,p,m,w,z,A,q,y,e,v=this,u;this._init=function(x,G){k=!1;c=x;d=G;m=0;t=HERO_ACCELERATION;p=MAX_HERO_SPEED;y=[];e=[];u=new createjs.Container;u.x=x;u.y=G;C.addChild(u);A=[];q=[];q[PLAYER_ANIM_RUN]=18;q[PLAYER_ANIM_FALL]=9;q[PLAYER_ANIM_TOUCHDOWN]=50;q[PLAYER_ANIM_JUMP]=26;var B={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_run_0"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_run_1")],frames:[[1,1,609,448,0,0,0],[612,1,609,
448,0,0,0],[1223,1,609,448,0,0,0],[1,451,609,448,0,0,0],[612,451,609,448,0,0,0],[1223,451,609,448,0,0,0],[1,901,609,448,0,0,0],[612,901,609,448,0,0,0],[1223,901,609,448,0,0,0],[1,1351,609,448,0,0,0],[612,1351,609,448,0,0,0],[1223,1351,609,448,0,0,0],[1,1,609,448,1,0,0],[612,1,609,448,1,0,0],[1223,1,609,448,1,0,0],[1,451,609,448,1,0,0],[612,451,609,448,1,0,0],[1223,451,609,448,1,0,0]],animations:{start:0,anim:[0,q[PLAYER_ANIM_RUN]-1]}};B=new createjs.SpriteSheet(B);A[PLAYER_ANIM_RUN]=new createjs.Sprite(B,
"start");A[PLAYER_ANIM_RUN].regX=304.5;A[PLAYER_ANIM_RUN].regY=448;u.addChild(A[PLAYER_ANIM_RUN]);B={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_falling")],frames:{width:611,height:450},animations:{start:0,anim:[0,q[PLAYER_ANIM_FALL]-1,"stop_anim"],stop_anim:q[PLAYER_ANIM_FALL]}};B=new createjs.SpriteSheet(B);A[PLAYER_ANIM_FALL]=new createjs.Sprite(B,"start");A[PLAYER_ANIM_FALL].on("animationend",this._onPlayerFall,this);A[PLAYER_ANIM_FALL].visible=!1;A[PLAYER_ANIM_FALL].regX=304.5;
A[PLAYER_ANIM_FALL].regY=448;u.addChild(A[PLAYER_ANIM_FALL]);B={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_0"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_1"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_2"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_3"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_4"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_touchdown_5")],frames:{width:611,height:450},
animations:{start:0,anim:[0,q[PLAYER_ANIM_TOUCHDOWN]-1,"stop_anim"],stop_anim:q[PLAYER_ANIM_TOUCHDOWN]-1}};B=new createjs.SpriteSheet(B);A[PLAYER_ANIM_TOUCHDOWN]=new createjs.Sprite(B,"start");A[PLAYER_ANIM_TOUCHDOWN].on("animationend",this._onPlayerTouchdown,this);A[PLAYER_ANIM_TOUCHDOWN].visible=!1;A[PLAYER_ANIM_TOUCHDOWN].regX=304.5;A[PLAYER_ANIM_TOUCHDOWN].regY=448;u.addChild(A[PLAYER_ANIM_TOUCHDOWN]);B={images:[s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_0"),s_oSpriteLibrary.getSprite("player"+
s_iTeamSelected+"_jump_1"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_2"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_3"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_4"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_5"),s_oSpriteLibrary.getSprite("player"+s_iTeamSelected+"_jump_6")],frames:[[1,1,993,712,0,0,0],[996,1,993,712,0,0,0],[1,715,993,712,0,0,0],[996,715,993,712,0,0,0],[1,1,993,712,1,0,0],[996,1,993,712,1,0,0],[1,715,993,712,1,0,0],
[996,715,993,712,1,0,0],[1,1,993,712,2,0,0],[996,1,993,712,2,0,0],[1,715,993,712,2,0,0],[996,715,993,712,2,0,0],[1,1,993,712,3,0,0],[996,1,993,712,3,0,0],[1,715,993,712,3,0,0],[996,715,993,712,3,0,0],[1,1,993,712,4,0,0],[996,1,993,712,4,0,0],[1,715,993,712,4,0,0],[996,715,993,712,4,0,0],[1,1,993,712,5,0,0],[996,1,993,712,5,0,0],[1,715,993,712,5,0,0],[996,715,993,712,5,0,0],[1,1,993,712,6,0,0],[996,1,993,712,6,0,0]],animations:{start:0,anim:[0,q[PLAYER_ANIM_JUMP]-1,"stop_anim"],stop_anim:q[PLAYER_ANIM_JUMP]}};
B=new createjs.SpriteSheet(B);A[PLAYER_ANIM_JUMP]=new createjs.Sprite(B,"start");A[PLAYER_ANIM_JUMP].on("animationend",this._onPlayerJump);A[PLAYER_ANIM_JUMP].visible=!1;A[PLAYER_ANIM_JUMP].x=-200;A[PLAYER_ANIM_JUMP].y=-220;A[PLAYER_ANIM_JUMP].regX=304.5;A[PLAYER_ANIM_JUMP].regY=448;u.addChild(A[PLAYER_ANIM_JUMP]);b=PLAYER_ANIM_RUN};this.addEventListener=function(x,G,B){y[x]=G;e[x]=B};this.show=function(){A[b].visible=!0;A[b].gotoAndPlay("anim");u.visible=!0;w=u.getBounds().width-300;z=u.getBounds().height;
h=!0};this.hide=function(){h=!1;u.visible=!1};this.reset=function(){l=n=k=h=!1;m=0;t=HERO_ACCELERATION;p=MAX_HERO_SPEED;u.alpha=1;u.x=c;u.y=d;A[PLAYER_ANIM_RUN].visible=!1;A[PLAYER_ANIM_FALL].visible=!1;A[PLAYER_ANIM_TOUCHDOWN].visible=!1;A[PLAYER_ANIM_JUMP].visible=!1;b=PLAYER_ANIM_RUN};this.changeAnim=function(x){-1!==b&&(A[b].visible=!1,A[b].gotoAndStop("start"),b=x,A[b].visible=!0,A[b].gotoAndPlay("anim"))};this.jump=function(){k=!0;this.changeAnim(PLAYER_ANIM_JUMP)};this.moveLeft=function(x){n=
x};this.moveRight=function(x){l=x};this.setAcceleration=function(x,G){t=x;p=G};this.setY=function(x){u.y=x};this._onPlayerFall=function(x){"anim"===x.currentTarget.currentAnimation&&(v.hide(),y[ON_PLAYER_TACKLED]&&y[ON_PLAYER_TACKLED].call(e[ON_PLAYER_TACKLED]))};this._onPlayerTouchdown=function(x){"anim"===x.currentTarget.currentAnimation&&((new createjs.Tween.get(u)).to({alpha:0},500),y[ON_PLAYER_TOUCHDOWN]&&y[ON_PLAYER_TOUCHDOWN].call(e[ON_PLAYER_TOUCHDOWN]),b=-1)};this._onPlayerJump=function(x){"anim"===
x.currentTarget.currentAnimation&&(k=!1,v.changeAnim(PLAYER_ANIM_RUN))};this.getRect=function(){return new createjs.Rectangle(u.x-w/2,u.y-z,w,z)};this.isJumping=function(){return k};this.getCurAnim=function(){return b};this.getX=function(){return u.x};this._updateMove=function(){b===PLAYER_ANIM_RUN&&(n&&(m-=t),l&&(m+=t),u.x+=m,m*=HERO_FRICTION,m>p&&(m=p),m<-p&&(m=-p),.1>Math.abs(m)&&(m=0),u.x+m>CANVAS_WIDTH-s_iOffsetX&&(u.x=CANVAS_WIDTH-m-s_iOffsetX),u.x-m<s_iOffsetX&&(u.x=m+s_iOffsetX))};this.update=
function(){!1!==h&&this._updateMove()};var C=f;this._init(a,g)}
function COpponent(a,g,f,h,k){var n,l,b=!1,c,d,t,p,m,w,z,A,q,y,e,v=this;this._init=function(C,x,G){q=[];y=[];n=x;l=G;e=new createjs.Container;e.x=x;e.y=G;e.scaleX=e.scaleY=.1;u.addChild(e);A=[];A[PLAYER_ANIM_RUN]=18;A[PLAYER_ANIM_FALL]=18;z=[];z[PLAYER_ANIM_RUN]=[];for(x=0;x<A[PLAYER_ANIM_RUN];x++){G=s_oSpriteLibrary.getSprite("player"+C+"_run_ahead_"+x);var B=createBitmap(G);B.visible=!1;B.regX=G.width/2;B.regY=G.height;e.addChild(B);z[PLAYER_ANIM_RUN].push(B);m=G.width-500;w=G.height}z[PLAYER_ANIM_FALL]=
[];for(x=0;x<A[PLAYER_ANIM_FALL];x++)G=s_oSpriteLibrary.getSprite("player"+C+"_tackle_"+x),B=createBitmap(G),B.visible=!1,B.regX=G.width/2,B.regY=G.height,e.addChild(B),z[PLAYER_ANIM_FALL].push(B);c=PLAYER_ANIM_RUN;this.show()};this.addEventListener=function(C,x,G){q[C]=x;y[C]=G};this.reset=function(){e.x=n;e.y=l;e.scaleX=e.scaleY=.1;for(var C=0;C<A[PLAYER_ANIM_RUN];C++)z[PLAYER_ANIM_RUN][C].visible=!1;for(C=0;C<A[PLAYER_ANIM_FALL];C++)z[PLAYER_ANIM_FALL][C].visible=!1;c=PLAYER_ANIM_RUN};this.show=
function(){b=!1;d=1;this.reset();v._startRun()};this._startRun=function(){t=A[c];z[c][0].visible=!0;p=Math.floor(Math.random()*z[PLAYER_ANIM_RUN].length);e.alpha=0;e.visible=!0;(new createjs.Tween.get(e)).to({alpha:1},500);(new createjs.Tween.get(e)).to({scaleX:1,scaleY:1,y:OPPONENT_FINAL_Y},TIME_OPPONENT_RUN,createjs.Ease.cubicIn).call(function(){if(q[ON_OPPONENT_TACKLE]){var C=new createjs.Rectangle(e.x-m/2,e.y-w,m,w);q[ON_OPPONENT_TACKLE].call(y[ON_OPPONENT_TACKLE],C)}});(new createjs.Tween.get(e)).wait(2500).call(function(){s_oGame.getPlayerX()>
e.x&&(d=-1);v._changeAnim(PLAYER_ANIM_FALL,Math.floor(4*Math.random()));playSound("enemy",1,!1)});setTimeout(function(){},2500);b=!0};this.hide=function(){b=!1;e.visible=!1;q[ON_OPPONENT_HIDE]&&q[ON_OPPONENT_HIDE].call(y[ON_OPPONENT_HIDE],a)};this.playToFrame=function(C){z[c][p].visible=!1;p=C;z[c][p].scaleX=d;z[c][p].visible=!0};this.nextFrame=function(){z[c][p].visible=!1;p++;z[c][p].scaleX=d;z[c][p].visible=!0};this._changeAnim=function(C,x){b=!1;z[c][p].visible=!1;c=C;p=x;z[c][p].visible=!0;t=
A[c];b=!0};this.update=function(){!1!==b&&(p===t-1?c===PLAYER_ANIM_RUN?this.playToFrame(0):this.hide():this.nextFrame())};var u=k;this._init(g,f,h)}
function CEndPanel(){var a,g,f,h,k,n,l,b,c,d,t,p,m,w=this;this._init=function(){a=!1;h=[];k=[];p=new createjs.Container;p.visible=!1;s_oStage.addChild(p);l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.alpha=0;n=l.on("click",function(){});p.addChild(l);m=new createjs.Container;m.x=CANVAS_WIDTH/2;p.addChild(m);var z=s_oSpriteLibrary.getSprite("msg_box_wide"),A=createBitmap(z);m.addChild(A);b=new CTLText(m,0,0,z.width,120,80,"center","#ffffff",FONT_GAME,
1,40,10,"",!0,!0,!0,!1);c=new CTLText(m,0,z.height/2-60,z.width,80,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);d=new CGfxButton(z.width/2-250,z.height/2+120,s_oSpriteLibrary.getSprite("but_home"),m);d.addEventListener(ON_MOUSE_UP,this._onHome,this);t=new CGfxButton(z.width/2+250,z.height/2+120,s_oSpriteLibrary.getSprite("but_restart"),m);t.addEventListener(ON_MOUSE_UP,this._onRestart,this);g=-z.height/2;m.regX=z.width/2;m.regY=z.height/2};this.unload=function(){d.unload();t.unload();l.off("click",
n)};this.addEventListener=function(z,A,q){h[z]=A;k[z]=q};this.show=function(z,A){setVolume("soundtrack",0);(A===TEXT_CONGRATS?playSound("level_win",1,!1):playSound("game_over",1,!1)).on("end",function(){setVolume("soundtrack",1)});b.refreshText(A);c.refreshText(TEXT_SCORE+": "+z);l.alpha=0;m.y=g;p.visible=!0;createjs.Tween.get(l).to({alpha:.7},500);createjs.Tween.get(m).wait(400).to({y:CANVAS_HEIGHT/2},1E3,createjs.Ease.bounceOut).call(function(){w.enableButtons();a=!0})};this.hide=function(){createjs.Tween.get(m).to({y:g},
1E3,createjs.Ease.backIn).call(function(){a=!1;p.visible=!1;h[f]&&h[f].call(k[f])})};this.enableButtons=function(){d.enable();t.enable()};this.disableButtons=function(){d.disable();t.disable()};this._onHome=function(){w.disableButtons();f=ON_BACK_MENU;w.hide()};this._onRestart=function(){w.disableButtons();s_oInterface.removeKeyListener();$(s_oMain).trigger("show_interlevel_ad");f=ON_RESTART;w.hide()};this.isVisible=function(){return a};this._init()}
function CPowerUp(a,g,f,h){var k,n,l,b;this._init=function(c,d,t){k=t;n=[];l=[];b=new createjs.Container;b.scaleX=b.scaleY=.1;b.x=c;b.y=d;h.addChild(b);d={images:[s_oSpriteLibrary.getSprite("power_up_"+k)],framerate:15,frames:{width:286,height:404},animations:{start:0,anim:[0,14]}};d=new createjs.SpriteSheet(d);d=createSprite(d,"anim",0,0,286,404);b.addChild(d);b.regX=143;b.regY=202;b.alpha=0;var p=(c-MIN_POWERUP_X)/(MAX_POWERUP_X-MIN_POWERUP_X)*1140;(new createjs.Tween.get(b)).to({alpha:1},500);
(new createjs.Tween.get(b)).to({scaleX:1,scaleY:1,x:p,y:POWERUP_FINAL_Y},1.5*TIME_OPPONENT_RUN,createjs.Ease.cubicIn).call(function(){if(n[ON_POWERUP_END_MOVE]){var m=new createjs.Rectangle(p-143,POWERUP_FINAL_Y-202,286,404);n[ON_POWERUP_END_MOVE].call(l[ON_POWERUP_END_MOVE],m,k);h.removeChild(b)}})};this.unload=function(){h.removeChild(b)};this.addEventListener=function(c,d,t){n[c]=d;l[c]=t};this.stopTween=function(){createjs.Tween.removeTweens(b)};this._init(a,g,f)}
function CNextLevelPanel(){var a,g,f,h,k,n,l,b,c,d,t,p,m,w,z,A=this;this._init=function(){a=!1;h=[];k=[];w=new createjs.Container;w.visible=!1;s_oStage.addChild(w);l=new createjs.Shape;l.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.alpha=0;n=l.on("click",function(){});w.addChild(l);z=new createjs.Container;z.x=CANVAS_WIDTH/2;w.addChild(z);var q=s_oSpriteLibrary.getSprite("msg_box_wide"),y=createBitmap(q);z.addChild(y);c=new CTLText(z,0,0,q.width,120,80,"center","#ffffff",
FONT_GAME,1,40,10,"",!0,!0,!0,!1);b=new CTLText(z,0,q.height/2-70,q.width,60,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);d=new CTLText(z,0,q.height/2,q.width,60,80,"center","#ffffff",FONT_GAME,1,40,10,"",!0,!0,!0,!1);t=new CGfxButton(q.width/2-250,q.height/2+120,s_oSpriteLibrary.getSprite("but_home"),z);t.addEventListener(ON_MOUSE_UP,this._onHome,this);p=new CGfxButton(q.width/2,q.height/2+120,s_oSpriteLibrary.getSprite("but_restart"),z);p.addEventListener(ON_MOUSE_UP,this._onRestart,
this);m=new CGfxButton(q.width/2+250,q.height/2+120,s_oSpriteLibrary.getSprite("but_next"),z);m.addEventListener(ON_MOUSE_UP,this._onNext,this);g=-q.height/2;z.regX=q.width/2;z.regY=q.height/2};this.unload=function(){t.unload();p.unload();l.off("click",n)};this.addEventListener=function(q,y,e){h[q]=y;k[q]=e};this.show=function(q,y,e){setVolume("soundtrack",0);playSound("level_win",1,!1).on("end",function(){setVolume("soundtrack",1)});c.refreshText(sprintf(TEXT_LEVEL_CLEARED,e));b.refreshText(TEXT_LEVEL_SCORE+
": "+q);d.refreshText(TEXT_SCORE+": "+y);l.alpha=0;z.y=g;w.visible=!0;createjs.Tween.get(l).to({alpha:.7},500);createjs.Tween.get(z).wait(400).to({y:CANVAS_HEIGHT/2},1E3,createjs.Ease.bounceOut).call(function(){A.enableButtons();a=!0})};this.hide=function(){createjs.Tween.get(z).to({y:g},1E3,createjs.Ease.backIn).call(function(){a=!1;w.visible=!1;h[f]&&h[f].call(k[f])})};this.enableButtons=function(){t.enable();m.enable();p.enable()};this.disableButtons=function(){t.disable();m.disable();p.disable()};
this._onHome=function(){A.disableButtons();f=ON_BACK_MENU;A.hide()};this._onRestart=function(){A.disableButtons();$(s_oMain).trigger("show_interlevel_ad");f=ON_RESTART;A.hide()};this._onNext=function(){s_oInterface.removeKeyListener();A.disableButtons();$(s_oMain).trigger("show_interlevel_ad");f=ON_NEXT_LEVEL;A.hide()};this.isVisible=function(){return a};this._init()}var MS_ROLLING_SCORE=400;
function CRollingScore(){var a=null,g=null;this.rolling=function(f,h,k){a=createjs.Tween.get(f).to({text:k},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(a);f.color="#fff"}).addEventListener("change",function(){f.text=Math.floor(f.text)});null!==h&&(g=createjs.Tween.get(h).to({text:k},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(g)}).addEventListener("change",function(){h.text=Math.floor(h.text)}))};return this}
function CScoreText(a,g,f,h){var k;this._init=function(n,l,b){k=new createjs.Text("+"+n," 80px "+FONT_GAME,"#fff");k.textAlign="center";k.x=l;k.y=b;k.alpha=0;k.shadow=new createjs.Shadow("#000",1,1,1);h.addChild(k);var c=this;createjs.Tween.get(k).to({alpha:1},200,createjs.Ease.quadIn).call(function(){c.moveUp()})};this.moveUp=function(){var n=k.y-400,l=this;createjs.Tween.get(k).to({y:n},1500,createjs.Ease.sineIn).call(function(){l.unload()});createjs.Tween.get(k).wait(800).to({alpha:0},500)};this.unload=
function(){h.removeChild(k)};this._init(a,g,f)}
function CPowerUpGui(a){var g,f,h,k,n,l,b;this._init=function(){var c=s_oSpriteLibrary.getSprite("powerup_gui_off");h=c.width;k=c.height;g=CANVAS_WIDTH-c.width-10;f=CANVAS_HEIGHT-c.height-10;b=new createjs.Container;b.x=g;b.y=f;b.visible=!1;a.addChild(b);var d=createBitmap(c);b.addChild(d);d=createBitmap(s_oSpriteLibrary.getSprite("powerup_gui_on"));b.addChild(d);l=new createjs.Shape;l.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,c.width,c.height);b.addChild(l);d.mask=l;n=new createjs.Text("00:00",
"20px "+FONT_GAME,"#fff");n.x=c.width/2;n.y=-10;n.textBaseline="alphabetic";n.textAlign="center";b.addChild(n)};this.refreshButtonPos=function(){b.x=g-s_iOffsetX;b.y=f-s_iOffsetY};this.reset=function(){b.visible=!1};this.show=function(){this.refreshTime(0);b.x+=h+10;b.visible=!0;createjs.Tween.get(b).to({x:g-s_iOffsetX},1E3,createjs.Ease.backOut)};this.hide=function(){createjs.Tween.get(b).to({x:b.x+h+10},1E3,createjs.Ease.backIn).call(function(){b.visible=!1})};this.refreshTime=function(c){n.text=
formatTime(TIME_EFFECT_POWERUP-c);l.graphics.clear();c=Math.floor((100-Math.floor(c/TIME_EFFECT_POWERUP*100))*h/100);l.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,c,k)};this._init()}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var a=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(a--,this._oText.font=a+"px "+this._szFont,this._oText.lineHeight=Math.round(a*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>a););this._iFontSize=a}},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(a){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(a,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(a)},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){null!==this._oText&&(this._oText.outline=a)},setShadow:function(a,g,f,h){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(a,g,f,h))},setColor:function(a){this._oText.color=a},setAlpha:function(a){this._oText.alpha=a},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},
refreshText:function(a){""===a&&(a=" ");null===this._oText&&this.__createText(a);this._oText.text=a;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(a,g,f,h,k,n,l,b,c,d,t,p,m,w,z,A,q){this._oContainer=a;this._x=g;this._y=f;this._iWidth=h;this._iHeight=k;this._bMultiline=A;this._iFontSize=n;this._szAlign=l;this._szColor=b;this._szFont=c;this._iPaddingH=t;this._iPaddingV=p;this._bVerticalAlign=z;this._bFitText=w;this._bDebug=q;this._oDebugShape=null;this._fLineHeightFactor=d;this._oText=null;m&&this.__createText(m)}
function CChooseMenu(){var a,g,f,h,k,n,l,b,c,d,t,p,m,w,z=null,A=null;this._init=function(){var q=createBitmap(s_oSpriteLibrary.getSprite("bg_menu_level"));s_oStage.addChild(q);new CTLText(s_oStage,CANVAS_WIDTH/2-420,120,580,100,100,"center","#fff",FONT_GAME,1,0,0,TEXT_SELECT_TEAM,!0,!0,!0,!1);w=new createjs.Container;w.x=CANVAS_WIDTH/2-60;w.y=CANVAS_HEIGHT/2+122;s_oStage.addChild(w);l=[];var y=0,e=0;for(q=0;q<NUM_TEAMS;q++){var v=new CButFlag(y,e,q,TEAM_NAMES[q],w);v.addEventListenerWithParams(ON_MOUSE_UP,
this._onFlagSelected,this,q);y+=150;3===q%4&&(y=0,e+=150);l.push(v)}l[s_iTeamSelected].select();w.regX=w.getBounds().width/2;w.regY=w.getBounds().height/2;b=[];for(q=0;q<NUM_TEAMS;q++)y=s_oSpriteLibrary.getSprite("team_"+q),e=createBitmap(y),e.x=CANVAS_WIDTH/2+380,e.y=CANVAS_HEIGHT/2,e.regX=y.width/2,e.regY=y.height/2,s_oStage.addChild(e),q!==s_iTeamSelected&&(e.visible=!1),b.push(e);c=new CTextButton(CANVAS_WIDTH/2+380,CANVAS_HEIGHT/2+235,s_oSpriteLibrary.getSprite("but_go"),TEXT_PLAY,FONT_GAME,
"#fff",70,"right",40,s_oStage);c.addEventListener(ON_MOUSE_UP,this._onPlay,this);q=s_oSpriteLibrary.getSprite("but_exit");a=CANVAS_WIDTH-q.width/2-10;g=q.height/2+10;d=new CGfxButton(a,g,q,s_oStage);d.addEventListener(ON_MOUSE_UP,this._onExit,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)q=s_oSpriteLibrary.getSprite("audio_icon"),k=a-q.width/2-10,n=g,t=new CToggle(k,n,q,s_bAudioActive,s_oStage),t.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);q=window.document;y=q.documentElement;z=y.requestFullscreen||
y.mozRequestFullScreen||y.webkitRequestFullScreen||y.msRequestFullscreen;A=q.exitFullscreen||q.mozCancelFullScreen||q.webkitExitFullscreen||q.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(z=!1);z&&screenfull.isEnabled&&(q=s_oSpriteLibrary.getSprite("but_fullscreen"),f=q.width/4+10,h=q.height/2+10,p=new CToggle(f,h,q,s_bFullscreen,s_oStage),p.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));m=new CLoaderResourcesPanel(s_oStage);m.addEventListener(ON_END_LOADING,this._onEndLoading,this);var u=
new createjs.Shape;u.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(u);createjs.Tween.get(u).to({alpha:0},500).call(function(){u.visible=!1});this.refreshButtonPos()};this.unload=function(){createjs.Tween.removeAllTweens();for(var q=0;q<l.length;q++)l[q].unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)t.unload(),t=null;z&&screenfull.isEnabled&&p.unload();d.unload();m.unload();c.unload();s_oStage.removeAllChildren();s_oChooseMenu=null};this.refreshButtonPos=
function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||t.setPosition(k-s_iOffsetX,s_iOffsetY+n);z&&screenfull.isEnabled&&p.setPosition(f+s_iOffsetX,h+s_iOffsetY);d.setPosition(a-s_iOffsetX,g+s_iOffsetY)};this._onFlagSelected=function(q){l[s_iTeamSelected].unselect();b[s_iTeamSelected].visible=!1;s_iTeamSelected=q;l[s_iTeamSelected].select();b[s_iTeamSelected].visible=!0};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onEndLoading=function(){s_aTeamLoaded[s_iTeamSelected]=
!0;s_oChooseMenu.unload();s_oMain.gotoLevelMenu()};this._onExit=function(){s_oChooseMenu.unload();s_oMain.gotoMenu()};this.resetFullscreenBut=function(){z&&screenfull.isEnabled&&p.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?A.call(window.document):z.call(window.document.documentElement);sizeHandler()};this._onPlay=function(){s_oMain.createOpponentSeq();trace("s_aTeamLoaded["+s_iTeamSelected+"] "+s_aTeamLoaded[s_iTeamSelected]);if(s_aTeamLoaded[s_iTeamSelected])s_oChooseMenu.unload(),
s_oMain.gotoLevelMenu();else{for(var q=[],y=0;2>y;y++)q.push({name:"player"+s_iTeamSelected+"_run_"+y,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_run_"+y+".png"});for(y=0;6>y;y++)q.push({name:"player"+s_iTeamSelected+"_touchdown_"+y,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_touchdown_"+y+".png"});for(y=0;7>y;y++)q.push({name:"player"+s_iTeamSelected+"_jump_"+y,path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_jump_"+y+".png"});
q.push({name:"player"+s_iTeamSelected+"_falling",path:"./sprites/player_"+s_iTeamSelected+"/player"+s_iTeamSelected+"_falling.png"});m.start(q)}};s_oChooseMenu=this;this._init()}var s_oChooseMenu=null;
function CButFlag(a,g,f,h,k){var n,l,b,c,d,t,p,m,w,z,A;this._init=function(q,y,e,v){n=!1;l=1;b=[];c=[];m=new createjs.Container;m.x=q;m.y=y;m.cursor="pointer";k.addChild(m);q={images:[s_oSpriteLibrary.getSprite("flags")],frames:{width:124,height:124},animations:{team_0:0,team_1:1,team_2:2,team_3:3,team_4:4,team_5:5,team_6:6,team_7:7,team_8:8,team_9:9,team_10:10,team_11:11}};q=new createjs.SpriteSheet(q);A=createSprite(q,"team_"+e,0,0,124,124);m.addChild(A,w);w=new CTLText(m,6,100,112,22,30,"center",
"#fff",FONT_GAME,1,0,0,v,!0,!0,!1,!1);e=s_oSpriteLibrary.getSprite("team_selection");z=createBitmap(e);z.visible=!1;z.regX=e.width/2;z.regY=e.height/2;z.x=62;z.y=62;m.addChild(z);m.regX=m.getBounds().width/2;m.regY=m.getBounds().height/2;this._initListener()};this.unload=function(){m.off("mousedown",d);m.off("pressup",t);k.removeChild(m)};this.setVisible=function(q){m.visible=q};this.select=function(){z.visible=!0};this.unselect=function(){z.visible=!1};this.setAlign=function(q){w.textAlign=q};this.setScale=
function(q){l=q;m.scaleX=m.scaleY=q};this._initListener=function(){d=m.on("mousedown",this.buttonDown);t=m.on("pressup",this.buttonRelease)};this.addEventListener=function(q,y,e){b[q]=y;c[q]=e};this.addEventListenerWithParams=function(q,y,e,v){b[q]=y;c[q]=e;p=v};this.buttonRelease=function(){n||(playSound("click",1,!1),m.scaleX=l,m.scaleY=l,b[ON_MOUSE_UP]&&b[ON_MOUSE_UP].call(c[ON_MOUSE_UP],p))};this.buttonDown=function(){n||(m.scaleX=.9*l,m.scaleY=.9*l,b[ON_MOUSE_DOWN]&&b[ON_MOUSE_DOWN].call(c[ON_MOUSE_DOWN]))};
this.buttonOver=function(){n||A.gotoAndStop("over")};this.buttonOut=function(){n||A.gotoAndStop("idle")};this.setPosition=function(q,y){m.x=q;m.y=y};this.changeText=function(q){w.text=q};this.playSelectedAnim=function(q,y){n=!0;A.gotoAndStop("idle");(new createjs.Tween.get(m)).wait(500).to({x:q,y:y,scaleX:1,scaleY:1},1500,createjs.Ease.cubicOut).wait(500).call(function(){b[ON_END_SELECT_ANIM]&&b[ON_END_SELECT_ANIM].call(c[ON_END_SELECT_ANIM])})};this.playFadeOutAnim=function(){n=!0;(new createjs.Tween.get(m)).to({alpha:0},
800)};this.setX=function(q){m.x=q};this.setY=function(q){m.y=q};this.getButtonImage=function(){return m};this.getX=function(){return m.x};this.getY=function(){return m.y};this.getSprite=function(){return m};this._init(a,g,f,h)}
function CLoaderResourcesPanel(a){var g,f,h,k,n,l,b,c;this._init=function(){h=[];k=[];c=new createjs.Container;c.visible=!1;a.addChild(c);l=new createjs.Shape;l.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n=l.on("mousedown",function(){});c.addChild(l);var d=new createjs.Text(TEXT_LOADING,"34px "+FONT_GAME,"#fff");d.textAlign="center";d.textBaseline="alphabetic";d.x=CANVAS_WIDTH/2;d.y=CANVAS_HEIGHT/2;c.addChild(d);d=s_oSpriteLibrary.getSprite("progress_loading");
b=createBitmap(d);b.regX=d.width/2;b.regY=d.height/2;b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2+130;c.addChild(b)};this.unload=function(){createjs.Tween.removeTweens(b);l.off("mousedown",n)};this.addEventListener=function(d,t,p){h[d]=t;k[d]=p};this.start=function(d){s_oSpriteLibrary.init(this._onImageLoaded,this._onAllImagesLoaded,this);for(var t=f=g=0;t<d.length;t++)s_oSpriteLibrary.addSprite(d[t].name,d[t].path)&&f++;0<f?(s_oSpriteLibrary.loadSprites(),(new createjs.Tween.get(b,{loop:-1})).to({rotation:360},
500),c.visible=!0):h[ON_END_LOADING]&&h[ON_END_LOADING].call(k[ON_END_LOADING])};this._onImageLoaded=function(){g++;g===f&&h[ON_END_LOADING]&&h[ON_END_LOADING].call(k[ON_END_LOADING])};this._onAllImagesLoaded=function(){};this._init()}
function clearLocalStorage(){s_iLastLevel=1;s_iTeamSelected=0;s_aTeamSeq=[];for(var a=0;a<NUM_TEAMS;a++)s_aTeamLoaded[a]=!1;if(s_bStorageAvailable)for(a=0;a<localStorage.length;){var g=localStorage.key(a);-1!==g.indexOf(LOCALSTORAGE_STRING)?localStorage.removeItem(g):a++}}function setLocalStorageLevel(a){if(s_bStorageAvailable){var g=getItem(LOCALSTORAGE_STRING+"level");if(null===g||g<a)s_iLastLevel=a,saveItem(LOCALSTORAGE_STRING+"level",s_iLastLevel)}}
function setLocalStorageScore(a,g){s_bStorageAvailable&&saveItem(LOCALSTORAGE_STRING+"score_level_"+g,a)}function setOpponentSeq(){s_bStorageAvailable&&saveItem(LOCALSTORAGE_STRING+"opponent_seq",JSON.stringify(s_aTeamSeq))}function setTeam(){saveItem(LOCALSTORAGE_STRING+"team",s_iTeamSelected)}function getLevelScore(a){return s_bStorageAvailable?(a=getItem(LOCALSTORAGE_STRING+"score_level_"+a))?a:0:0}
function getScoreTillLevel(a){if(!s_bStorageAvailable)return 0;for(var g=0,f=0;f<a-1;f++)g+=parseInt(getItem(LOCALSTORAGE_STRING+"score_level_"+(f+1)));return g}function getSavedLevel(){if(!s_bStorageAvailable)return 1;var a=getItem(LOCALSTORAGE_STRING+"level");return null===a?1:a}function getOpponentSeq(){return s_bStorageAvailable?JSON.parse(getItem(LOCALSTORAGE_STRING+"opponent_seq")):[]}function getStoredTeamSelected(){return s_bStorageAvailable?getItem(LOCALSTORAGE_STRING+"team"):0}
function CCountdownController(a,g,f){var h,k,n,l,b,c=this;this._init=function(d,t){n=[];l=[];b=new createjs.Container;b.visible=!1;b.x=d;b.y=t;f.addChild(b);k=[];for(var p=0;4>p;p++){var m=s_oSpriteLibrary.getSprite("countdown_"+(4-p-1)),w=createBitmap(m);w.regX=m.width/2;w.regY=m.height/2;b.addChild(w);k.push(w)}};this.addEventListener=function(d,t,p){n[d]=t;l[d]=p};this.reset=function(){for(var d=0;d<k.length;d++)k[d].scaleX=k[d].scaleY=.1,k[d].alpha=0};this.start=function(){h=0;b.visible=!0;this._playAnim()};
this._playAnim=function(){0<h&&createjs.Tween.get(k[h-1]).to({alpha:0},300,createjs.Ease.cubicOut);h===k.length?n[ON_END_COUNTDOWN]&&n[ON_END_COUNTDOWN].call(l[ON_END_COUNTDOWN]):(createjs.Tween.get(k[h]).to({alpha:1},300,createjs.Ease.cubicOut).call(function(){h===k.length-1?playSound("go",1,!1):playSound("countdown_"+(3-h),1,!1)}),createjs.Tween.get(k[h]).to({scaleX:1,scaleY:1},1E3,createjs.Ease.quartOut).call(function(){h++;c._playAnim()}))};this._init(a,g)};