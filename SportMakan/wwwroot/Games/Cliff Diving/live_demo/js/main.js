(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},c="undefined"!==typeof module&&module.exports,b="undefined"!==typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,d=function(){for(var b,d=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),
"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],c=0,f=d.length,e={};c<f;c++)if((b=d[c])&&b[1]in a){for(c=0;c<b.length;c++)e[d[0][c]]=
b[c];return e}return!1}(),e={change:d.fullscreenchange,error:d.fullscreenerror},f={request:function(h){var c=d.requestFullscreen;h=h||a.documentElement;if(/5\.1[.\d]* Safari/.test(navigator.userAgent))h[c]();else h[c](b&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){a[d.exitFullscreen]()},toggle:function(a){this.isFullscreen?this.exit():this.request(a)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(b,d){var c=e[b];c&&a.addEventListener(c,d,!1)},off:function(b,
d){var c=e[b];c&&a.removeEventListener(c,d,!1)},raw:d};d?(Object.defineProperties(f,{isFullscreen:{get:function(){return!!a[d.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[d.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!a[d.fullscreenEnabled]}}}),c?module.exports=f:window.screenfull=f):c?module.exports=!1:window.screenfull=!1})();var s_iScaleFactor=1,s_bIsIphone=!1,s_iOffsetX,s_iOffsetY;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function NotImplementedError(a){this.name="NotImplementedError";this.message=a||""}NotImplementedError.prototype=Error.prototype;function error(a){throw{name:"NotImplementedError",message:a};}function trace(a){console.log(a)}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){sizeHandler()}
function ifArrayContainsValue(a,c){for(var b=0;b<a.length;b++)if(a[b]===c)return!0;return!1}
function getSize(a){var c=a.toLowerCase(),b=window.document,d=b.documentElement;if(void 0===window["inner"+a])a=d["client"+a];else if(window["inner"+a]!=d["client"+a]){var e=b.createElement("body");e.id="vpw-test-b";e.style.cssText="overflow:scroll";var f=b.createElement("div");f.id="vpw-test-d";f.style.cssText="position:absolute;top:-1000px";f.innerHTML="<style>@media("+c+":"+d["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+c+":7px!important}}</style>";e.appendChild(f);d.insertBefore(e,b.head);
a=7==f["offset"+a]?d["client"+a]:window["inner"+a];d.removeChild(e)}else a=window["inner"+a];return a}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?getIOSWindowHeight():getSize("Height");var c=getSize("Width");_checkOrientation(c,a);var b=Math.min(a/CANVAS_HEIGHT,c/CANVAS_WIDTH),d=CANVAS_WIDTH*b;b*=CANVAS_HEIGHT;if(b<a){var e=a-b;b+=e;d+=CANVAS_WIDTH/CANVAS_HEIGHT*e}else d<c&&(e=c-d,d+=e,b+=CANVAS_HEIGHT/CANVAS_WIDTH*e);e=a/2-b/2;var f=c/2-d/2,h=CANVAS_WIDTH/d;if(f*h<-EDGEBOARD_X||e*h<-EDGEBOARD_Y)b=Math.min(a/(CANVAS_HEIGHT-2*
EDGEBOARD_Y),c/(CANVAS_WIDTH-2*EDGEBOARD_X)),d=CANVAS_WIDTH*b,b*=CANVAS_HEIGHT,e=(a-b)/2,f=(c-d)/2,h=CANVAS_WIDTH/d;s_iOffsetX=-1*f*h;s_iOffsetY=-1*e*h;0<=e&&(s_iOffsetY=0);0<=f&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oLevelSelection&&s_oLevelSelection.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);s_bIsIphone?(canvas=document.getElementById("canvas"),s_oStage.canvas.width=2*d,s_oStage.canvas.height=
2*b,canvas.style.width=d+"px",canvas.style.height=b+"px",s_iScaleFactor=2*Math.min(d/CANVAS_WIDTH,b/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor):s_bMobile||isChrome()?($("#canvas").css("width",d+"px"),$("#canvas").css("height",b+"px")):(s_oStage.canvas.width=d,s_oStage.canvas.height=b,s_iScaleFactor=Math.min(d/CANVAS_WIDTH,b/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>e?$("#canvas").css("top",e+"px"):$("#canvas").css("top","0px");$("#canvas").css("left",f+"px");
if(DEBUG_BOX2D){if(s_bMobile||isChrome())$("#debug").css("width",d+"px"),$("#debug").css("height",b+"px");0>e?$("#debug").css("top",e+"px"):$("#debug").css("top","0px");$("#debug").css("left",f+"px")}fullscreenHandler()}}
function _checkOrientation(a,c){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>c?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}function isIOS(){var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");for(-1!==navigator.userAgent.toLowerCase().indexOf("iphone")&&(s_bIsIphone=!0);a.length;)if(navigator.platform===a.pop())return!0;return s_bIsIphone=!1}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}
function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}function getMobileOperatingSystem(){var a=navigator.userAgent||navigator.vendor||window.opera;return a.match(/iPad/i)||a.match(/iPhone/i)||a.match(/iPod/i)?"ios":a.match(/Android/i)?"android":"unknown"}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}
function playSound(a,c,b){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(c),s_aSounds[a].loop(b),s_aSounds[a]):null}function setVolume(a,c){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(c)}function setMute(a,c){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[c].mute(a)}function soundPlaying(a){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)return s_aSounds[a].playing()}
function createBitmap(a,c,b){var d=new createjs.Bitmap(a),e=new createjs.Shape;c&&b?e.graphics.beginFill("#fff").drawRect(0,0,c,b):e.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);d.hitArea=e;return d}function createSprite(a,c,b,d,e,f){a=null!==c?new createjs.Sprite(a,c):new createjs.Sprite(a);c=new createjs.Shape;c.graphics.beginFill("#000000").drawRect(-b,-d,e,f);a.hitArea=c;return a}
function randomFloatBetween(a,c,b){"undefined"===typeof b&&(b=2);return parseFloat(Math.min(a+Math.random()*(c-a),c).toFixed(b))}function shuffle(a){for(var c=a.length,b,d;0!==c;)d=Math.floor(Math.random()*c),--c,b=a[c],a[c]=a[d],a[d]=b;return a}function easeLinear(a,c,b,d){return b*a/d+c}function easeOutCubic(a,c,b,d){return b*((a=a/d-1)*a*a+1)+c}function easeInQuad(a,c,b,d){return b*(a/=d)*a+c}function easeInSine(a,c,b,d){return-b*Math.cos(a/d*(Math.PI/2))+b+c}
function easeInCubic(a,c,b,d){return b*(a/=d)*a*a+c}function getTrajectoryPoint(a,c){var b=new createjs.Point,d=(1-a)*(1-a),e=a*a;b.x=d*c.start.x+2*(1-a)*a*c.traj.x+e*c.end.x;b.y=d*c.start.y+2*(1-a)*a*c.traj.y+e*c.end.y;return b}function formatTime(a){a/=1E3;var c=Math.floor(a/60);a=parseFloat(a-60*c).toFixed(0);var b="";b=10>c?b+("0"+c+":"):b+(c+":");return 10>a?b+("0"+a):b+a}function degreesToRadians(a){return a*Math.PI/180}
function collideEdgeWithCircle(a,c,b){if(null===a)return!1;a=closestPointOnLine(a.getPointA(),a.getPointB(),c);c=distanceV2(c,a);return b<c?null:{distance:c,closest_point:a}}function circleDistFromLineSeg(a,c,b){var d=b.p2.x-b.p1.x;var e=b.p2.y-b.p1.y;var f=a-b.p1.x;var h=c-b.p1.y;var k=(f*d+h*e)/(e*e+d*d);if(0<=k&&1>=k)return a=d*k+b.p1.x-a,c=e*k+b.p1.y-c,Math.sqrt(c*c+a*a);a-=b.p2.x;c-=b.p2.y;return Math.min(Math.sqrt(h*h+f*f),Math.sqrt(c*c+a*a))}
function getAngleBetweenPoints(a,c,b,d){return 180*Math.atan2(d-c,b-a)/Math.PI}function randomSign(){return.5>=Math.random()?1:-1}function distanceBetweenTwoPoints(a,c,b,d){a-=b;c-=d;return Math.sqrt(a*a+c*c)}function distance(a,c){var b=a.x-c.x,d=a.y-c.y;return Math.sqrt(b*b+d*d)}
function closestPointOnLine(a,c,b){var d=new CVector2;d.setV(b);d.subtractV(a);b=new CVector2;b.setV(c);b.subtractV(a);b.normalize();d=dotProductV2(b,d);if(0>=d)return a;if(d>=distanceV2(a,c))return c;b.scalarProduct(d);b.addV(a);return b}function checkRectCollision(a,c){var b=getBounds(a,.9);var d=getBounds(c,.98);return calculateIntersection(b,d)}
function calculateIntersection(a,c){var b,d,e,f;var h=a.x+(b=a.width/2);var k=a.y+(d=a.height/2);var l=c.x+(e=c.width/2);var m=c.y+(f=c.height/2);h=Math.abs(h-l)-(b+e);k=Math.abs(k-m)-(d+f);return 0>h&&0>k?(h=Math.min(Math.min(a.width,c.width),-h),k=Math.min(Math.min(a.height,c.height),-k),{x:Math.max(a.x,c.x),y:Math.max(a.y,c.y),width:h,height:k,rect1:a,rect2:c}):null}function centerBetweenPointsV2(a,c){var b=new CVector2;b.set(.5*(a.getX()+c.getX()),.5*(a.getY()+c.getY()));return b}
function dotProductV2(a,c){return a.getX()*c.getX()+a.getY()*c.getY()}function distanceV2WithoutSquareRoot(a,c){return(c.getX()-a.getX())*(c.getX()-a.getX())+(c.getY()-a.getY())*(c.getY()-a.getY())}function distanceV2(a,c){return Math.sqrt((c.getX()-a.getX())*(c.getX()-a.getX())+(c.getY()-a.getY())*(c.getY()-a.getY()))}function reflectVectorV2(a,c){var b=dotProductV2(a,c);a.set(a.getX()-2*b*c.getX(),a.getY()-2*b*c.getY());return a}
function getBounds(a,c){var b={x:Infinity,y:Infinity,width:0,height:0};if(a instanceof createjs.Container){b.x2=-Infinity;b.y2=-Infinity;var d=a.children,e=d.length,f;for(f=0;f<e;f++){var h=getBounds(d[f],1);h.x<b.x&&(b.x=h.x);h.y<b.y&&(b.y=h.y);h.x+h.width>b.x2&&(b.x2=h.x+h.width);h.y+h.height>b.y2&&(b.y2=h.y+h.height)}Infinity==b.x&&(b.x=0);Infinity==b.y&&(b.y=0);Infinity==b.x2&&(b.x2=0);Infinity==b.y2&&(b.y2=0);b.width=b.x2-b.x;b.height=b.y2-b.y;delete b.x2;delete b.y2}else{if(a instanceof createjs.Bitmap){e=
a.sourceRect||a.image;f=e.width*c;var k=e.height*c}else if(a instanceof createjs.Sprite)if(a.spriteSheet._frames&&a.spriteSheet._frames[a.currentFrame]&&a.spriteSheet._frames[a.currentFrame].image){e=a.spriteSheet.getFrame(a.currentFrame);f=e.rect.width;k=e.rect.height;d=e.regX;var l=e.regY}else b.x=a.x||0,b.y=a.y||0;else b.x=a.x||0,b.y=a.y||0;d=d||0;f=f||0;l=l||0;k=k||0;b.regX=d;b.regY=l;e=a.localToGlobal(0-d,0-l);h=a.localToGlobal(f-d,k-l);f=a.localToGlobal(f-d,0-l);d=a.localToGlobal(0-d,k-l);b.x=
Math.min(Math.min(Math.min(e.x,h.x),f.x),d.x);b.y=Math.min(Math.min(Math.min(e.y,h.y),f.y),d.y);b.width=Math.max(Math.max(Math.max(e.x,h.x),f.x),d.x)-b.x;b.height=Math.max(Math.max(Math.max(e.y,h.y),f.y),d.y)-b.y}return b}function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!0);a.dispatchEvent(c)}}};
(function(){function a(a){var b={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};a=a||window.event;a.type in b?document.body.className=b[a.type]:(document.body.className=this[c]?"hidden":"visible","hidden"===document.body.className?s_oMain.stopUpdate():s_oMain.startUpdate())}var c="hidden";c in document?document.addEventListener("visibilitychange",a):(c="mozHidden")in document?document.addEventListener("mozvisibilitychange",a):(c="webkitHidden")in
document?document.addEventListener("webkitvisibilitychange",a):(c="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}function toDegree(a){return 180/Math.PI*a}
function getParamValue(a){for(var c=window.location.search.substring(1).split("&"),b=0;b<c.length;b++){var d=c[b].split("=");if(d[0]==a)return d[1]}}function saveItem(a,c){s_bStorageAvailable&&localStorage.setItem(a,c)}function getItem(a){return s_bStorageAvailable?localStorage.getItem(a):null}function setItemJson(a,c){s_bStorageAvailable&&localStorage.setItem(a,JSON.stringify(c))}function getItemJson(a){return s_bStorageAvailable?JSON.parse(localStorage.getItem(a)):null}
function fullscreenHandler(){ENABLE_FULLSCREEN&&screenfull.enabled&&(s_bFullscreen=screen.height<window.innerHeight+3&&screen.height>window.innerHeight-3?!0:!1,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oLevelSelection&&s_oLevelSelection.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut())}
if(screenfull.enabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oLevelSelection&&s_oLevelSelection.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a,c,b,d,e,f;this.init=function(h,k,l){b=c=0;d=h;e=k;f=l;a={}};this.addSprite=function(b,d){a.hasOwnProperty(b)||(a[b]={szPath:d,oSprite:new Image},c++)};this.getSprite=function(b){return a.hasOwnProperty(b)?a[b].oSprite:null};this._onSpritesLoaded=function(){e.call(f)};this._onSpriteLoaded=function(){d.call(f);++b===c&&this._onSpritesLoaded()};this.loadSprites=function(){for(var b in a)a[b].oSprite.oSpriteLibrary=this,a[b].oSprite.onload=function(){this.oSpriteLibrary._onSpriteLoaded()},
a[b].oSprite.src=a[b].szPath};this.getNumSprites=function(){return c}}
var CANVAS_WIDTH=980,CANVAS_HEIGHT=1400,CANVAS_WIDTH_HALF=.5*CANVAS_WIDTH,CANVAS_HEIGHT_HALF=.5*CANVAS_HEIGHT,EDGEBOARD_X=100,EDGEBOARD_Y=100,FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,PRIMARY_FONT="comfortaa",PRIMARY_FONT_COLOUR="#ffffff",SECONDARY_FONT_COLOUR="#000000",FONT_SIZE_INTERFACE="36px ",FONT_SIZE_MENU_BEST_SCORE="36px ",FONT_SIZE_CREDITS="36px ",FONT_SIZE_HELP="32px ",FONT_SIZE_MSG_BOX="26px ",FONT_SIZE_ARE_YOU_SURE="36px ",FONT_SIZE_TITLES="60px ",FONT_SIZE_LEVEL_BUTTON="60px ",
FONT_SIZE_END_PANEL_TITLE="40px ",FONT_SIZE_END_PANEL_TEXT="36px ",FONT_SIZE_TEXT_MESSAGE="60px ",LEVELS_NUMBER=12,ALL_LEVELS_UNLOCKED=!1,COIN_SIZE=52,DIVE_VALUE,DIVE_VALUE_GOOD,DIVE_VALUE_PERFECT,PLANE_WAIT_TIME,PLANE_SPEED,MESSAGE_GAMEWIN_DELAY=2E3,MESSAGE_GAMEOVER_DELAY=500,TEXT_MESSAGES_SPEED=1500,RESET_STAGE_FADE_SPEED=2E3,TUTORIAL_FADEOUT_SPEED=3E3,COIN_SPEED=1E3,CAMERA_MOVEMENT_SPEED=200,CAMERA_CANVAS_OFFSET=500,CAMERA_CANVAS_MIN_Y=-20,CAMERA_CANVAS_MAX_Y=200,ENTRY_ANGLE_MIN,ENTRY_ANGLE_MAX,
FLOOR_Y_START=CANVAS_HEIGHT-70,DIVE_OFFSET_PERFECT,DIVE_OFFSET_GOOD,DIVE_OFFSET_POOR,FLIP_VALUE,NUM_ROWS_PAGE_LEVELS=5,NUM_COLS_PAGE_LEVELS=3,HEAD_STANDING=0,HEAD_PREPARATION=1,HEAD_DIVING=2,HEAD_HIT=3,TIMESTEP=1/60,VELOCITY_ITERATIONS=10,POSITION_ITERATIONS=10,UPDATE_LOOP_VAR=3,DEBUG_BOX2D=!1,DEBUG_BOX2D_ALPHA=.3,WORLD_SCALE=100,GRAVITY=4.5,PLAYER_RESET_TIMER=1E3,FIXTURE_HEAD=0,FIXTURE_RIGHTBOTTOMLEG=1,FIXTURE_LEFTBOTTOMLEG=2,FIXTURE_RIGHTTOPLEG=3,FIXTURE_LEFTTOPLEG=4,FIXTURE_RIGHTARM=5,FIXTURE_LEFTARM=
6,FIXTURE_TORSO=7,FIXTURE_WATER=8,FIXTURE_TRAMPOLINE=[9,10,11],FIXTURE_RIGHTFOOT=12,FIXTURE_LEFTFOOT=13,STATIC_BODY=0,KINEMATIC_BODY=1,DYNAMIC_BODY=2,CONTACT_BEGIN=0,CONTACT_END=1,CONTACT_PRESOLVE=2,CONTACT_POSTSOLVE=3,VERTICAL_FORCE_UP_PREPARATION=-50,HORIZONTAL_FORCE_PREPARATION=-40,HORIZONTAL_FORCE_PREPARATION_BACK=100,VERTICAL_FORCE_UP_JUMP=-100,VERTICAL_FORCE_RIGHT_JUMP=25,VERTICAL_FORCE_UP_TRAMPOLINE=-50,VERTICAL_FORCE_RIGHT_TRAMPOLINE=20,BODY_ROTATION_TORQUE=5,VERTICAL_FORCE_WATER=-50,ENABLE_FULLSCREEN,
ENABLE_CHECK_ORIENTATION,STATE_LOADING=0,STATE_MENU=1,STATE_HELP=2,STATE_GAME=3,STATE_LEVELSELECTION=4,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,LEVEL_TURNS=[1,2,3,4,5,6,7,8,9,10,11,12],BOTTOM_TRAMPOLINE_OFFSETS={x:120,y:-260},MIDDLE_TRAMPOLINE_OFFSETS={x:85,y:-250},TOP_TRAMPOLINE_OFFSETS={x:45,y:-250},INFOS_HEAD={type:DYNAMIC_BODY,x:-.07,y:-2.18,angle:0,radius:.2171392125802467,issensor:!1,category:1,maskbits:65535,userdata:FIXTURE_HEAD},INFOS_LEFTTOPLEG={type:DYNAMIC_BODY,x:-.07,
y:-.77,angle:0,issensor:!1,category:2,vertices:[{x:-.12376921880114142,y:-.3270568335524789},{x:.12376921880114142,y:-.3270568335524789},{x:.12376921880114142,y:.3270568335524789},{x:-.12376921880114142,y:.3270568335524789}],maskbits:65532,userdata:FIXTURE_LEFTTOPLEG},INFOS_LEFTBOTTOMLEG={type:DYNAMIC_BODY,x:-.04,y:-.24,angle:0,issensor:!1,category:2,vertices:[{x:-.09903755590449762,y:-.32783316377793414},{x:.09903755590449762,y:-.32783316377793414},{x:.09903755590449762,y:.32783316377793414},{x:-.09903755590449762,
y:.32783316377793414}],maskbits:65532,userdata:FIXTURE_LEFTBOTTOMLEG},INFOS_LEFTARM={type:DYNAMIC_BODY,x:.01,y:-1.42,angle:1.31966518272325,issensor:!1,category:2,vertices:[{x:-.5305662569396605,y:-.1317543296915377},{x:.5305662569396605,y:-.1317543296915377},{x:.5305662569396605,y:.1317543296915377},{x:-.5305662569396605,y:.1317543296915377}],maskbits:65532,userdata:FIXTURE_LEFTARM},INFOS_TORSO={type:DYNAMIC_BODY,x:-.07,y:-1.5,angle:0,issensor:!1,category:2,vertices:[{x:-.1866519670630118,y:-.5045037422279507},
{x:.1866519670630118,y:-.5045037422279507},{x:.1866519670630118,y:.5045037422279507},{x:-.1866519670630118,y:.5045037422279507}],maskbits:65535,userdata:FIXTURE_TORSO},INFOS_RIGHTARM={type:DYNAMIC_BODY,x:0,y:-1.39,angle:1.3755806810294156,issensor:!1,category:2,vertices:[{x:-.5305662569396605,y:-.1317543296915377},{x:.5305662569396605,y:-.1317543296915377},{x:.5305662569396605,y:.1317543296915377},{x:-.5305662569396605,y:.1317543296915377}],maskbits:65532,userdata:FIXTURE_RIGHTARM},INFOS_RIGHTTOPLEG=
{type:DYNAMIC_BODY,x:-.018,y:-.79,angle:-.04667548270906963,issensor:!1,category:2,vertices:[{x:-.12376921880114142,y:-.3270568335524789},{x:.12376921880114142,y:-.3270568335524789},{x:.12376921880114142,y:.3270568335524789},{x:-.12376921880114142,y:.3270568335524789}],maskbits:65532,userdata:FIXTURE_RIGHTTOPLEG},INFOS_RIGHTBOTTOMLEG={type:DYNAMIC_BODY,x:.013,y:-.24,angle:-.04667548270906963,issensor:!1,category:2,vertices:[{x:-.09903755590449762,y:-.32783316377793414},{x:.09903755590449762,y:-.32783316377793414},
{x:.09903755590449762,y:.32783316377793414},{x:-.09903755590449762,y:.32783316377793414}],maskbits:65532,userdata:FIXTURE_RIGHTBOTTOMLEG},INFOS_RIGHTFOOT={type:DYNAMIC_BODY,x:.154,y:.039,angle:0,issensor:!1,category:2,vertices:[{x:-.26,y:-.09},{x:.26,y:-.09},{x:.26,y:.09},{x:-.26,y:.09}],maskbits:65535,userdata:FIXTURE_RIGHTFOOT},INFOS_LEFTFOOT={type:DYNAMIC_BODY,x:.15,y:.078,angle:0,issensor:!1,category:2,vertices:[{x:-.26,y:-.09},{x:.26,y:-.09},{x:.26,y:.09},{x:-.26,y:.09}],maskbits:65535,userdata:FIXTURE_LEFTFOOT},
INFOS_LEFTSHOULDER={bodyAX:-.021818125126024324,bodyAY:-.2972569519582997,bodyBX:-.3901191380953495,bodyBY:.011428736567944492,angle:1.0877738585480112,enablelimit:!1,lowerangle:0,upperangle:0},INFOS_RIGHTSHOULDER={bodyAX:-.012262777094335764,bodyAY:-.32381192571155637,bodyBX:-.4213315726730712,bodyBY:.006350948887133168,angle:1.0877738585480112,enablelimit:!1,lowerangle:0,upperangle:0},INFOS_LEFTPELVIS={bodyAX:.0013814552390929435,bodyAY:.4456054190468741,bodyBX:.003710445915458216,bodyBY:-.2763816906264509,
angle:0,enablelimit:!0,lowerangle:-2,upperangle:1},INFOS_RIGHTPELVIS={bodyAX:.04524332569397238,bodyAY:.4357214958038327,bodyBX:.004657981352730797,bodyBY:-.2662812673311288,angle:-.04667548270906963,enablelimit:!0,lowerangle:-2,upperangle:1},INFOS_NECK={bodyAX:.004325268398964521,bodyAY:-.4903079895339122,bodyBX:-2.2180863584431165E-4,bodyBY:.19607883408639637,angle:0,enablelimit:!0,lowerangle:0,upperangle:0},INFOS_RIGHTKNEE={bodyAX:.010180229153708122,bodyAY:.28647357355402003,bodyBX:.004325268398964481,
bodyBY:-.2661703630132082,angle:0,enablelimit:!0,lowerangle:0,upperangle:10},INFOS_LEFTKNEE={bodyAX:.034710445915458354,bodyAY:.2521183093735484,bodyBX:.007388899793894232,bodyBY:-.2790365182196286,angle:0,enablelimit:!0,lowerangle:0,upperangle:10},INFOS_RIGHTANKLE={bodyAX:-.129,bodyAY:-.0225,bodyBX:.07138889979389407,bodyBY:.25996348178037326,angle:0,enablelimit:!0,lowerangle:0,upperangle:0},INFOS_LEFTANKLE={bodyAX:-.123,bodyAY:-.03999999999999996,bodyBX:-.0013868603683696058,bodyBY:.2811479523056318,
angle:0,enablelimit:!0,lowerangle:0,upperangle:0},INFOS_WATER={type:STATIC_BODY,x:4.910499999999998,y:13.510249999999996,angle:0,issensor:!0,category:4,vertices:[{x:-5.180547949355308,y:-1.5190772592254775},{x:5.180547949355308,y:-1.5190772592254775},{x:5.180547949355308,y:1.5190772592254775},{x:-5.180547949355308,y:1.5190772592254775}],maskbits:65535,userdata:FIXTURE_WATER},INFOS_TOPTRAMPOLINE={type:STATIC_BODY,x:[1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2],y:[2.03,2.03,2.33,2.78,2.78,2.78,
2.7,2.7,2.7,2.5,2.5,2.5],angle:0,issensor:!1,category:4,vertices:[{x:-.9019460970148836,y:-.17756877576113322},{x:.9019460970148836,y:-.17756877576113322},{x:.9019460970148836,y:.17756877576113322},{x:-.9019460970148836,y:.17756877576113322}],maskbits:65535,userdata:FIXTURE_TRAMPOLINE[0]},INFOS_MIDDLETRAMPOLINE={type:STATIC_BODY,x:[1,1,1,1,1,1,1.2,1.2,1.2,1,1,1],y:[5.09,6.09,6.09,6.29,6.29,6.29,5.99,5.99,5.99,5.69,5.69,5.69],angle:0,issensor:!1,category:4,vertices:[{x:-1.13525,y:-.22349999999999995},
{x:1.13525,y:-.22349999999999995},{x:1.13525,y:.22349999999999995},{x:-1.13525,y:.22349999999999995}],maskbits:65535,userdata:FIXTURE_TRAMPOLINE[1]},INFOS_BOTTOMTRAMPOLINE={type:STATIC_BODY,x:[1.52,1.52,1.52,1.52,1.52,1.52,1.6,1.6,1.6,1.22,1.22,1.22],y:[9.71,9.71,9.71,9.71,9.71,9.71,9,9,9,9,9,9],angle:0,issensor:!1,category:4,vertices:[{x:-1.5604995941607498,y:-.30722013591273073},{x:1.5604995941607498,y:-.30722013591273073},{x:1.5604995941607498,y:.30722013591273073},{x:-1.5604995941607498,y:.30722013591273073}],
maskbits:65535,userdata:FIXTURE_TRAMPOLINE[2]},HEAD_OFFSET={x:0,y:0},TORSO_OFFSET={x:INFOS_TORSO.x-INFOS_HEAD.x,y:INFOS_TORSO.y-INFOS_HEAD.y},LEFTBOTTOMLEG_OFFSET={x:INFOS_LEFTBOTTOMLEG.x-INFOS_HEAD.x,y:INFOS_LEFTBOTTOMLEG.y-INFOS_HEAD.y},LEFTTOPLEG_OFFSET={x:INFOS_LEFTTOPLEG.x-INFOS_HEAD.x,y:INFOS_LEFTTOPLEG.y-INFOS_HEAD.y},RIGHTBOTTOMLEG_OFFSET={x:INFOS_RIGHTBOTTOMLEG.x-INFOS_HEAD.x,y:INFOS_RIGHTBOTTOMLEG.y-INFOS_HEAD.y},RIGHTTOPLEG_OFFSET={x:INFOS_RIGHTTOPLEG.x-INFOS_HEAD.x,y:INFOS_RIGHTTOPLEG.y-
INFOS_HEAD.y},LEFTARM_OFFSET={x:INFOS_LEFTARM.x-INFOS_HEAD.x,y:INFOS_LEFTARM.y-INFOS_HEAD.y},RIGHTARM_OFFSET={x:INFOS_RIGHTARM.x-INFOS_HEAD.x,y:INFOS_RIGHTARM.y-INFOS_HEAD.y},LEFTFOOT_OFFSET={x:INFOS_LEFTFOOT.x-INFOS_HEAD.x,y:INFOS_LEFTFOOT.y-INFOS_HEAD.y},RIGHTFOOT_OFFSET={x:INFOS_RIGHTFOOT.x-INFOS_HEAD.x,y:INFOS_RIGHTFOOT.y-INFOS_HEAD.y},TEXT_HELP1="JUMP AND DIVE, ENTER THE WATER THE STRAIGHTEST YOU CAN",TEXT_HELP2="THE STRAIGHTEST THE ENTRANCE, THE HIGHEST THE SCORE!",TEXT_HELP_PREPARATION="HOLD CLICK TO PREPARE FOR JUMP",
TEXT_HELP_JUMP="RELEASE TO JUMP",TEXT_HELP_FLIP="HOLD CLICK TO START FLIP",TEXT_HELP_RELEASE="RELEASE BEFORE ENTERING THE WATER",TEXT_TUTORIAL1="HOLD CLICK TO PREPARE FOR JUMP. RELEASE TO JUMP AT THE DESIRED ANGLE",TEXT_TUTORIAL2="HOLD CLICK TO START FLIPPING, RELEASE BEFORE ENTERING THE WATER!",TEXT_SCORE="SCORE",TEXT_LEVEL="LEVEL",TEXT_TURN="TURN",TEXT_ENCOURAGEMENT0="GREAT!",TEXT_ENCOURAGEMENT1="POOR!",TEXT_ENCOURAGEMENT2="PERFECT!",TEXT_LEVELWIN="LEVEL COMPLETED!",TEXT_GAMEOVER_DIVE="BAD LANDING!\nTRY AGAIN?",
TEXT_GAMEOVER_RELEASE="CLICK NOT RELEASED!\nTRY AGAIN?",TEXT_GAMEOVER_ROTATION="NO FLIP!\nTRY AGAIN?",TEXT_GAMEOVER_HIT="YOU'VE BEEN HIT!\nTRY AGAIN?",TEXT_ARE_SURE="ARE YOU SURE YOU WANT TO EXIT? ALL UNSAVED PROGRESS WILL BE LOST",TEXT_TRY_AGAIN="TRY AGAIN!",TEXT_LEVELSELECT="SELECT LEVEL",TEXT_FLIP="FLIP!",TEXT_PRELOADER_CONTINUE="START",TEXT_CREDITS_DEVELOPED="DEVELOPED BY",TEXT_ERR_LS="YOUR WEB BROWSER DOES NOT SUPPORT STORING SETTING LOCALLY. IN SAFARI, THE MOST COMMON CAUSE OF THIS IS USING 'PRIVATE BROWSING MODE'. SOME INFO MAY NOT SAVE OR SOME FEATURE MAY NOT WORK PROPERLY.",
TEXT_SHARE_IMAGE="200x200.jpg",TEXT_SHARE_TITLE="Congratulations!",TEXT_SHARE_MSG1="You collected <strong>",TEXT_SHARE_MSG2=" points</strong>!<br><br>Share your score with your friends!",TEXT_SHARE_SHARE1="My score is ",TEXT_SHARE_SHARE2=" points! Can you do better";
function CPreloader(){var a,c,b,d,e,f,h,k,l,m;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();m=new createjs.Container;s_oStage.addChild(m)};this.unload=function(){l.unload();l=null;m.removeAllChildren()};this._onImagesLoaded=
function(){};this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var p=new createjs.Shape;p.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);m.addChild(p);p=s_oSpriteLibrary.getSprite("200x200");h=createBitmap(p);h.regX=.5*p.width;h.regY=.5*p.height;h.x=CANVAS_WIDTH_HALF;h.y=CANVAS_HEIGHT_HALF-180;m.addChild(h);k=new createjs.Shape;k.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(h.x-100,h.y-100,200,200,10);m.addChild(k);
h.mask=k;p=s_oSpriteLibrary.getSprite("progress_bar");d=createBitmap(p);d.x=CANVAS_WIDTH_HALF-p.width/2;d.y=CANVAS_HEIGHT_HALF+50;m.addChild(d);a=p.width;c=p.height;e=new createjs.Shape;e.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(d.x,d.y,1,c);m.addChild(e);d.mask=e;b=new createjs.Text("","30px "+PRIMARY_FONT,PRIMARY_FONT_COLOUR);b.x=CANVAS_WIDTH_HALF;b.y=CANVAS_HEIGHT_HALF+100;b.textBaseline="alphabetic";b.textAlign="center";m.addChild(b);p=s_oSpriteLibrary.getSprite("but_start");l=CTextButton(CANVAS_WIDTH_HALF,
CANVAS_HEIGHT_HALF,p,TEXT_PRELOADER_CONTINUE,"Arial","#000","bold 50",m);l.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);l.setVisible(!1);f=new createjs.Shape;f.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);m.addChild(f);createjs.Tween.get(f).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(f);m.removeChild(f)})};this._onButStartRelease=function(){s_oMain._onRemovePreloader()};this.refreshLoader=function(h){b.text=h+"%";100===h&&(l.setVisible(!0),b.visible=
!1,d.visible=!1);e.graphics.clear();h=Math.floor(h*a/100);e.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(d.x,d.y,h,c)};this._init()}
function CMain(a){var c,b=0,d=0,e=STATE_LOADING,f,h,k;this.initContainer=function(){s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage);s_bMobile=jQuery.browser.mobile;!1===s_bMobile&&(s_oStage.enableMouseOver(20),$("body").on("contextmenu","#canvas",function(a){return!1}));s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.framerate=FPS;navigator.userAgent.match(/Windows Phone/i)&&
(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;f=new CPreloader};this.preloaderReady=function(){this._loadImages();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();c=!0};this.soundLoaded=function(){b++;f.refreshLoader(Math.floor(b/d*100))};this._initSounds=function(){var a=[];a.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});a.push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"});a.push({path:"./sounds/",filename:"collision",
loop:!1,volume:1,ingamename:"collision"});a.push({path:"./sounds/",filename:"bonus",loop:!1,volume:1,ingamename:"bonus"});a.push({path:"./sounds/",filename:"coin",loop:!1,volume:1,ingamename:"coin"});a.push({path:"./sounds/",filename:"water",loop:!1,volume:1,ingamename:"water"});a.push({path:"./sounds/",filename:"game_over",loop:!1,volume:1,ingamename:"game_over"});a.push({path:"./sounds/",filename:"game_win",loop:!1,volume:1,ingamename:"game_win"});a.push({path:"./sounds/",filename:"jump",loop:!1,
volume:1,ingamename:"jump"});d+=a.length;s_aSounds=[];for(var b=0;b<a.length;b++)s_aSounds[a[b].ingamename]=new Howl({src:[a[b].path+a[b].filename+".mp3",a[b].path+a[b].filename+".ogg"],autoplay:!1,preload:!0,loop:a[b].loop,volume:a[b].volume,onload:s_oMain.soundLoaded})};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);for(var a=0;4>a;a++)s_oSpriteLibrary.addSprite("bg_game"+a,"./sprites/bg_game"+a+".jpg"),s_oSpriteLibrary.addSprite("rock_"+a,"./sprites/rock_"+
a+".png"),s_oSpriteLibrary.addSprite("but_level"+a,"./sprites/but_level"+a+".png"),s_oSpriteLibrary.addSprite("trampoline"+a,"./sprites/trampoline"+a+".png");for(a=0;3>a;a++)s_oSpriteLibrary.addSprite("player"+a+"_head","./sprites/player"+a+"/head.png"),s_oSpriteLibrary.addSprite("player"+a+"_leftarm","./sprites/player"+a+"/leftarm.png"),s_oSpriteLibrary.addSprite("player"+a+"_leftbottomleg","./sprites/player"+a+"/leftbottomleg.png"),s_oSpriteLibrary.addSprite("player"+a+"_lefttopleg","./sprites/player"+
a+"/lefttopleg.png"),s_oSpriteLibrary.addSprite("player"+a+"_rightarm","./sprites/player"+a+"/rightarm.png"),s_oSpriteLibrary.addSprite("player"+a+"_rightbottomleg","./sprites/player"+a+"/rightbottomleg.png"),s_oSpriteLibrary.addSprite("player"+a+"_righttopleg","./sprites/player"+a+"/righttopleg.png"),s_oSpriteLibrary.addSprite("player"+a+"_torso","./sprites/player"+a+"/torso.png"),s_oSpriteLibrary.addSprite("watersplash"+a,"./sprites/watersplash"+a+".png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");
s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png");s_oSpriteLibrary.addSprite("but_next","./sprites/but_next.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("msg_box_small","./sprites/msg_box_small.png");s_oSpriteLibrary.addSprite("msg_box_big",
"./sprites/msg_box_big.png");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png");s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("bg","./sprites/bg.jpg");s_oSpriteLibrary.addSprite("collision","./sprites/collision.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("logo_menu",
"./sprites/logo_menu.png");s_oSpriteLibrary.addSprite("menu_diver","./sprites/menu_diver.png");s_oSpriteLibrary.addSprite("plane","./sprites/plane.png");s_oSpriteLibrary.addSprite("coin","./sprites/coin.png");s_oSpriteLibrary.addSprite("arrow","./sprites/arrow.png");s_oSpriteLibrary.addSprite("star","./sprites/star.png");s_oSpriteLibrary.addSprite("starbox","./sprites/starbox.png");s_oSpriteLibrary.addSprite("help_preparation","./sprites/help_preparation.png");s_oSpriteLibrary.addSprite("help_jump",
"./sprites/help_jump.png");s_oSpriteLibrary.addSprite("help_flip","./sprites/help_flip.png");s_oSpriteLibrary.addSprite("help_release","./sprites/help_release.png");s_oSpriteLibrary.addSprite("help_dive_best","./sprites/help_dive_best.png");s_oSpriteLibrary.addSprite("help_dive_good","./sprites/help_dive_good.png");s_oSpriteLibrary.addSprite("help_dive_poor","./sprites/help_dive_poor.png");s_oSpriteLibrary.addSprite("help_hand","./sprites/help_hand.png");d+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};
this._onImagesLoaded=function(){b++;f.refreshLoader(Math.floor(b/d*100))};this._onAllImagesLoaded=function(){};this.onAllPreloaderImagesLoaded=function(){this._loadImages()};this._onRemovePreloader=function(){try{saveItem("ls_available","ok")}catch(m){s_bStorageAvailable=!1}f.unload();isIOS()||(s_oSoundtrack=playSound("soundtrack",1,!0));this.gotoMenu()};this.gotoMenu=function(){h=new CMenu;e=STATE_MENU};this.gotoGame=function(){$("#canvas").trigger("start_session");k=new CGame(l);e=STATE_GAME};this.gotoLevelSelection=
function(a){new CLevel(a);e=STATE_LEVELSELECTION};this.gotoHelp=function(){new CHelp;e=STATE_HELP};this.stopUpdate=function(){c=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");s_bAudioActive&&Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();c=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");s_bAudioActive&&Howler.mute(!1)};this._update=function(a){if(!1!==c){var b=(new Date).getTime();s_iTimeElaps=b-s_iPrevTime;s_iCntTime+=s_iTimeElaps;
s_iCntFps++;s_iPrevTime=b;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);e===STATE_MENU&&h.update();e===STATE_GAME&&k.update();s_oStage.update(a)}};s_oMain=this;var l=a;ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;this.initContainer()}
var s_bMobile,s_bAudioActive=!0,s_bFullscreen=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oStage,s_oMain,s_oSpriteLibrary,s_oSoundTrack=null,s_oCanvas,s_iTotalScore=0,s_oPhysicsController,s_bStorageAvailable=!0,s_bFirstTimePlaying,s_iLevel=0,s_iLastLevel=0,s_aStars;
function CMenu(){var a,c,b,d,e,f,h,k,l,m,p,g,t,q=null,v=null,u,w,r,x;this._init=function(){h=new createjs.Container;s_oStage.addChild(h);x=Math.floor(2*Math.random())+0;0!==x&&(x=3);var n=createBitmap(s_oSpriteLibrary.getSprite("bg_game"+x)),r=createBitmap(s_oSpriteLibrary.getSprite("rock_"+x));r.x=-70;h.addChild(n,r);this.startDiveAnimation();s_bFirstTimePlaying=!0;n=s_oSpriteLibrary.getSprite("logo_menu");k=createBitmap(n);k.regX=n.width/2;k.regY=n.height/2;k.x=CANVAS_WIDTH/2;k.y=-250;h.addChild(k);
u=new createjs.Text(TEXT_SCORE+": 0",FONT_SIZE_MENU_BEST_SCORE+PRIMARY_FONT,SECONDARY_FONT_COLOUR);u.textAlign="center";u.textBaseline="alphabetic";u.x=CANVAS_WIDTH_HALF;u.y=CANVAS_HEIGHT_HALF+150;u.lineWidth=450;u.visible=!1;u.outline=5;h.addChild(u);w=new createjs.Text(TEXT_SCORE+": 0",FONT_SIZE_MENU_BEST_SCORE+PRIMARY_FONT,PRIMARY_FONT_COLOUR);w.textAlign="center";w.textBaseline="alphabetic";w.x=CANVAS_WIDTH_HALF;w.y=CANVAS_HEIGHT_HALF+150;w.lineWidth=450;w.visible=!1;h.addChild(w);n=s_oSpriteLibrary.getSprite("but_play");
l=new CGfxButton(CANVAS_WIDTH_HALF,CANVAS_HEIGHT+200,n,h);l.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this);n=s_oSpriteLibrary.getSprite("but_credits");b=20+n.width/2;d=n.height/2+10;g=new CGfxButton(b,d,n,h);g.addEventListener(ON_MOUSE_UP,this._onCredits,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)n=s_oSpriteLibrary.getSprite("audio_icon"),e=CANVAS_WIDTH-n.width/4-20,f=n.height/2+10,p=new CToggle(e,f,n,s_bAudioActive,h),p.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);n=
window.document;r=n.documentElement;q=r.requestFullscreen||r.mozRequestFullScreen||r.webkitRequestFullScreen||r.msRequestFullscreen;v=n.exitFullscreen||n.mozCancelFullScreen||n.webkitExitFullscreen||n.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(q=!1);q&&screenfull.enabled&&(n=s_oSpriteLibrary.getSprite("but_fullscreen"),a=b+n.width/2+10,c=d,t=new CToggle(a,c,n,s_bFullscreen,h),t.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,
0,CANVAS_WIDTH,CANVAS_HEIGHT);h.addChild(m);createjs.Tween.get(m).to({alpha:0},1E3).call(function(){h.removeChild(m)});if(s_bStorageAvailable){n=getItem("cliff_diving_total_score");null!==n&&void 0!==n?(s_iTotalScore=Number(n),u.visible=w.visible=!0,u.text=w.text=TEXT_SCORE+": "+s_iTotalScore):(u.visible=w.visible=!1,s_iTotalScore=0);n=getItem("cliff_diving_last_level");null!==n&void 0!==n&&(s_iLastLevel=Number(n));if(void 0===s_aStars||null===s_aStars)for(s_aStars=[],n=0;n<LEVELS_NUMBER;n++)s_aStars.push(0);
n=getItemJson("cliff_diving_stars");null!==n&&void 0!==s_aStars&&(s_aStars=n)}else new CMsgBox(TEXT_ERR_LS,h);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.startDiveAnimation=function(){var a=s_oSpriteLibrary.getSprite("menu_diver");r=createBitmap(a);r.regX=.5*a.width;r.regY=.5*a.height;r.x=CANVAS_WIDTH_HALF;r.y=-300;h.addChild(r);a=new createjs.Shape;a.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,CANVAS_WIDTH,1E3);h.addChild(a);r.mask=a;var b=CANVAS_HEIGHT-300;createjs.Tween.get(r,{loop:!1}).to({y:b-
100},1E3,createjs.Ease.linear).call(function(){s_oMenu.onDiveEnd(b)})};this.onDiveEnd=function(a){createjs.Tween.get(r,{loop:!1}).to({y:a+100},100,createjs.Ease.linear);!1===soundPlaying("water")&&playSound("water",1,!1);var b={images:[s_oSpriteLibrary.getSprite("watersplash0")],framerate:10,frames:{width:384,height:384,regX:0,regY:0},animations:{idle:[0,9,!1]}};b=new createjs.SpriteSheet(b);b=createSprite(b,"idle",0,0,384,384);b.regX=192;b.regY=434;b.x=CANVAS_WIDTH_HALF;b.y=a;h.addChild(b);h.addChild(k,
l.getSprite());createjs.Tween.get(b,{loop:!1}).to({alpha:0},2E3,createjs.Ease.cubicOut);createjs.Tween.get(k,{loop:!1}).to({y:CANVAS_HEIGHT_HALF-150},1E3,createjs.Ease.cubicOut);createjs.Tween.get(l.getSprite(),{loop:!1}).to({y:CANVAS_HEIGHT_HALF+350},1E3,createjs.Ease.cubicOut)};this.unload=function(){l.unload();l=null;g.unload();h.removeAllChildren();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)p.unload(),p=null;q&&screenfull.enabled&&t.unload();s_oMenu=null};this.refreshButtonPos=function(h,k){!1!==
DISABLE_SOUND_MOBILE&&!1!==s_bMobile||p.setPosition(e-h,f+k);q&&screenfull.enabled&&t.setPosition(a+h,c+k);g.setPosition(b+h,d+k)};this.resetFullscreenBut=function(){q&&screenfull.enabled&&t.setActive(s_bFullscreen)};this.exitFromCredits=function(){};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onCredits=function(){new CCreditsPanel};this._onButPlayRelease=function(){this.unload();s_oMain.gotoLevelSelection(x)};this._onFullscreenRelease=function(){s_bFullscreen?
v.call(window.document):q.call(window.document.documentElement);sizeHandler()};this.update=function(){};s_oMenu=this;this._init()}var s_oMenu=null;
function CLevel(a){var c,b,d,e,f,h,k,l,m,p,g,t,q,v,u,w=null,r=null,x,n,y,B,C=null,E=null;this._init=function(){var g=new createjs.Shape;g.graphics.beginFill("#000000").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.alpha=.7;m=0;y=new createjs.Container;s_oStage.addChild(y);0!==a&&(a=3);var A=createBitmap(s_oSpriteLibrary.getSprite("bg_game"+a)),J=createBitmap(s_oSpriteLibrary.getSprite("rock_"+a));y.addChild(A,J);y.addChild(g);k=CANVAS_WIDTH_HALF;l=CANVAS_HEIGHT_HALF-470;x=new createjs.Text(TEXT_LEVELSELECT,
FONT_SIZE_TITLES+PRIMARY_FONT,SECONDARY_FONT_COLOUR);x.x=k;x.y=l;x.textAlign="center";x.outline=5;s_oStage.addChild(x);n=new createjs.Text(TEXT_LEVELSELECT,FONT_SIZE_TITLES+PRIMARY_FONT,PRIMARY_FONT_COLOUR);n.x=k;n.y=l;n.textAlign="center";s_oStage.addChild(n);g=s_oSpriteLibrary.getSprite("but_exit");p=g.height;f=CANVAS_WIDTH-g.width/2-20;h=g.height/2+10;v=new CGfxButton(f,h,g,y);v.addEventListener(ON_MOUSE_UP,this._onExit,this);!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(A=s_oSpriteLibrary.getSprite("audio_icon"),
d=f-g.width/2-A.width/4-10,e=h,u=new CToggle(d,e,A,s_bAudioActive,y),u.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),c=d-g.width/2-A.width/4-10,b=A.height/2+10):(c=f-g.width-10,b=h);g=window.document;A=g.documentElement;C=A.requestFullscreen||A.mozRequestFullScreen||A.webkitRequestFullScreen||A.msRequestFullscreen;E=g.exitFullscreen||g.mozCancelFullScreen||g.webkitExitFullscreen||g.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(C=!1);C&&screenfull.enabled&&(A=s_oSpriteLibrary.getSprite("but_fullscreen"),
B=new CToggle(c,b,A,s_bFullscreen,y),B.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));this.refreshButtonPos(s_iOffsetX,s_iOffsetY);this._checkBoundLimits();t=[];g=Math.floor((CANVAS_WIDTH-2*EDGEBOARD_X)/NUM_COLS_PAGE_LEVELS)/2-30;for(J=A=0;J<NUM_COLS_PAGE_LEVELS;J++)t.push(A),A+=2*g;q=[];this._createNewPage(0,LEVELS_NUMBER);if(1<q.length){for(g=1;g<q.length;g++)q[g].visible=!1;w=new CGfxButton(CANVAS_WIDTH_HALF+450,CANVAS_HEIGHT_HALF,s_oSpriteLibrary.getSprite("arrow_select_level"),
s_oStage);w.getButtonImage().rotation=90;w.addEventListener(ON_MOUSE_UP,this._onRight,this);r=new CGfxButton(CANVAS_WIDTH_HALF-450,CANVAS_HEIGHT_HALF,s_oSpriteLibrary.getSprite("arrow_select_level"),s_oStage);r.getButtonImage().rotation=-90;r.addEventListener(ON_MOUSE_UP,this._onLeft,this)}var H=new createjs.Shape;H.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(H);createjs.Tween.get(H).to({alpha:0},1E3).call(function(){H.visible=!1})};this.unload=function(){for(var a=
0;a<g.length;a++)g[a].unload();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||u.unload();C&&screenfull.enabled&&B.unload();v.unload();null!==r&&(r.unload(),w.unload());s_oStage.removeAllChildren();s_oLevelSelection=null};this.refreshButtonPos=function(a,k){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||u.setPosition(d-a,e+k);C&&screenfull.enabled&&B.setPosition(c-a,b+k);v.setPosition(f-a,h+k)};this._checkBoundLimits=function(){for(var a=this.getButLevelSprite(),b=0,d=CANVAS_HEIGHT-2*EDGEBOARD_Y-2*p,c=0;b<
d;)b+=a.height+20,c++;NUM_ROWS_PAGE_LEVELS>c&&(NUM_ROWS_PAGE_LEVELS=c);d=b=0;c=CANVAS_WIDTH-2*EDGEBOARD_X;for(a=this.getButLevelSprite();d<c;)d+=a.width/2+5,b++;NUM_COLS_PAGE_LEVELS>b&&(NUM_COLS_PAGE_LEVELS=b)};this.getButLevelSprite=function(a){return 3>a?s_oSpriteLibrary.getSprite("but_level0"):2<a&&6>a?s_oSpriteLibrary.getSprite("but_level1"):5<a&&9>a?s_oSpriteLibrary.getSprite("but_level2"):s_oSpriteLibrary.getSprite("but_level3")};this._createNewPage=function(a,b){var d=new createjs.Container;
y.addChild(d);q.push(d);g=[];for(var c=0,h=0,f=1,k=!1,e=a;e<b;e++){var p=this.getButLevelSprite(e),l=!0;!ALL_LEVELS_UNLOCKED&&s_iLastLevel<e&&(l=!1);l=new CLevelBut(t[c]+p.width/4,h+p.height/2+30,e,p,l,d);l.addEventListenerWithParams(ON_MOUSE_UP,this.onButLevelRelease,this,e);g.push(l);c++;if(c===t.length&&e<b-1&&(c=0,h+=p.height+50,f++,f>NUM_ROWS_PAGE_LEVELS)){k=!0;break}}d.x=CANVAS_WIDTH_HALF;d.y=CANVAS_HEIGHT_HALF;d.regX=d.getBounds().width/2;d.regY=d.getBounds().height/2;k&&this._createNewPage(e+
1,b)};this._onRight=function(){q[m].visible=!1;m++;m>=q.length&&(m=0);q[m].visible=!0};this._onLeft=function(){q[m].visible=!1;m--;0>m&&(m=q.length-1);q[m].visible=!0};this.onButLevelRelease=function(a){g[a].setActive(0,!0);s_iLevel=a;this.unload();s_oMain.gotoGame()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onFullscreenRelease=function(){s_bFullscreen?E.call(window.document):C.call(window.document.documentElement);sizeHandler()};this.resetFullscreenBut=
function(){C&&screenfull.enabled&&B.setActive(s_bFullscreen)};this._onExit=function(){this.unload();s_oMain.gotoMenu()};s_oLevelSelection=this;this._init()}var s_oLevelSelection=null;
function CLevelBut(a,c,b,d,e,f){var h,k,l,m=[],p=[],g,t,q,v,u;this._init=function(a,b,d,c,f){k=[];l=[];q=new createjs.Container;w.addChild(q);var e=new createjs.SpriteSheet({images:[c],frames:{width:c.width/2,height:c.height,regX:c.width/2/2,regY:c.height/2},animations:{state_true:[0],state_false:[1]}});h=f;t=createSprite(e,"state_"+h,c.width/2/2,c.height/2,c.width/2,c.height);t.mouseEnabled=f;t.x=a;t.y=b;t.stop();!s_bMobile&&h&&(q.cursor="pointer");q.addChild(t);m.push(t);c=new createjs.Text(d+1,
FONT_SIZE_LEVEL_BUTTON+PRIMARY_FONT,SECONDARY_FONT_COLOUR);c.textAlign="center";c.x=t.x;c.y=t.y-40;c.outline=5;q.addChild(c);f=new createjs.Text(d+1,FONT_SIZE_LEVEL_BUTTON+PRIMARY_FONT,PRIMARY_FONT_COLOUR);f.textAlign=c.textAlign;f.x=c.x;f.y=c.y;q.addChild(f);g=[];for(f=0;3>f;f++)c=s_aStars[d]&&s_aStars[d]>f?s_oSpriteLibrary.getSprite("star"):s_oSpriteLibrary.getSprite("starbox"),g.push(createBitmap(c,c.width,c.height)),g[f].regX=.5*c.width,g[f].regY=.5*c.height,g[f].scaleX=1,g[f].scaleY=g[f].scaleX,
q.addChild(g[f]);g[0].x=a-50;g[0].y=b-50;g[1].x=a;g[1].y=b-65;g[2].x=a+50;g[2].y=b-50;this._initListener()};this.unload=function(){q.off("mousedown",v);q.off("pressup",u);q.removeChild(t)};this._initListener=function(){v=q.on("mousedown",this.buttonDown);u=q.on("pressup",this.buttonRelease)};this.viewBut=function(a){q.addChild(a)};this.addEventListener=function(a,b,c){k[a]=b;l[a]=c};this.addEventListenerWithParams=function(a,b,c,d){k[a]=b;l[a]=c;p=d};this.ifClickable=function(){return!0===q.mouseEnabled?
1:0};this.setActive=function(a,b){h=b;m[a].gotoAndStop("state_"+h);m[a].mouseEnabled=!0};this.buttonRelease=function(){h&&(s_oLevelSelection.onButLevelRelease(b),playSound("click",1,0),k[ON_MOUSE_UP]&&k[ON_MOUSE_UP].call(l[ON_MOUSE_UP],p))};this.buttonDown=function(){if(h){t.scaleX=t.scaleY=.9;for(var a=0;a<g.length;a++)g[a].scaleX=g[a].scaleY=.8}k[ON_MOUSE_DOWN]&&k[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN],p)};this.setPosition=function(a,b){q.x=a;q.y=b};this.setVisible=function(a){q.visible=a};var w=
f;this._init(a,c,b,d,e,f)}
function CGame(a){var c,b,d,e,f,h,k,l,m,p,g,t,q,v,u,w,r,x,n,y,B,C,E,G,A,J,H,F,D,z,L,I,O,R,S,N,P,Q,M,K,T;this._init=function(){z=new createjs.Container;s_oStage.addChild(z);r=3>s_iLevel?0:2<s_iLevel&&6>s_iLevel?1:5<s_iLevel&&9>s_iLevel?2:3;var a=s_oSpriteLibrary.getSprite("bg_game"+r);E=createBitmap(a);z.addChild(E);this._initPlane();F=new createjs.Container;s_oStage.addChild(F);D=new createjs.Container;F.addChild(D);a=s_oSpriteLibrary.getSprite("rock_"+r);J=createBitmap(a);J.x=-60;J.y=20;D.addChild(J);
L=new createjs.Container;F.addChild(L);C=[];this._addTrampolines();this._resetVariables();this._initNewGame();this._initPlayer();B=[];B=H.addTrampolinePhysics();H.addFloor(D);this._updateCamera();this._initHitArea();O=new CInterface(L);O.refreshTurnText(u+1);!0===s_bFirstTimePlaying?CHelpPanel():(this.initNewLevelText(),this._onExitHelp())};this._initPlane=function(){var a={images:[s_oSpriteLibrary.getSprite("plane")],framerate:20,frames:{width:443,height:108,regX:0,regY:0},animations:{idle:[0,6,
"idle"]}};a=new createjs.SpriteSheet(a);A=createSprite(a,"idle",0,0,443,108);A.regX=221.5;A.regY=54;A.x=CANVAS_WIDTH+250;A.y=CANVAS_HEIGHT_HALF-400;z.addChild(A);this._initPlaneTween()};this._initPlaneTween=function(){createjs.Tween.get(A).wait(PLANE_WAIT_TIME).to({x:-500},PLANE_SPEED).call(this._onPlaneTweenEnd)};this._onPlaneTweenEnd=function(){b&&(A.x=CANVAS_WIDTH+250,s_oGame._initPlaneTween())};this._addTrampolines=function(){var a=this._addTrampolineSprite(.55,INFOS_TOPTRAMPOLINE);C.push(a);
a=this._addTrampolineSprite(.7,INFOS_MIDDLETRAMPOLINE);C.push(a);a=this._addTrampolineSprite(1,INFOS_BOTTOMTRAMPOLINE);C.push(a)};this._addTrampolineSprite=function(a,b){var c=s_oSpriteLibrary.getSprite("trampoline"+r),d=createBitmap(c);d.scaleX=d.scaleY=a;d.regX=.5*c.width-10;d.regY=.5*c.height-5;d.x=b.x[s_iLevel]*WORLD_SCALE;d.y=b.y[s_iLevel]*WORLD_SCALE;D.addChild(d);return d};this._initHitArea=function(){var a=this;y=[];N=new createjs.Shape;N.graphics.beginFill("green").drawRect(0,250,CANVAS_WIDTH,
CANVAS_HEIGHT);N.alpha=.01;y[0]=N.on("mousedown",function(b){a.onPressed(b)});y[1]=N.on("pressmove",function(b){a.onPressMove(b)});y[2]=N.on("pressup",this.onReleased);F.addChild(N)};this._initNewGame=function(){s_oPhysicsController=new CPhysicsController;H=new CPhysicObjectsCreator(s_oPhysicsController.getWorld());new CPhysicWorld(H,F);this._updatePhysics()};this._initPlayer=function(){I=H.addPlayer(D);I.update();var a=new createjs.Shape;a.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,-200,CANVAS_WIDTH,
1350);F.addChild(a);for(var b=I.getSpriteArray(),c=0;c<b.length;c++)b[c].mask=a};this._resetVariables=function(){M=S=R=null;this._resetStageVariables();b=!1;v=q=w=u=0;t=s_iTotalScore;x=n=0;setVolume("soundtrack",.5)};this._resetStageVariables=function(){p=f=h=l=k=m=e=d=!1};this.startShake=function(){G&&!0===G.isActive()||(G=new CShake(s_oStage,500,5,20))};this._resetStage=function(){var a=new createjs.Shape;a.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);F.addChild(a);for(var b=
0;b<B.length;b++)s_oPhysicsController.destroyBodyVector(B[b]),B[b]=null;s_oPhysicsController.update();B=[];B=H.addTrampolinePhysics();H.addFloor(D);2<w&&(w=0);I.resetPosition(w);this._resetStageVariables();O.refreshTurnText(u+1);createjs.Tween.get(a).to({alpha:0},RESET_STAGE_FADE_SPEED,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(a);F.removeChild(a)})};this.unload=function(){N.off("mousedown",y[0]);N.off("pressmove",y[1]);N.off("pressup",y[2]);y=[];b=!1;O.unload();this.destroyPhysicsEngine();
createjs.Tween.removeAllTweens();z.removeAllChildren();L.removeAllChildren();D.removeAllChildren();F.removeAllChildren();s_oStage.removeAllChildren();s_oGame=null};this.destroyPhysicsEngine=function(){s_oPhysicsController.destroyWorld();I.unload();s_oPhysicsController=H=I=null};this.onExit=function(){setVolume("soundtrack",1);$("#canvas").trigger("end_session");$("#canvas").trigger("show_interlevel_ad");this.unload();s_oMain.gotoMenu()};this.restart=function(){setVolume("soundtrack",.5);$("#canvas").trigger("restart_level");
this.unload();s_oMain.gotoGame()};this._onExitHelp=function(){b=!0;0===s_iLevel&&(g=!0);s_bFirstTimePlaying=!1};this._updateScore=function(){s_iTotalScore=t+=v;saveItem("cliff_diving_total_score",s_iTotalScore);x=Math.round(n/LEVEL_TURNS[s_iLevel]);x>s_aStars[s_iLevel]&&(s_aStars[s_iLevel]=x,setItemJson("cliff_diving_stars",s_aStars))};this.setCoinStart=function(a){T=a};this.addCoin=function(){var a=s_oSpriteLibrary.getSprite("coin"),b=createBitmap(a);b.regX=.5*a.width;b.regY=.5*a.height;b.x=T.x;
b.y=T.y;b.alpha=0;F.addChild(b);a=O.getScoreIconPos();createjs.Tween.get(b).to({alpha:1},200,createjs.Ease.quadIn);createjs.Tween.get(b).to({x:a.x},COIN_SPEED,createjs.Ease.quintIn);createjs.Tween.get(b).to({y:a.y},COIN_SPEED,createjs.Ease.cercOut).call(function(){O.pulseScoreIcon();F.removeChild(b);createjs.Tween.removeTweens(b)})};this.addScore=function(a){function b(){d.addCoin(c);q++;O.refreshScoreText(q+s_iTotalScore);c++;c<a&&setTimeout(b,100)}p&&(a+=FLIP_VALUE);v+=a;var c=0,d=this;b()};this.initNewLevelText=
function(){var a=this.showMessage(TEXT_LEVEL+" "+(s_iLevel+1),SECONDARY_FONT_COLOUR);a.outline=5;var b=this.showMessage(TEXT_LEVEL+" "+(s_iLevel+1),PRIMARY_FONT_COLOUR);a.x=b.x=CANVAS_WIDTH_HALF;a.y=b.y=CANVAS_HEIGHT_HALF;createjs.Tween.get(a).to({y:0,alpha:0},3*TEXT_MESSAGES_SPEED,createjs.Ease.sineOut).call(function(){createjs.Tween.removeTweens(a);L.removeChild(a)});createjs.Tween.get(b).to({y:0,alpha:0},3*TEXT_MESSAGES_SPEED,createjs.Ease.sineOut).call(function(){createjs.Tween.removeTweens(b);
L.removeChild(b)})};this.initScoreText=function(a,b,c){var d=this.showMessage("+"+a,SECONDARY_FONT_COLOUR);d.outline=5;var f=this.showMessage("+"+a,PRIMARY_FONT_COLOUR);b&&c?(d.x=f.x=b,d.y=f.y=c):(d.x=f.x=CANVAS_WIDTH_HALF,d.y=f.y=CANVAS_HEIGHT-300);createjs.Tween.get(d).to({y:0,alpha:0},3*TEXT_MESSAGES_SPEED,createjs.Ease.sineOut).call(function(){createjs.Tween.removeTweens(d);L.removeChild(d)});createjs.Tween.get(f).to({y:0,alpha:0},3*TEXT_MESSAGES_SPEED,createjs.Ease.sineOut).call(function(){createjs.Tween.removeTweens(f);
L.removeChild(f)})};this.showMessage=function(a,b){var c=new createjs.Text(a,FONT_SIZE_TEXT_MESSAGE+PRIMARY_FONT,b);c.textAlign="center";c.textBaseline="alphabetic";c.x=CANVAS_WIDTH_HALF;c.y=CANVAS_HEIGHT_HALF;L.addChild(c);return c};this.showEncouragmentMessage=function(){var a=I.getBodyAngle();if(a>180-DIVE_OFFSET_PERFECT&&a<180+DIVE_OFFSET_PERFECT){a=TEXT_ENCOURAGEMENT2;var b=DIVE_VALUE_PERFECT;n+=3}else a>180-DIVE_OFFSET_GOOD&&a<180+DIVE_OFFSET_GOOD?(a=TEXT_ENCOURAGEMENT0,b=DIVE_VALUE_GOOD,n+=
2):(a=TEXT_ENCOURAGEMENT1,b=DIVE_VALUE,n+=1);this.addScore(b);var c=this.showMessage(a,SECONDARY_FONT_COLOUR);c.outline=5;var d=this.showMessage(a,PRIMARY_FONT_COLOUR);createjs.Tween.get(c).to({alpha:0},1500,createjs.Ease.quadIn);createjs.Tween.get(c).to({y:0},1500,createjs.Ease.quadIn).call(function(){createjs.Tween.removeTweens(c);L.removeChild(c)});createjs.Tween.get(d).to({alpha:0},1500,createjs.Ease.quadIn);createjs.Tween.get(d).to({y:0},1500,createjs.Ease.quadIn).call(function(){createjs.Tween.removeTweens(d);
L.removeChild(d)})};this.onCorrectDive=function(){playSound("bonus",1,!1);u++;w++;var a=this;setTimeout(function(){a.checkNextLevel()},1E3)};this.checkNextLevel=function(){LEVEL_TURNS[s_iLevel]>u?this._resetStage():this._gameWin()};this.unlockNextLevel=function(){s_iLastLevel<s_iLevel+1&&(s_iLastLevel+=1);saveItem("cliff_diving_last_level",s_iLastLevel)};this._gameWin=function(){this.unlockNextLevel();setTimeout(function(){b=!1},1E3);this._updateScore();O.refreshScoreText(s_iTotalScore);null===S&&
(createjs.Tween.removeTweens(A),$("#canvas").trigger("share_event",s_iTotalScore),$("#canvas").trigger("save_score",s_iTotalScore),playSound("game_win",1,!1),stopSound("soundtrack"),setTimeout(function(){playSound("soundtrack",.5,!1)},3E3),S=new CWinPanel(s_iTotalScore,x))};this._gameOver=function(a){setTimeout(function(){b=!1},1E3);v=0;this._updateScore();null===R&&(createjs.Tween.removeTweens(A),$("#canvas").trigger("share_event",s_iTotalScore),$("#canvas").trigger("save_score",s_iTotalScore),playSound("game_over",
1,!1),stopSound("soundtrack"),setTimeout(function(){playSound("soundtrack",.5,!1)},3E3),setTimeout(function(){R=new CEndPanel(s_iTotalScore,a)},MESSAGE_GAMEOVER_DELAY))};this.setStartGame=function(a){b=a};this.removeTutorialMessage=function(){K.alpha=0;createjs.Tween.removeTweens(K);F.removeChild(K);K=null};this._showTutorialMessage=function(a){g=!1;K&&this.removeTutorialMessage();K=new createjs.Container;F.addChild(K);var b=s_oSpriteLibrary.getSprite("msg_box_small"),c=createBitmap(b);c.regX=.5*
b.width;c.regY=.5*b.height;c.x=CANVAS_WIDTH_HALF;c.y=CANVAS_HEIGHT_HALF-300;a=new createjs.Text(a,FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);a.textAlign="center";a.textBaseline="middle";a.lineWidth=520;a.x=c.x;a.y=c.y-50;K.alpha=0;K.addChild(c,a);createjs.Tween.get(K).to({alpha:1},200,createjs.Ease.quadIn).call(s_oGame._removeTutorial)};this._removeTutorial=function(){createjs.Tween.get(K).to({alpha:0},TUTORIAL_FADEOUT_SPEED,createjs.Ease.quadIn).call(function(){createjs.Tween.removeTweens(K);
F.removeChild(K)})};this.onPressed=function(a){d||m||f||(d=!0,I.setActive(!0),h?k=!0:0===s_iLevel&&g&&s_oGame._showTutorialMessage(TEXT_TUTORIAL1),this.onPressMove())};this.onPressMove=function(a){d&&!m&&(e=!0)};this.onReleased=function(){d&&e&&(h?(l=!0,I.onJumpingPressReleased()):(g=h=!0,0===s_iLevel&&g&&s_oGame._showTutorialMessage(TEXT_TUTORIAL2),!1===soundPlaying("jump")&&playSound("jump",1,!1),I.onJump()),d=e=!1)};this.onLandedOnWater=function(){I.addWaterResistance()};this.addWaterSplash=function(a){if(!M){!1===
soundPlaying("water")&&playSound("water",1,!1);var b=[s_oSpriteLibrary.getSprite("watersplash0")];1===r?b=[s_oSpriteLibrary.getSprite("watersplash1")]:2===r&&(b=[s_oSpriteLibrary.getSprite("watersplash2")]);b=new createjs.SpriteSheet({images:b,framerate:10,frames:{width:384,height:384,regX:0,regY:0},animations:{idle:[0,9,"idle"]}});M=createSprite(b,"idle",0,0,384,384);M.regX=192;M.regY=334;M.x=a.GetPosition().x*WORLD_SCALE;M.y=a.GetPosition().y*WORLD_SCALE;M.addEventListener("animationend",this._removeWaterSplash);
D.addChild(M);this.setCoinStart({x:M.x,y:M.y})}};this._removeWaterSplash=function(){D.removeChild(M);M=null};this.onFlipCompleted=function(){p=!0;P||Q||(P=this.showMessage(TEXT_FLIP,SECONDARY_FONT_COLOUR),P.outline=5,Q=this.showMessage(TEXT_FLIP,PRIMARY_FONT_COLOUR),createjs.Tween.get(P).to({y:0,alpha:0},2*TEXT_MESSAGES_SPEED,createjs.Ease.sineOut).call(function(){createjs.Tween.removeTweens(P);L.removeChild(P)}),createjs.Tween.get(Q).to({y:0,alpha:0},2*TEXT_MESSAGES_SPEED,createjs.Ease.sineOut).call(function(){createjs.Tween.removeTweens(Q);
L.removeChild(Q)}))};this.onTouchedTrampoline=function(a){h&&(!1===soundPlaying("collision")&&playSound("collision",1,!1),this.startShake(),I.changeHeadAnimation(HEAD_HIT),I.addTrampolinePush(),this._addCollisionAnimation(a),m=!0,this.onReleased())};this._addCollisionAnimation=function(a){a=s_oPhysicsController.getBodyPosition(a);var b={images:[s_oSpriteLibrary.getSprite("collision")],framerate:10,frames:{width:243,height:163,regX:0,regY:0},animations:{idle:[0,3,!1]}};b=new createjs.SpriteSheet(b);
var c=createSprite(b,"idle",0,0,243,163);c.regX=121.5;c.regY=81.5;c.x=a.x;c.y=a.y;c.addEventListener("animationend",function(){D.removeChild(c)});D.addChild(c)};this.checkForEntry=function(a){f||(f=!0,K&&this.removeTutorialMessage(),m?this._gameOver(TEXT_GAMEOVER_HIT):k?l?I.getBodyAngle()<ENTRY_ANGLE_MIN||I.getBodyAngle()>ENTRY_ANGLE_MAX?this._gameOver(TEXT_GAMEOVER_DIVE):a===FIXTURE_TORSO||a===FIXTURE_HEAD?this._gameOver(TEXT_GAMEOVER_DIVE):(this.showEncouragmentMessage(),this.onCorrectDive()):this._gameOver(TEXT_GAMEOVER_RELEASE):
this._gameOver(TEXT_GAMEOVER_ROTATION))};this._updatePhysics=function(){I&&I.update();s_oPhysicsController.update()};this._updateCamera=function(){if(I){var a=CAMERA_CANVAS_OFFSET-I.getTorsoY();a>CAMERA_CANVAS_MAX_Y&&(a=CAMERA_CANVAS_MAX_Y);a<CAMERA_CANVAS_MIN_Y&&(a=CAMERA_CANVAS_MIN_Y);createjs.Tween.get(D).to({y:a},CAMERA_MOVEMENT_SPEED,createjs.Ease.cubicOut);DEBUG_BOX2D&&s_oPhysicsController.updateDebugPosition({x:0,y:D.y})}};this._checkPlayerMovement=function(){!1===h?!1===e?c=0:(I.onPreparation(easeOutCubic(c,
0,1,1)),c+=.05,1<c&&(c=1)):!1===e?c=0:(I.onJumpingPressDown(easeOutCubic(c,0,1,1)),c+=.05,1<c&&(c=1))};this.update=function(){if(b){for(var a=0;a<UPDATE_LOOP_VAR;a++)this._updatePhysics();this._updateCamera();this._checkPlayerMovement()}};s_oGame=this;DIVE_VALUE=a.dive_value;DIVE_VALUE_GOOD=a.dive_value_good;DIVE_VALUE_PERFECT=a.dive_value_perfect;DIVE_OFFSET_PERFECT=a.dive_offset_perfect;DIVE_OFFSET_GOOD=a.dive_offset_good;DIVE_OFFSET_POOR=a.dive_offset_poor;ENTRY_ANGLE_MIN=180-DIVE_OFFSET_POOR;
ENTRY_ANGLE_MAX=180+DIVE_OFFSET_POOR;FLIP_VALUE=a.flip_value;PLANE_WAIT_TIME=a.plane_wait_time;PLANE_SPEED=a.plane_speed;this._init()}var s_oGame=null;
function CPhysicsController(){var a=Box2D.Common.Math.b2Vec2,c=Box2D.Dynamics.b2World,b=Box2D.Dynamics.b2DebugDraw,d,e=this;this.init=function(){var b=new a(0,GRAVITY);d=new c(b,!0);DEBUG_BOX2D&&this._initDebugCanvas();this.createAContactListener()};this._initDebugCanvas=function(){var a=document.createElement("canvas");a.id="debug";a.width=s_oCanvas.width;a.height=s_oCanvas.height;a.style.position="fixed";document.body.appendChild(a);$("#debug").css("pointer-events","none");a=document.getElementById("debug").getContext("2d");
var c=new b;c.SetSprite(a);c.SetDrawScale(WORLD_SCALE);c.SetFillAlpha(DEBUG_BOX2D_ALPHA);c.SetLineThickness(1);c.SetFlags(b.e_shapeBit);d.SetDebugDraw(c);sizeHandler()};this.removeDebugCanvas=function(){var a=document.getElementById("debug");a.parentNode.removeChild(a)};this.updateDebugPosition=function(a){var b=document.getElementById("debug").getContext("2d");b.save();b.clearRect(0,0,s_oCanvas.width,s_oCanvas.height);b.translate(a.x,a.y);d.DrawDebugData();b.restore()};this.createAContactListener=
function(){var a=new Box2D.Dynamics.b2ContactListener;a.BeginContact=function(a){var b=a.GetFixtureA().GetUserData(),c=a.GetFixtureB().GetUserData();if(-1<FIXTURE_TRAMPOLINE.indexOf(b)&&c!==FIXTURE_RIGHTFOOT&&c!==FIXTURE_LEFTFOOT)s_oGame.onTouchedTrampoline(a.GetFixtureB().GetBody());if(-1<FIXTURE_TRAMPOLINE.indexOf(c)&&b!==FIXTURE_RIGHTFOOT&&b!==FIXTURE_LEFTFOOT)s_oGame.onTouchedTrampoline(a.GetFixtureA().GetBody());b===FIXTURE_WATER?(s_oGame.addWaterSplash(a.GetFixtureB().GetBody()),s_oGame.onLandedOnWater(),
s_oGame.checkForEntry(c)):c===FIXTURE_WATER&&(s_oGame.addWaterSplash(a.GetFixtureA().GetBody()),s_oGame.onLandedOnWater(),s_oGame.checkForEntry(b));e.processContactEvent(CONTACT_BEGIN,b,a);e.processContactEvent(CONTACT_BEGIN,c,a)};a.EndContact=function(a){var b=a.GetFixtureA().GetUserData(),c=a.GetFixtureB().GetUserData();e.processContactEvent(CONTACT_END,b,a);e.processContactEvent(CONTACT_END,c,a)};a.PreSolve=function(a,b){};d.SetContactListener(a)};this.processContactEvent=function(a,b,c){b&&b.contacttype===
a&&b.callback(b.params,c)};this.destroyBody=function(a){d.DestroyBody(a.GetBody())};this.destroyBodyVector=function(a){d.DestroyBody(a)};this.getBodies=function(){return d.GetBodyList()};this.destroyAllBodies=function(){for(var a=d.GetBodyList();a;){var b=a;a=a.GetNext();d.DestroyBody(b)}d.deleteUnusedObjects};this.destroyAllJoints=function(){for(var a=d.GetJointList();a;){var b=a;a=a.GetNext();d.DestroyJoint(b)}};this.destroyJoint=function(a){d.DestroyJoint(a)};this.destroyAllContacts=function(){for(var a=
d.GetContactList();a;){var b=a;a=a.GetNext();d.DestroyJoint(b)}};this.destroyWorld=function(){this.destroyAllJoints();this.destroyAllBodies();this.destroyAllContacts();DEBUG_BOX2D&&this.removeDebugCanvas();d=null};this.getWorld=function(){return d};this.getBodyAtMouse=function(b){b=new a(b.x,b.y);for(var c=d.GetBodyList();c;){var f=!1,e=c;c=c.GetNext();if(e){var m=e.GetFixtureList();m&&(f=m.TestPoint(b))}if(f)return e}return!1};this.setBodyPosition=function(a,b,c){a.SetPosition({x:b/WORLD_SCALE,y:c/
WORLD_SCALE})};this.setElementPosition=function(a,b){var c={x:b.x/WORLD_SCALE,y:b.y/WORLD_SCALE};a.GetBody().SetPosition(c)};this.setElementBodyPosition=function(a,b){a.SetPosition({x:b.x/WORLD_SCALE,y:b.y/WORLD_SCALE})};this.getBodyPosition=function(a){var b=a.GetPosition();return{x:b.x*WORLD_SCALE,y:b.y*WORLD_SCALE,angle:180*a.GetAngle()/Math.PI}};this.getElementPosition=function(a){var b=a.GetBody().GetPosition();return{x:b.x*WORLD_SCALE,y:b.y*WORLD_SCALE,angle:180*a.GetBody().GetAngle()/Math.PI}};
this.getElementAngle=function(a){return 180*a.GetBody().GetAngle()/Math.PI};this.update=function(){d.Step(TIMESTEP,VELOCITY_ITERATIONS,POSITION_ITERATIONS);DEBUG_BOX2D&&d.DrawDebugData();d.ClearForces()};this.init()}
function CPhysicObjectsCreator(a){var c=Box2D.Dynamics.b2BodyDef,b=Box2D.Dynamics.b2Body,d=Box2D.Dynamics.b2FixtureDef,e=Box2D.Collision.Shapes.b2PolygonShape,f=Box2D.Collision.Shapes.b2CircleShape,h=Box2D.Dynamics.Joints.b2RevoluteJointDef,k=Box2D.Dynamics.Joints.b2MouseJointDef,l;this.init=function(){l=a};this.addPlayer=function(a){var b=this.addNewObject(INFOS_RIGHTBOTTOMLEG.type,INFOS_RIGHTBOTTOMLEG.x,INFOS_RIGHTBOTTOMLEG.y,INFOS_RIGHTBOTTOMLEG.angle,INFOS_RIGHTBOTTOMLEG.issensor,INFOS_RIGHTBOTTOMLEG.category,
INFOS_RIGHTBOTTOMLEG.vertices,INFOS_RIGHTBOTTOMLEG.maskbits,INFOS_RIGHTBOTTOMLEG.userdata),c=this.addNewObject(INFOS_RIGHTTOPLEG.type,INFOS_RIGHTTOPLEG.x,INFOS_RIGHTTOPLEG.y,INFOS_RIGHTTOPLEG.angle,INFOS_RIGHTTOPLEG.issensor,INFOS_RIGHTTOPLEG.category,INFOS_RIGHTTOPLEG.vertices,INFOS_RIGHTTOPLEG.maskbits,INFOS_RIGHTTOPLEG.userdata),d=this.addNewObject(INFOS_RIGHTARM.type,INFOS_RIGHTARM.x,INFOS_RIGHTARM.y,INFOS_RIGHTARM.angle,INFOS_RIGHTARM.issensor,INFOS_RIGHTARM.category,INFOS_RIGHTARM.vertices,
INFOS_RIGHTARM.maskbits,INFOS_RIGHTARM.userdata),e=this.addNewObject(INFOS_TORSO.type,INFOS_TORSO.x,INFOS_TORSO.y,INFOS_TORSO.angle,INFOS_TORSO.issensor,INFOS_TORSO.category,INFOS_TORSO.vertices,INFOS_TORSO.maskbits,INFOS_TORSO.userdata),f=this.addNewObject(INFOS_LEFTARM.type,INFOS_LEFTARM.x,INFOS_LEFTARM.y,INFOS_LEFTARM.angle,INFOS_LEFTARM.issensor,INFOS_LEFTARM.category,INFOS_LEFTARM.vertices,INFOS_LEFTARM.maskbits,INFOS_LEFTARM.userdata),h=this.addNewObject(INFOS_LEFTBOTTOMLEG.type,INFOS_LEFTBOTTOMLEG.x,
INFOS_LEFTBOTTOMLEG.y,INFOS_LEFTBOTTOMLEG.angle,INFOS_LEFTBOTTOMLEG.issensor,INFOS_LEFTBOTTOMLEG.category,INFOS_LEFTBOTTOMLEG.vertices,INFOS_LEFTBOTTOMLEG.maskbits,INFOS_LEFTBOTTOMLEG.userdata),k=this.addNewObject(INFOS_LEFTTOPLEG.type,INFOS_LEFTTOPLEG.x,INFOS_LEFTTOPLEG.y,INFOS_LEFTTOPLEG.angle,INFOS_LEFTTOPLEG.issensor,INFOS_LEFTTOPLEG.category,INFOS_LEFTTOPLEG.vertices,INFOS_LEFTTOPLEG.maskbits,INFOS_LEFTTOPLEG.userdata),m=this.addNewCircle(INFOS_HEAD.type,INFOS_HEAD.x,INFOS_HEAD.y,INFOS_HEAD.angle,
INFOS_HEAD.radius,INFOS_HEAD.issensor,INFOS_HEAD.category,INFOS_HEAD.maskbits,INFOS_HEAD.userdata),l=this.addNewObject(INFOS_RIGHTFOOT.type,INFOS_RIGHTFOOT.x,INFOS_RIGHTFOOT.y,INFOS_RIGHTFOOT.angle,INFOS_RIGHTFOOT.issensor,INFOS_RIGHTFOOT.category,INFOS_RIGHTFOOT.vertices,INFOS_RIGHTFOOT.maskbits,INFOS_RIGHTFOOT.userdata),n=this.addNewObject(INFOS_LEFTFOOT.type,INFOS_LEFTFOOT.x,INFOS_LEFTFOOT.y,INFOS_LEFTFOOT.angle,INFOS_LEFTFOOT.issensor,INFOS_LEFTFOOT.category,INFOS_LEFTFOOT.vertices,INFOS_LEFTFOOT.maskbits,
INFOS_LEFTFOOT.userdata),y=this.addRevoluteJoint(e.body,f.body,INFOS_LEFTSHOULDER.bodyAX,INFOS_LEFTSHOULDER.bodyAY,INFOS_LEFTSHOULDER.bodyBX,INFOS_LEFTSHOULDER.bodyBY,INFOS_LEFTSHOULDER.angle,INFOS_LEFTSHOULDER.enablelimit,INFOS_LEFTSHOULDER.lowerangle,INFOS_LEFTSHOULDER.upperangle),B=this.addRevoluteJoint(e.body,d.body,INFOS_RIGHTSHOULDER.bodyAX,INFOS_RIGHTSHOULDER.bodyAY,INFOS_RIGHTSHOULDER.bodyBX,INFOS_RIGHTSHOULDER.bodyBY,INFOS_RIGHTSHOULDER.angle,INFOS_RIGHTSHOULDER.enablelimit,INFOS_RIGHTSHOULDER.lowerangle,
INFOS_RIGHTSHOULDER.upperangle),C=this.addRevoluteJoint(e.body,k.body,INFOS_LEFTPELVIS.bodyAX,INFOS_LEFTPELVIS.bodyAY,INFOS_LEFTPELVIS.bodyBX,INFOS_LEFTPELVIS.bodyBY,INFOS_LEFTPELVIS.angle,INFOS_LEFTPELVIS.enablelimit,INFOS_LEFTPELVIS.lowerangle,INFOS_LEFTPELVIS.upperangle),E=this.addRevoluteJoint(e.body,c.body,INFOS_RIGHTPELVIS.bodyAX,INFOS_RIGHTPELVIS.bodyAY,INFOS_RIGHTPELVIS.bodyBX,INFOS_RIGHTPELVIS.bodyBY,INFOS_RIGHTPELVIS.angle,INFOS_RIGHTPELVIS.enablelimit,INFOS_RIGHTPELVIS.lowerangle,INFOS_RIGHTPELVIS.upperangle),
G=this.addRevoluteJoint(e.body,m.body,INFOS_NECK.bodyAX,INFOS_NECK.bodyAY,INFOS_NECK.bodyBX,INFOS_NECK.bodyBY,INFOS_NECK.angle,INFOS_NECK.enablelimit,INFOS_NECK.lowerangle,INFOS_NECK.upperangle),A=this.addRevoluteJoint(c.body,b.body,INFOS_RIGHTKNEE.bodyAX,INFOS_RIGHTKNEE.bodyAY,INFOS_RIGHTKNEE.bodyBX,INFOS_RIGHTKNEE.bodyBY,INFOS_RIGHTKNEE.angle,INFOS_RIGHTKNEE.enablelimit,INFOS_RIGHTKNEE.lowerangle,INFOS_RIGHTKNEE.upperangle),J=this.addRevoluteJoint(k.body,h.body,INFOS_LEFTKNEE.bodyAX,INFOS_LEFTKNEE.bodyAY,
INFOS_LEFTKNEE.bodyBX,INFOS_LEFTKNEE.bodyBY,INFOS_LEFTKNEE.angle,INFOS_LEFTKNEE.enablelimit,INFOS_LEFTKNEE.lowerangle,INFOS_LEFTKNEE.upperangle),H=this.addRevoluteJoint(l.body,b.body,INFOS_RIGHTANKLE.bodyAX,INFOS_RIGHTANKLE.bodyAY,INFOS_RIGHTANKLE.bodyBX,INFOS_RIGHTANKLE.bodyBY,INFOS_RIGHTANKLE.angle,INFOS_RIGHTANKLE.enablelimit,INFOS_RIGHTANKLE.lowerangle,INFOS_RIGHTANKLE.upperangle),F=this.addRevoluteJoint(n.body,h.body,INFOS_LEFTANKLE.bodyAX,INFOS_LEFTANKLE.bodyAY,INFOS_LEFTANKLE.bodyBX,INFOS_LEFTANKLE.bodyBY,
INFOS_LEFTANKLE.angle,INFOS_LEFTANKLE.enablelimit,INFOS_LEFTANKLE.lowerangle,INFOS_LEFTANKLE.upperangle);return new CPlayer({torso:e,head:m,leftArm:f,rightArm:d,leftTopLeg:k,leftBottomLeg:h,rightTopLeg:c,rightBottomLeg:b,rightFoot:l,leftFoot:n,leftShoulder:y,rightShoulder:B,leftPelvis:C,rightPelvis:E,neck:G,rightKnee:A,leftKnee:J,rightAnkle:H,leftAnkle:F},a)};this.addTrampolinePhysics=function(){var a=[],b=this.addNewObject(INFOS_TOPTRAMPOLINE.type,INFOS_TOPTRAMPOLINE.x[s_iLevel],INFOS_TOPTRAMPOLINE.y[s_iLevel],
INFOS_TOPTRAMPOLINE.angle,INFOS_TOPTRAMPOLINE.issensor,INFOS_TOPTRAMPOLINE.category,INFOS_TOPTRAMPOLINE.vertices,INFOS_TOPTRAMPOLINE.maskbits,INFOS_TOPTRAMPOLINE.userdata);a.push(b);b=this.addNewObject(INFOS_MIDDLETRAMPOLINE.type,INFOS_MIDDLETRAMPOLINE.x[s_iLevel],INFOS_MIDDLETRAMPOLINE.y[s_iLevel],INFOS_MIDDLETRAMPOLINE.angle,INFOS_MIDDLETRAMPOLINE.issensor,INFOS_MIDDLETRAMPOLINE.category,INFOS_MIDDLETRAMPOLINE.vertices,INFOS_MIDDLETRAMPOLINE.maskbits,INFOS_MIDDLETRAMPOLINE.userdata);a.push(b);b=
this.addNewObject(INFOS_BOTTOMTRAMPOLINE.type,INFOS_BOTTOMTRAMPOLINE.x[s_iLevel],INFOS_BOTTOMTRAMPOLINE.y[s_iLevel],INFOS_BOTTOMTRAMPOLINE.angle,INFOS_BOTTOMTRAMPOLINE.issensor,INFOS_BOTTOMTRAMPOLINE.category,INFOS_BOTTOMTRAMPOLINE.vertices,INFOS_BOTTOMTRAMPOLINE.maskbits,INFOS_BOTTOMTRAMPOLINE.userdata);a.push(b);return a};this.addFloor=function(){this.addNewObject(INFOS_WATER.type,INFOS_WATER.x,INFOS_WATER.y,INFOS_WATER.angle,INFOS_WATER.issensor,INFOS_WATER.category,INFOS_WATER.vertices,INFOS_WATER.maskbits,
INFOS_WATER.userdata)};this.addNewCircle=function(a,e,h,k,q,v,u,w,r){var g=new c;g.type=a===STATIC_BODY?b.b2_staticBody:b.b2_dynamicBody;g.position.Set(e,h);g.angle=k;g.linearVelocity.Set(0,0);g.angularVelocity=0;g.linearDamping=0;g.angularDamping=0;g.allowSleep=!0;g.fixedRotation=!1;g.bullet=!1;g.active=!0;a=l.CreateBody(g);e=new d;e.friction=.2;e.restitution=.5;e.density=1;e.isSensor=v;e.filter.categoryBits=u;e.filter.maskBits=w;e.filter.groupIndex=0;e.userData=r;e.shape=new f;e.shape.m_p.Set(0,
0);e.shape.m_radius=q;q=a.CreateFixture(e);return{body:a,fixture:q}};this.addNewObject=function(a,f,h,k,q,v,u,w,r){var g=new c;g.type=a===STATIC_BODY?b.b2_staticBody:b.b2_dynamicBody;g.position.Set(f,h);g.angle=k;g.linearVelocity.Set(0,0);g.angularVelocity=0;g.linearDamping=0;g.angularDamping=0;g.allowSleep=!0;g.fixedRotation=!1;g.bullet=!1;g.active=!0;a=l.CreateBody(g);f=new d;f.friction=.2;f.restitution=.5;f.density=1;f.isSensor=q;f.filter.categoryBits=v;f.filter.maskBits=w;f.filter.groupIndex=
0;f.userData=r;f.shape=new e;f.shape.SetAsArray(u,4);q=a.CreateFixture(f);return{body:a,fixture:q}};this.addRectangle=function(a,f,h,k,q,v,u,w,r,x){var g=new c;switch(r){case DYNAMIC_BODY:g.type=b.b2_dynamicBody;break;case STATIC_BODY:g.type=b.b2_staticBody;break;case KINEMATIC_BODY:g.type=b.b2_kinematicBody}r=new d;r.density=v;r.friction=u;r.restitution=w;r.shape=new e;r.shape.SetAsBox(a/WORLD_SCALE,f/WORLD_SCALE);r.userData={id:x};g.position.Set(h/WORLD_SCALE,k/WORLD_SCALE);g.angle=q*Math.PI/180;
a=l.CreateBody(g);a.CreateFixture(r);return a};this.addRevoluteJoint=function(a,b,c,d,e,f,k,w,r,x){var g=new h;g.localAnchorA.x=c;g.localAnchorA.y=d;g.localAnchorB.x=e;g.localAnchorB.y=f;g.referenceAngle=k;g.enableLimit=w;g.lowerAngle=r;g.upperAngle=x;g.enableMotor=!1;g.motorSpeed=0;g.maxMotorTorque=0;g.bodyA=a;g.bodyB=b;g.collideConnected=!1;return g=l.CreateJoint(g)};this.addMouseJoint=function(a,b,d,e,f){var g=new c;g=l.CreateBody(g);var h=new k;h.bodyA=g;h.bodyB=a;h.target=b;h.collideConnected=
d;h.maxForce=e*a.GetMass();h.dampingRatio=f;b=l.CreateJoint(h);a.SetAwake(!0);return b};this.init()}function CPhysicWorld(a,c){var b,d,e;this._init=function(){var a=s_oSpriteLibrary.getSprite("bg");b=createBitmap(a);b.x=0;b.y=0;b.alpha=1E-4;f.addChild(b);d=a.width;e=a.height};this.centerToScreen=function(a){for(var c=d,f=b.x-d/2,h=b.y-e/2,p=0;p<a.length;p++)a[p].x=a[p].x*c+f,a[p].y=e-a[p].y*c+h};this.unload=function(){f.removeChild(b);b=null};var f=c;this._init()}
function CToggle(a,c,b,d,e){var f,h,k,l,m;this._init=function(a,b,c,d,e){m=void 0!==e?e:s_oStage;h=[];k=[];e=new createjs.SpriteSheet({images:[c],frames:{width:c.width/2,height:c.height,regX:c.width/2/2,regY:c.height/2},animations:{state_true:[0],state_false:[1]}});f=d;l=createSprite(e,"state_"+f,c.width/2/2,c.height/2,c.width/2,c.height);l.x=a;l.y=b;l.stop();s_bMobile||(l.cursor="pointer");m.addChild(l);this._initListener()};this.unload=function(){l.off("mousedown",this.buttonDown);l.off("pressup",
this.buttonRelease);m.removeChild(l)};this._initListener=function(){l.on("mousedown",this.buttonDown);l.on("pressup",this.buttonRelease)};this.addEventListener=function(a,b,c){h[a]=b;k[a]=c};this.setCursorType=function(a){l.cursor=a};this.setActive=function(a){f=a;l.gotoAndStop("state_"+f)};this.buttonRelease=function(){l.scaleX=1;l.scaleY=1;playSound("click",1,!1);f=!f;l.gotoAndStop("state_"+f);h[ON_MOUSE_UP]&&h[ON_MOUSE_UP].call(k[ON_MOUSE_UP],f)};this.buttonDown=function(){l.scaleX=.9;l.scaleY=
.9;h[ON_MOUSE_DOWN]&&h[ON_MOUSE_DOWN].call(k[ON_MOUSE_DOWN])};this.setPosition=function(a,b){l.x=a;l.y=b};this._init(a,c,b,d,e)}
function CGfxButton(a,c,b,d){var e,f,h,k,l,m,p,g,t;this._init=function(a,b,c){e=!1;f=[];h=[];l=[];k=createBitmap(c);k.x=a;k.y=b;p=m=1;k.regX=c.width/2;k.regY=c.height/2;s_bMobile||(k.cursor="pointer");q.addChild(k);this._initListener()};this.getSprite=function(){return k};this.unload=function(){k.off("mousedown",g);k.off("pressup",t);q.removeChild(k)};this.setVisible=function(a){k.visible=a};this.setCursorType=function(a){k.cursor=a};this._initListener=function(){g=k.on("mousedown",this.buttonDown);
t=k.on("pressup",this.buttonRelease)};this.addEventListener=function(a,b,c){f[a]=b;h[a]=c};this.addEventListenerWithParams=function(a,b,c,d){f[a]=b;h[a]=c;l[a]=d};this.enable=function(){e=!1};this.disable=function(){e=!0};this.buttonRelease=function(){e||(k.scaleX=0<m?1:-1,k.scaleY=1,playSound("click",1,!1),f[ON_MOUSE_UP]&&f[ON_MOUSE_UP].call(h[ON_MOUSE_UP],l[ON_MOUSE_UP]))};this.buttonDown=function(){e||(k.scaleX=0<m?.9:-.9,k.scaleY=.9,f[ON_MOUSE_DOWN]&&f[ON_MOUSE_DOWN].call(h[ON_MOUSE_DOWN],l[ON_MOUSE_DOWN]))};
this.rotation=function(a){k.rotation=a};this.getButton=function(){return k};this.setPosition=function(a,b){k.x=a;k.y=b};this.setX=function(a){k.x=a};this.setY=function(a){k.y=a};this.getButtonImage=function(){return k};this.setScaleX=function(a){m=k.scaleX=a};this.getX=function(){return k.x};this.getY=function(){return k.y};this.pulseAnimation=function(){createjs.Tween.get(k).to({scaleX:.9*m,scaleY:.9*p},850,createjs.Ease.quadOut).to({scaleX:m,scaleY:p},650,createjs.Ease.quadIn).call(function(){v.pulseAnimation()})};
this.trebleAnimation=function(){createjs.Tween.get(k).to({rotation:5},75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},75,createjs.Ease.quadIn).wait(750).call(function(){v.trebleAnimation()})};this.removeAllTweens=function(){createjs.Tween.removeTweens(k)};var q=void 0!==d?d:s_oStage;this._init(a,c,b);var v=this;return this}
function CTextButton(a,c,b,d,e,f,h,k){var l,m,p,g,t,q,v;this._init=function(a,b,c,d,e,f,h){l=[];m=[];p=[];var k=createBitmap(c);t=new createjs.Text(d,h+"px "+e,f);t.textAlign="center";t.textBaseline="middle";t.getBounds();t.x=c.width/2;t.y=Math.floor(c.height/2);g=new createjs.Container;g.x=a;g.y=b;g.regX=c.width/2;g.regY=c.height/2;g.addChild(k,t);u.addChild(g);s_bMobile||(g.cursor="pointer");this._initListener()};this.unload=function(){g.off("mousedown",q);g.off("pressup",v);u.removeChild(g)};this.setVisible=
function(a){g.visible=a};this._initListener=function(){q=g.on("mousedown",this.buttonDown);v=g.on("pressup",this.buttonRelease)};this.addEventListener=function(a,b,c){m[a]=b;p[a]=c};this.buttonRelease=function(){g.scaleX=1;g.scaleY=1;playSound("click",1,!1);m[ON_MOUSE_UP]&&m[ON_MOUSE_UP].call(p[ON_MOUSE_UP],l[ON_MOUSE_UP])};this.buttonDown=function(){g.scaleX=.9;g.scaleY=.9;m[ON_MOUSE_DOWN]&&m[ON_MOUSE_DOWN].call(p[ON_MOUSE_DOWN],l[ON_MOUSE_DOWN])};this.addEventListenerWithParams=function(a,b,c,d){m[a]=
b;p[a]=c;l[a]=d};this.setTextPosition=function(a){t.y=a};this.setPosition=function(a,b){g.x=a;g.y=b};this.setX=function(a){g.x=a};this.setY=function(a){g.y=a};this.getButtonImage=function(){return g};this.getX=function(){return g.x};this.getY=function(){return g.y};var u=k;this._init(a,c,b,d,e,f,h);return this}
function CInterface(a){var c,b,d,e,f,h,k,l,m,p,g=null,t=null,q,v,u,w,r,x,n,y,B;this._init=function(){B=a;k=new createjs.Container;B.addChild(k);var m=s_oSpriteLibrary.getSprite("but_exit");c=CANVAS_WIDTH-m.width/2-20;b=m.height/2+10;q=new CGfxButton(c,b,m,k);q.addEventListener(ON_MOUSE_UP,this._onExit,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){var n=s_oSpriteLibrary.getSprite("audio_icon");f=c-m.width/2-n.width/4-10;h=b;l=new CToggle(f,h,n,s_bAudioActive,k);l.addEventListener(ON_MOUSE_UP,
this._onAudioToggle,this);d=f-m.width/2-n.width/4-10;e=n.height/2+10}else d=c-m.width-10,e=b;m=window.document;n=m.documentElement;g=n.requestFullscreen||n.mozRequestFullScreen||n.webkitRequestFullScreen||n.msRequestFullscreen;t=m.exitFullscreen||m.mozCancelFullScreen||m.webkitExitFullscreen||m.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(g=!1);g&&screenfull.enabled&&(n=s_oSpriteLibrary.getSprite("but_fullscreen"),p=new CToggle(d,e,n,s_bFullscreen,k),p.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,
this));this.initInterfaceTexts();this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.initInterfaceTexts=function(){m=CANVAS_HEIGHT-250;n=new createjs.Text(TEXT_TURN+" 1/"+LEVEL_TURNS[s_iLevel],FONT_SIZE_INTERFACE+PRIMARY_FONT,SECONDARY_FONT_COLOUR);n.textAlign="right";n.textBaseline="alphabetic";n.x=CANVAS_WIDTH-60;n.y=m;n.outline=5;k.addChild(n);y=new createjs.Text(TEXT_TURN+" 1/"+LEVEL_TURNS[s_iLevel],FONT_SIZE_INTERFACE+PRIMARY_FONT,PRIMARY_FONT_COLOUR);y.textAlign="right";y.textBaseline="alphabetic";
y.x=CANVAS_WIDTH-60;y.y=m;k.addChild(y);var a=s_iLevel+1;r=new createjs.Text(TEXT_LEVEL+" "+a,FONT_SIZE_INTERFACE+PRIMARY_FONT,SECONDARY_FONT_COLOUR);r.textAlign="left";r.textBaseline="alphabetic";r.x=60;r.y=m;r.outline=5;k.addChild(r);x=new createjs.Text(TEXT_LEVEL+" "+a,FONT_SIZE_INTERFACE+PRIMARY_FONT,PRIMARY_FONT_COLOUR);x.textAlign="left";x.textBaseline="alphabetic";x.x=60;x.y=m;k.addChild(x);u=new createjs.Text(s_iTotalScore,FONT_SIZE_INTERFACE+PRIMARY_FONT,SECONDARY_FONT_COLOUR);u.textAlign=
"left";u.textBaseline="alphabetic";u.x=60;u.y=b;u.outline=5;k.addChild(u);w=new createjs.Text(s_iTotalScore,FONT_SIZE_INTERFACE+PRIMARY_FONT,PRIMARY_FONT_COLOUR);w.textAlign="left";w.textBaseline="alphabetic";w.x=60;w.y=b;k.addChild(w);a=s_oSpriteLibrary.getSprite("coin");v=createBitmap(a);v.regX=.5*a.width;v.regY=.5*a.height;v.x=w.x-35;v.y=w.y-15;k.addChild(v);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.getScoreIconPos=function(){return{x:v.x,y:v.y}};this.pulseScoreIcon=function(){!0!==createjs.Tween.hasActiveTweens(v)&&
createjs.Tween.get(v).to({scaleX:1.2,scaleY:1.2},300,createjs.Ease.quadOut).to({scaleX:1,scaleY:1},300,createjs.Ease.quadIn).call(function(){createjs.Tween.removeTweens(v)})};this.refreshTurnText=function(a){n.text=y.text=TEXT_TURN+" "+a+"/"+LEVEL_TURNS[s_iLevel]};this.refreshButtonPos=function(a,k){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||l.setPosition(f-a,h+k);g&&screenfull.enabled&&p.setPosition(d-a,e+k);q.setPosition(c-a,b+k);m=CANVAS_HEIGHT-k-50;void 0!==w&&(u.x=w.x=80+a,u.y=w.y=b+k,v.x=w.x-
35,v.y=w.y-15);void 0!==y&&(n.y=y.y=m);void 0!==x&&(r.x=x.x=60+a,r.y=x.y=m)};this.refreshScoreText=function(a){u.text=w.text=a};this.unload=function(){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)l.unload(),l=null;g&&screenfull.enabled&&p.unload();q.unload();s_oInterface=null;s_oGame._bDisableEvents=!1;s_oGame.setStartGame(!0)};this._onExit=function(){new CAreYouSurePanel(k);s_oGame._bDisableEvents=!0;s_oGame.setStartGame(!1)};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=
!s_bAudioActive};this._onFullscreenRelease=function(){s_bFullscreen?t.call(window.document):g.call(window.document.documentElement);sizeHandler()};this.resetFullscreenBut=function(){g&&screenfull.enabled&&p.setActive(s_bFullscreen)};s_oInterface=this;this._init();return this}var s_oInterface=null;
function CPlayer(a,c){var b,d,e=Box2D.Common.Math.b2Vec2,f,h,k,l,m,p,g,t,q,v,u,w,r,x,n,y,B,C,E,G,A,J,H,F;this._init=function(){l=!0;p=!1;k=h=f=0;2<s_iLevel&&6>s_iLevel?k=1:5<s_iLevel&&9>s_iLevel&&(k=2);g=z.head.body;t=z.torso.body;q=z.leftBottomLeg.body;v=z.rightBottomLeg.body;u=z.leftTopLeg.body;w=z.rightTopLeg.body;r=z.leftArm.body;x=z.rightArm.body;n=z.leftFoot.body;y=z.rightFoot.body;this.setActive(!1);this.addPlayerSprites();this.movePlayerOnTrampoline()};this.movePlayerOnTrampoline=function(){this.setVisible(!0);
var a=[INFOS_BOTTOMTRAMPOLINE,INFOS_MIDDLETRAMPOLINE,INFOS_TOPTRAMPOLINE],c=[BOTTOM_TRAMPOLINE_OFFSETS,MIDDLE_TRAMPOLINE_OFFSETS,TOP_TRAMPOLINE_OFFSETS];this.movePlayerToPosition(a[h].x[s_iLevel]*WORLD_SCALE+c[h].x,a[h].y[s_iLevel]*WORLD_SCALE+c[h].y);b=g.GetPosition().x;d=g.GetPosition().y;m=!0};this.addPlayerSprites=function(){var a=s_oSpriteLibrary.getSprite("player"+k+"_leftarm");H=createBitmap(a);H.regX=.5*a.width;H.regY=.5*a.height;D.addChild(H);a=s_oSpriteLibrary.getSprite("player"+k+"_leftbottomleg");
E=createBitmap(a);E.regX=.5*a.width;E.regY=.5*a.height;D.addChild(E);a=s_oSpriteLibrary.getSprite("player"+k+"_lefttopleg");A=createBitmap(a);A.regX=.5*a.width;A.regY=.5*a.height;D.addChild(A);a=s_oSpriteLibrary.getSprite("player"+k+"_torso");C=createBitmap(a);C.regX=.5*a.width-5;C.regY=.5*a.height;D.addChild(C);a={images:[s_oSpriteLibrary.getSprite("player"+k+"_head")],framerate:0,frames:{width:49,height:57,regX:0,regY:0}};a=new createjs.SpriteSheet(a);B=createSprite(a,0,0,0,49,57);B.regX=19.5;B.regY=
28.5;B.gotoAndStop(HEAD_STANDING);D.addChild(B);a=s_oSpriteLibrary.getSprite("player"+k+"_rightbottomleg");G=createBitmap(a);G.regX=.5*a.width;G.regY=.5*a.height;D.addChild(G);a=s_oSpriteLibrary.getSprite("player"+k+"_righttopleg");J=createBitmap(a);J.regX=.5*a.width;J.regY=.5*a.height;D.addChild(J);a=s_oSpriteLibrary.getSprite("player"+k+"_rightarm");F=createBitmap(a);F.regX=.5*a.width;F.regY=.5*a.height;D.addChild(F)};this.resetPosition=function(a){h=a;p=!0;this.setActive(!1)};this.resetBodiesVelocities=
function(){g.SetLinearVelocity({x:0,y:0});t.SetLinearVelocity({x:0,y:0});q.SetLinearVelocity({x:0,y:0});v.SetLinearVelocity({x:0,y:0});u.SetLinearVelocity({x:0,y:0});w.SetLinearVelocity({x:0,y:0});r.SetLinearVelocity({x:0,y:0});x.SetLinearVelocity({x:0,y:0});n.SetLinearVelocity({x:0,y:0});y.SetLinearVelocity({x:0,y:0});g.SetAngularVelocity(0);t.SetAngularVelocity(0);q.SetAngularVelocity(0);v.SetAngularVelocity(0);u.SetAngularVelocity(0);w.SetAngularVelocity(0);r.SetAngularVelocity(0);x.SetAngularVelocity(0);
n.SetAngularVelocity(0);y.SetAngularVelocity(0);g.SetLinearDamping(0);t.SetLinearDamping(0);q.SetLinearDamping(0);v.SetLinearDamping(0);u.SetLinearDamping(0);w.SetLinearDamping(0);r.SetLinearDamping(0);x.SetLinearDamping(0);n.SetLinearDamping(0);y.SetLinearDamping(0);g.SetAngularDamping(0);t.SetAngularDamping(0);q.SetAngularDamping(0);v.SetAngularDamping(0);u.SetAngularDamping(0);w.SetAngularDamping(0);r.SetAngularDamping(0);x.SetAngularDamping(0);n.SetAngularDamping(0);y.SetAngularDamping(0)};this.resetBodiesPosition=
function(){g.SetAngle(INFOS_HEAD.angle);t.SetAngle(INFOS_TORSO.angle);q.SetAngle(INFOS_LEFTBOTTOMLEG.angle);v.SetAngle(INFOS_RIGHTBOTTOMLEG.angle);u.SetAngle(INFOS_LEFTTOPLEG.angle);w.SetAngle(INFOS_RIGHTTOPLEG.angle);r.SetAngle(INFOS_LEFTARM.angle);x.SetAngle(INFOS_RIGHTARM.angle);n.SetAngle(INFOS_LEFTFOOT.angle);y.SetAngle(INFOS_RIGHTFOOT.angle);this.movePlayerOnTrampoline();this.resetBodiesVelocities();this.resetJointLimits();this.setJointsMotorSpeed(0);this.changeHeadAnimation(HEAD_STANDING);
this._moveSpritePosOnPhysicPos()};this.changeHeadAnimation=function(a){B.gotoAndStop(a)};this.movePlayerToPosition=function(a,b){s_oPhysicsController.setElementBodyPosition(g,{x:a+HEAD_OFFSET.x*WORLD_SCALE,y:b+HEAD_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(t,{x:a+TORSO_OFFSET.x*WORLD_SCALE,y:b+TORSO_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(q,{x:a+LEFTBOTTOMLEG_OFFSET.x*WORLD_SCALE,y:b+LEFTBOTTOMLEG_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(v,
{x:a+RIGHTBOTTOMLEG_OFFSET.x*WORLD_SCALE,y:b+RIGHTBOTTOMLEG_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(u,{x:a+LEFTTOPLEG_OFFSET.x*WORLD_SCALE,y:b+LEFTTOPLEG_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(w,{x:a+RIGHTTOPLEG_OFFSET.x*WORLD_SCALE,y:b+RIGHTTOPLEG_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(r,{x:a+LEFTARM_OFFSET.x*WORLD_SCALE,y:b+LEFTARM_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(x,{x:a+RIGHTARM_OFFSET.x*
WORLD_SCALE,y:b+RIGHTARM_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(n,{x:a+LEFTFOOT_OFFSET.x*WORLD_SCALE,y:b+LEFTFOOT_OFFSET.y*WORLD_SCALE});s_oPhysicsController.setElementBodyPosition(y,{x:a+RIGHTFOOT_OFFSET.x*WORLD_SCALE,y:b+RIGHTFOOT_OFFSET.y*WORLD_SCALE});this._moveSpritePosOnPhysicPos()};this.onPreparation=function(a){if(l){this.changeHeadAnimation(HEAD_PREPARATION);this.setPlayerLimits(.8*a,-1.2*a,-2.2*a);a=degreesToRadians(-90);var c=degreesToRadians(180);z.rightAnkle.SetLimits(a,
c);z.leftAnkle.SetLimits(a,c);n.SetType(STATIC_BODY);y.SetType(STATIC_BODY);g.GetPosition().y>d&&(c=new e(0,VERTICAL_FORCE_UP_PREPARATION),g.ApplyForce(c,g.GetWorldCenter()));c=b+.05;var f=b+1;a=b+.05;g.GetPosition().x>c&&g.GetPosition().x<f&&!0===m&&(c=new e(HORIZONTAL_FORCE_PREPARATION,0),g.ApplyForce(c,g.GetWorldCenter()),m=!1);g.GetPosition().x<a&&(c=new e(HORIZONTAL_FORCE_PREPARATION_BACK,0),g.ApplyForce(c,g.GetWorldCenter()))}};this.onJump=function(){if(l){this.changeHeadAnimation(HEAD_DIVING);
this.setPlayerLimits(.5,.5,-2);n.SetType(DYNAMIC_BODY);y.SetType(DYNAMIC_BODY);z.rightAnkle.SetLimits(0,0);z.leftAnkle.SetLimits(0,0);var a=new e(VERTICAL_FORCE_RIGHT_JUMP,VERTICAL_FORCE_UP_JUMP);g.ApplyForce(a,g.GetWorldCenter());t.ApplyForce(a,t.GetWorldCenter());n.ApplyForce(a,n.GetWorldCenter());y.ApplyForce(a,y.GetWorldCenter())}};this.addTrampolinePush=function(){z.rightKnee.EnableLimit(!1);z.leftKnee.EnableLimit(!1);z.rightPelvis.EnableLimit(!1);z.leftPelvis.EnableLimit(!1);z.rightShoulder.EnableLimit(!1);
z.leftShoulder.EnableLimit(!1);var a=new e(VERTICAL_FORCE_RIGHT_TRAMPOLINE,VERTICAL_FORCE_UP_TRAMPOLINE);t.ApplyForce(a,t.GetWorldCenter())};this.setJointsMotorSpeed=function(a){z.rightKnee.SetMotorSpeed(a);z.leftKnee.SetMotorSpeed(a);z.rightPelvis.SetMotorSpeed(a);z.leftPelvis.SetMotorSpeed(a);z.rightShoulder.SetMotorSpeed(a);z.leftShoulder.SetMotorSpeed(a);z.rightAnkle.SetMotorSpeed(a);z.leftAnkle.SetMotorSpeed(a)};this.setPlayerLimits=function(a,b,c){z.rightKnee.SetLimits(a,a);z.leftKnee.SetLimits(a,
a);z.rightPelvis.SetLimits(b,b);z.leftPelvis.SetLimits(b,b);z.rightShoulder.SetLimits(c,c);z.leftShoulder.SetLimits(c,c);z.rightShoulder.EnableLimit(!0);z.leftShoulder.EnableLimit(!0)};this.onJumpingPressDown=function(a){l&&(this.setPlayerLimits(1*a,-2.5*a,-.5*a),g.ApplyTorque(BODY_ROTATION_TORQUE*a))};this.onJumpingPressReleased=function(){l&&this.setPlayerLimits(.5,.5,-2)};this.setActive=function(a){t.SetActive(a);g.SetActive(a);r.SetActive(a);x.SetActive(a);u.SetActive(a);q.SetActive(a);w.SetActive(a);
v.SetActive(a);n.SetActive(a);y.SetActive(a);l=a};this.resetJointLimits=function(){z.rightKnee.SetLimits(INFOS_RIGHTKNEE.lowerangle,INFOS_RIGHTKNEE.upperangle);z.leftKnee.SetLimits(INFOS_LEFTKNEE.lowerangle,INFOS_LEFTKNEE.upperangle);z.rightPelvis.SetLimits(INFOS_RIGHTPELVIS.lowerangle,INFOS_RIGHTPELVIS.upperangle);z.leftPelvis.SetLimits(INFOS_LEFTPELVIS.lowerangle,INFOS_LEFTPELVIS.upperangle);z.rightShoulder.SetLimits(INFOS_LEFTSHOULDER.lowerangle,INFOS_LEFTSHOULDER.upperangle);z.leftShoulder.SetLimits(INFOS_RIGHTSHOULDER.lowerangle,
INFOS_RIGHTSHOULDER.upperangle);z.rightShoulder.EnableLimit(!1);z.leftShoulder.EnableLimit(!1);z.rightAnkle.SetLimits(INFOS_RIGHTANKLE.lowerangle,INFOS_RIGHTANKLE.upperangle);z.leftAnkle.SetLimits(INFOS_LEFTANKLE.lowerangle,INFOS_LEFTANKLE.upperangle)};this.addWaterResistance=function(){var a=this;setTimeout(function(){a.setVisible(!1)},100)};this.setVisible=function(a){for(var b=this.getSpriteArray(),c=0;c<b.length;c++)b[c].visible=a};this.unload=function(){this.setActive(!1);D.removeChild(B);D.removeChild(C);
D.removeChild(E);D.removeChild(G);D.removeChild(A);D.removeChild(J);D.removeChild(H);D.removeChild(F)};this.getSpriteArray=function(){var a=[];a.push(B);a.push(C);a.push(E);a.push(G);a.push(A);a.push(J);a.push(H);a.push(F);return a};this.getBodyAngle=function(){for(var a=s_oPhysicsController.getBodyPosition(t).angle;360<a;)a-=360,s_oGame.onFlipCompleted();return a};this.getTorsoX=function(){return s_oPhysicsController.getBodyPosition(t).x};this.getTorsoY=function(){return s_oPhysicsController.getBodyPosition(t).y};
this.getBody=function(){return z};this.updateSpritePos=function(a,b){var c=s_oPhysicsController.getBodyPosition(a);b.x=c.x;b.y=c.y;b.rotation=c.angle};this._moveSpritePosOnPhysicPos=function(){this.updateSpritePos(g,B);this.updateSpritePos(t,C);this.updateSpritePos(r,H);this.updateSpritePos(x,F);this.updateSpritePos(u,A);this.updateSpritePos(w,J);this.updateSpritePos(q,E);this.updateSpritePos(v,G)};this.update=function(){p&&(f+=s_iTimeElaps,f>PLAYER_RESET_TIMER&&(this.resetBodiesPosition(),f=0,p=
!1));l&&this._moveSpritePosOnPhysicPos()};var D=c;var z=a;this._init()}
function CCreditsPanel(){var a,c,b,d,e,f,h,k,l,m,p;this._init=function(){var g=s_oSpriteLibrary.getSprite("msg_box");k=new createjs.Container;s_oStage.addChild(k);e=new createjs.Shape;e.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,2*CANVAS_HEIGHT);e.alpha=0;k.addChild(e);createjs.Tween.get(e).to({alpha:.7},500);p=CANVAS_HEIGHT+g.height/2;l=new createjs.Container;l.y=p;k.addChild(l);a=createBitmap(g);a.regX=g.width/2;a.regY=g.height/2;a.x=CANVAS_WIDTH_HALF;a.y=CANVAS_HEIGHT_HALF;l.addChild(a);
f=new createjs.Shape;f.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);f.alpha=.01;m=f.on("click",this._onLogoButRelease);l.addChild(f);s_bMobile||(f.cursor="pointer");g=s_oSpriteLibrary.getSprite("but_exit");b=new CGfxButton(715,572,g,l);b.addEventListener(ON_MOUSE_UP,this.unload,this);d=new createjs.Text(TEXT_CREDITS_DEVELOPED,FONT_SIZE_CREDITS+PRIMARY_FONT,PRIMARY_FONT_COLOUR);d.textAlign="center";d.textBaseline="alphabetic";d.x=CANVAS_WIDTH_HALF;d.y=CANVAS_HEIGHT_HALF-80;
l.addChild(d);g=s_oSpriteLibrary.getSprite("logo_ctl");c=createBitmap(g);c.regX=g.width/2;c.regY=g.height/2;c.x=CANVAS_WIDTH_HALF;c.y=CANVAS_HEIGHT_HALF;l.addChild(c);h=new createjs.Text("www.codethislab.com",FONT_SIZE_CREDITS+PRIMARY_FONT,PRIMARY_FONT_COLOUR);h.textAlign="center";h.textBaseline="alphabetic";h.x=CANVAS_WIDTH_HALF;h.y=CANVAS_HEIGHT_HALF+100;l.addChild(h);createjs.Tween.get(l).to({y:0},1E3,createjs.Ease.backOut)};this.unload=function(){createjs.Tween.get(e).to({alpha:0},500);createjs.Tween.get(k).to({y:p},
400,createjs.Ease.backIn).call(function(){f.off("click",m);b.unload();b=null;s_oStage.removeChild(k);s_oMenu.exitFromCredits()})};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en","_blank")};this._init()}
function CAreYouSurePanel(){var a,c,b,d,e,f;this._init=function(){c=new createjs.Container;s_oStage.addChild(c);f=new createjs.Container;s_oStage.addChild(f);e=new createjs.Shape;e.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);e.alpha=0;e.on("mousedown",function(){});c.addChild(e);createjs.Tween.get(e).to({alpha:.7},500);var h=s_oSpriteLibrary.getSprite("msg_box"),l=createBitmap(h);l.regX=h.width/2;l.regY=h.height/2;l.x=CANVAS_WIDTH_HALF;l.y=CANVAS_HEIGHT_HALF;f.addChild(l);
f.y=CANVAS_HEIGHT+h.height/2;a=f.y;createjs.Tween.get(f).to({y:0},1E3,createjs.Ease.backOut);h=new createjs.Text(TEXT_ARE_SURE,FONT_SIZE_ARE_YOU_SURE+PRIMARY_FONT,PRIMARY_FONT_COLOUR);h.x=CANVAS_WIDTH_HALF;h.y=CANVAS_HEIGHT_HALF-130;h.textAlign="center";h.textBaseline="middle";h.lineWidth=500;f.addChild(h);b=new CGfxButton(CANVAS_WIDTH_HALF+195,790,s_oSpriteLibrary.getSprite("but_yes"),f);b.addEventListener(ON_MOUSE_UP,this._onButYes,this);d=new CGfxButton(CANVAS_WIDTH_HALF-195,790,s_oSpriteLibrary.getSprite("but_no"),
f);d.addEventListener(ON_MOUSE_UP,this._onButNo,this)};this._onButYes=function(){d.disable();b.disable();createjs.Tween.get(e).to({alpha:0},500);createjs.Tween.get(f).to({y:a},400,createjs.Ease.backIn).call(function(){h.unload();s_oGame.onExit()})};this._onButNo=function(){d.disable();b.disable();createjs.Tween.get(e).to({alpha:0},500);createjs.Tween.get(f).to({y:a},400,createjs.Ease.backIn).call(function(){h.unload()})};this.unload=function(){d.unload();b.unload();s_oGame.setStartGame(!0);c.removeChild(e);
s_oStage.removeChild(f);e.off("mousedown",function(){})};var h=this;this._init()}
function CHelpPanel(){var a,c,b,d,e,f,h=null,k=null,l,m,p,g,t,q,v,u,w,r,x,n,y,B,C,E,G,A;this._init=function(){A=!1;c=0;b=new createjs.Container;s_oStage.addChild(b);d=new createjs.Container;s_oStage.addChild(d);f=new createjs.Shape;f.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);f.alpha=0;f.on("mousedown",function(){});b.addChild(f);createjs.Tween.get(f).to({alpha:.7},500);var e=s_oSpriteLibrary.getSprite("msg_box_big"),g=createBitmap(e);g.regX=e.width/2;g.regY=e.height/2;g.x=
CANVAS_WIDTH_HALF;g.y=CANVAS_HEIGHT_HALF;d.addChild(g);d.y=CANVAS_HEIGHT+e.height/2;a=d.y;createjs.Tween.get(d).to({y:0},1E3,createjs.Ease.backOut);this.initText();this.initImages();h=new CGfxButton(CANVAS_WIDTH_HALF+350,CANVAS_HEIGHT_HALF,s_oSpriteLibrary.getSprite("arrow"),d);h.getButtonImage().rotation=90;h.addEventListener(ON_MOUSE_UP,this._onRight,this);k=new CGfxButton(CANVAS_WIDTH_HALF-350,CANVAS_HEIGHT_HALF,s_oSpriteLibrary.getSprite("arrow"),d);k.getButtonImage().rotation=-90;k.addEventListener(ON_MOUSE_UP,
this._onLeft,this);k.setVisible(!1);this.initNewPage();l=new CGfxButton(CANVAS_WIDTH_HALF,CANVAS_HEIGHT_HALF+450,s_oSpriteLibrary.getSprite("but_next"),d);l.addEventListener(ON_MOUSE_UP,this._onExitHelp,this);s_oGame._bDisableEvents=!0};this._onRight=function(){c++;2<c&&(c=0);k.setVisible(!0);2===c?h.setVisible(!1):h.setVisible(!0);this.initNewPage()};this._onLeft=function(){c--;0>c&&(c=2);h.setVisible(!0);0===c?k.setVisible(!1):k.setVisible(!0);this.initNewPage()};this.initText=function(){e=new createjs.Text(TEXT_HELP1,
FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);e.textAlign="center";e.textBaseline="middle";e.lineWidth=550;e.x=CANVAS_WIDTH_HALF;e.y=CANVAS_HEIGHT_HALF-200;e.visible=!1;d.addChild(e)};this.initImages=function(){var a=s_oSpriteLibrary.getSprite("help_preparation");m=createBitmap(a);m.regX=.5*a.width;m.regY=.5*a.height;m.x=CANVAS_WIDTH_HALF-180;m.y=CANVAS_HEIGHT_HALF-70;m.visible=!1;d.addChild(m);p=new createjs.Text(TEXT_HELP_PREPARATION,FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);p.textAlign=
"left";p.textBaseline="alphabetic";p.lineWidth=350;p.x=m.x+100;p.y=m.y-10;p.visible=!1;d.addChild(p);a=s_oSpriteLibrary.getSprite("help_jump");g=createBitmap(a);g.regX=.5*a.width;g.regY=.5*a.height;g.x=CANVAS_WIDTH_HALF+180;g.y=CANVAS_HEIGHT_HALF+90;g.visible=!1;d.addChild(g);t=new createjs.Text(TEXT_HELP_JUMP,FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);t.textAlign="right";t.textBaseline="alphabetic";t.lineWidth=350;t.x=g.x-100;t.y=g.y-10;t.visible=!1;d.addChild(t);a=s_oSpriteLibrary.getSprite("help_flip");
q=createBitmap(a);q.regX=.5*a.width;q.regY=.5*a.height;q.x=CANVAS_WIDTH_HALF-180;q.y=CANVAS_HEIGHT_HALF-70;q.visible=!1;d.addChild(q);v=new createjs.Text(TEXT_HELP_FLIP,FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);v.textAlign="left";v.textBaseline="alphabetic";v.lineWidth=350;v.x=q.x+100;v.y=q.y-10;v.visible=!1;d.addChild(v);a=s_oSpriteLibrary.getSprite("help_release");u=createBitmap(a);u.regX=.5*a.width;u.regY=.5*a.height;u.x=CANVAS_WIDTH_HALF+180;u.y=CANVAS_HEIGHT_HALF+90;u.visible=!1;d.addChild(u);
w=new createjs.Text(TEXT_HELP_RELEASE,FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);w.textAlign="right";w.textBaseline="alphabetic";w.lineWidth=350;w.x=u.x-100;w.y=u.y-10;w.visible=!1;d.addChild(w);a=s_oSpriteLibrary.getSprite("help_dive_best");r=createBitmap(a);r.regX=.5*a.width;r.regY=.5*a.height;r.x=CANVAS_WIDTH_HALF-180;r.y=CANVAS_HEIGHT_HALF;r.visible=!1;d.addChild(r);x=new createjs.Text(TEXT_ENCOURAGEMENT2,FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);x.textAlign="center";x.textBaseline=
"alphabetic";x.lineWidth=350;x.x=r.x;x.y=r.y+120;x.visible=!1;d.addChild(x);a=s_oSpriteLibrary.getSprite("help_dive_good");n=createBitmap(a);n.regX=.5*a.width;n.regY=.5*a.height;n.x=CANVAS_WIDTH_HALF;n.y=CANVAS_HEIGHT_HALF;n.visible=!1;d.addChild(n);y=new createjs.Text(TEXT_ENCOURAGEMENT0,FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);y.textAlign="center";y.textBaseline="alphabetic";y.lineWidth=350;y.x=n.x;y.y=n.y+120;y.visible=!1;d.addChild(y);a=s_oSpriteLibrary.getSprite("help_dive_poor");B=createBitmap(a);
B.regX=.5*a.width;B.regY=.5*a.height;B.x=CANVAS_WIDTH_HALF+180;B.y=CANVAS_HEIGHT_HALF;B.visible=!1;d.addChild(B);C=new createjs.Text(TEXT_ENCOURAGEMENT1,FONT_SIZE_HELP+PRIMARY_FONT,PRIMARY_FONT_COLOUR);C.textAlign="center";C.textBaseline="alphabetic";C.lineWidth=350;C.x=B.x;C.y=B.y+120;C.visible=!1;d.addChild(C);a=s_oSpriteLibrary.getSprite("help_hand");E=createBitmap(a);E.regX=.5*a.width;E.regY=.5*a.height;E.x=m.x+50;E.y=m.y+50;E.scaleX=E.scaleY=.5;E.visible=!1;d.addChild(E);G=createBitmap(a);G.regX=
.5*a.width;G.regY=.5*a.height;G.x=g.x+100;G.y=g.y+130;G.visible=!1;d.addChild(G)};this.initNewPage=function(){e.visible=!1;m.visible=p.visible=!1;g.visible=t.visible=!1;q.visible=v.visible=!1;u.visible=w.visible=!1;r.visible=x.visible=!1;n.visible=y.visible=!1;B.visible=C.visible=!1;E.visible=G.visible=!1;switch(c){case 0:e.text=TEXT_HELP1;e.visible=!0;m.visible=p.visible=!0;g.visible=t.visible=!0;E.visible=G.visible=!0;break;case 1:q.visible=v.visible=!0;u.visible=w.visible=!0;E.visible=G.visible=
!0;break;case 2:e.text=TEXT_HELP2,e.visible=!0,r.visible=x.visible=!0,n.visible=y.visible=!0,B.visible=C.visible=!0}};this.unload=function(){createjs.Tween.get(f).to({alpha:0},500);createjs.Tween.get(d).to({y:a},400,createjs.Ease.backIn).call(function(){d.removeAllChildren();s_oStage.removeChild(d);s_oGame._bDisableEvents=!1;h.unload();k.unload();l.unload();l=k=h=null})};this._onExitHelp=function(){!0!==A&&(A=!0,createjs.Tween.removeTweens(d),createjs.Tween.removeTweens(f),this.unload(),s_oGame._onExitHelp())};
this._init()}
function CEndPanel(a,c){var b,d,e,f,h,k,l;this._init=function(){_iScore=a;d=new createjs.Container;s_oStage.addChild(d);e=new createjs.Container;s_oStage.addChild(e);f=new createjs.Shape;f.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);f.alpha=0;f.on("mousedown",function(){});d.addChild(f);createjs.Tween.get(f).to({alpha:.7},500);var m=s_oSpriteLibrary.getSprite("msg_box_big"),p=createBitmap(m);p.regX=m.width/2;p.regY=m.height/2;p.x=CANVAS_WIDTH_HALF;p.y=CANVAS_HEIGHT_HALF;e.addChild(p);
e.y=CANVAS_HEIGHT+m.height/2;b=e.y;createjs.Tween.get(e).to({y:0},1E3,createjs.Ease.backOut).call(function(){$("#canvas").trigger("show_interlevel_ad")});l=new createjs.Text(c,FONT_SIZE_END_PANEL_TITLE+PRIMARY_FONT,PRIMARY_FONT_COLOUR);l.textAlign="center";l.textBaseline="alphabetic";l.x=CANVAS_WIDTH_HALF;l.y=CANVAS_HEIGHT_HALF-100;l.lineWidth=560;e.addChild(l);h=new CGfxButton(CANVAS_WIDTH_HALF-190,830,s_oSpriteLibrary.getSprite("but_home"),e);h.addEventListener(ON_MOUSE_UP,this._onExit,this);k=
new CGfxButton(CANVAS_WIDTH_HALF+190,830,s_oSpriteLibrary.getSprite("but_restart"),e);k.addEventListener(ON_MOUSE_UP,this._onRestart,this)};this.unload=function(){createjs.Tween.get(f).wait(MESSAGE_GAMEOVER_DELAY).to({alpha:0},500);createjs.Tween.get(e).wait(MESSAGE_GAMEOVER_DELAY).to({y:b},400,createjs.Ease.backIn).call(function(){h.unload();k.unload();s_oStage.removeChild(d);s_oEndPanel=null})};this._onExit=function(){this.unload();s_oGame.onExit()};this._onRestart=function(){this.unload();s_oGame.restart()};
s_oEndPanel=this;this._init()}var s_oEndPanel=null;
function CWinPanel(a,c){var b,d,e,f,h,k,l,m,p,g,t,q;this._init=function(){g=a;t=c;q=[];d=new createjs.Container;s_oStage.addChild(d);e=new createjs.Container;s_oStage.addChild(e);f=new createjs.Shape;f.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);f.alpha=0;f.on("mousedown",function(){});d.addChild(f);createjs.Tween.get(f).to({alpha:.7},500);var v=s_oSpriteLibrary.getSprite("msg_box_big"),u=createBitmap(v);u.regX=v.width/2;u.regY=v.height/2;u.x=CANVAS_WIDTH_HALF;u.y=CANVAS_HEIGHT_HALF;
e.addChild(u);e.y=CANVAS_HEIGHT+v.height/2;b=e.y;createjs.Tween.get(e).to({y:0},1E3,createjs.Ease.backOut).call(function(){$("#canvas").trigger("show_interlevel_ad")}).wait(100).call(this.showStars);m=new createjs.Text(TEXT_LEVELWIN,FONT_SIZE_END_PANEL_TITLE+PRIMARY_FONT,PRIMARY_FONT_COLOUR);m.textAlign="center";m.textBaseline="alphabetic";m.x=CANVAS_WIDTH_HALF;m.y=CANVAS_HEIGHT_HALF-160;m.lineWidth=560;e.addChild(m);p=new createjs.Text(TEXT_SCORE+": "+g,FONT_SIZE_END_PANEL_TEXT+PRIMARY_FONT,PRIMARY_FONT_COLOUR);
p.textAlign="center";p.textBaseline="alphabetic";p.x=CANVAS_WIDTH_HALF;p.y=CANVAS_HEIGHT_HALF-80;p.lineWidth=560;e.addChild(p);this.initStars();h=new CGfxButton(CANVAS_WIDTH_HALF-190,830,s_oSpriteLibrary.getSprite("but_home"),e);h.addEventListener(ON_MOUSE_UP,this._onExit,this);k=new CGfxButton(CANVAS_WIDTH_HALF,830,s_oSpriteLibrary.getSprite("but_restart"),e);k.addEventListener(ON_MOUSE_UP,this._onRestart,this);l=new CGfxButton(CANVAS_WIDTH_HALF+190,830,s_oSpriteLibrary.getSprite("but_next"),e);
l.addEventListener(ON_MOUSE_UP,this._onNext,this)};this.initStars=function(){q=[];var a=s_oSpriteLibrary.getSprite("starbox"),b=createBitmap(a),c=createBitmap(a),d=createBitmap(a);b.regX=c.regX=d.regX=.5*a.width;b.regY=c.regY=d.regY=.5*a.height;a=s_oSpriteLibrary.getSprite("star");var f=createBitmap(a);q.push(f);var h=createBitmap(a);q.push(h);var g=createBitmap(a);q.push(g);f.regX=h.regX=g.regX=.5*a.width;f.regY=h.regY=g.regY=.5*a.height;f.scaleX=f.scaleY=h.scaleX=h.scaleY=g.scaleX=g.scaleY=0;b.x=
f.x=CANVAS_WIDTH_HALF-70;c.x=h.x=CANVAS_WIDTH_HALF;d.x=g.x=CANVAS_WIDTH_HALF+70;b.y=c.y=d.y=f.y=h.y=g.y=CANVAS_HEIGHT_HALF;e.addChild(b,c,d);e.addChild(f,h,g)};this.showStars=function(){for(var a=0;a<t;a++)playSound("coin",1,!1),createjs.Tween.get(q[a]).wait(300*a).to({scaleX:1,scaleY:1},1500,createjs.Ease.elasticOut)};this.unload=function(){createjs.Tween.get(f).wait(MESSAGE_GAMEWIN_DELAY).to({alpha:0},500);createjs.Tween.get(e).wait(MESSAGE_GAMEWIN_DELAY).to({y:b},400,createjs.Ease.backIn).call(function(){h.unload();
k.unload();s_oStage.removeChild(d);s_oEndPanel=null})};this._onExit=function(){this.unload();s_oGame.onExit()};this._onNext=function(){s_iLevel+=1;s_iLevel<LEVELS_NUMBER?s_oMain.gotoGame():s_oMain.gotoMenu()};this._onRestart=function(){this.unload();s_oGame.restart()};s_oEndPanel=this;this._init()}s_oEndPanel=null;
function CMsgBox(a,c){var b,d,e;this._init=function(a){e=new createjs.Container;f.addChild(e);a=new createjs.Shape;a.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);a.alpha=.5;a.on("click",function(){});e.addChild(a);a=s_oSpriteLibrary.getSprite("msg_box_big");var c=createBitmap(a);c.x=.5*CANVAS_WIDTH;c.y=.5*CANVAS_HEIGHT;c.regX=.5*a.width;c.regY=.5*a.height;e.addChild(c);b=new createjs.Text(TEXT_ERR_LS,FONT_SIZE_MSG_BOX+PRIMARY_FONT,PRIMARY_FONT_COLOUR);b.x=CANVAS_WIDTH/2;b.y=
CANVAS_HEIGHT/2-190;b.textAlign="center";b.textBaseline="middle";b.lineWidth=500;e.addChild(b);d=new CGfxButton(CANVAS_WIDTH/2,820,s_oSpriteLibrary.getSprite("but_yes"),e);d.addEventListener(ON_MOUSE_UP,this._onButOk,this)};this._onButOk=function(){this.unload()};this.unload=function(){d.unload();f.removeChild(e)};var f=c;this._init(a)}
function CShake(a,c,b,d){var e,f,h,k,l,m,p;this._init=function(a,b,c,d){k=h=!1;m=0;this._calculateDuration();e=a.x;f=a.y;h||(h=!0,l=setInterval(function(){g._tremble()},c))};this._tremble=function(){if(k=!k){var t=Math.random(),q=d*=.95,v=d;v=.5>Math.random()?-v:v;a.x+=.5>t?-q:q;a.y+=v}else a.x=e,a.y=f;m++;m>p&&(m=0,h=!1,a.x=e,a.y=f,0===c?l=setInterval(function(){g._tremble()},b):clearInterval(l))};this.isActive=function(){return h};this._calculateDuration=function(){p=c/b};this.stopTremble=function(){clearInterval(l)};
var g=this;this._init(a,c,b,d)};