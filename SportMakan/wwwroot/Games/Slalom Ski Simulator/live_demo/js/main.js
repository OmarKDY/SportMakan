/*
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
(function(){function b(d){d=String(d);return d.charAt(0).toUpperCase()+d.slice(1)}function e(d,F){var z=-1,D=d?d.length:0;if("number"==typeof D&&-1<D&&D<=k)for(;++z<D;)F(d[z],z,d);else f(d,F)}function h(d){d=String(d).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(d)?d:b(d)}function f(d,F){for(var z in d)y.call(d,z)&&F(d[z],z,d)}function l(d){return null==d?b(d):u.call(d).slice(8,-1)}function m(d,F){var z=null!=d?typeof d[F]:"number";return!/^(?:boolean|number|string|undefined)$/.test(z)&&
("object"==z?!!d[F]:!0)}function g(d){return String(d).replace(/([ -])(?!$)/g,"$1?")}function p(d,F){var z=null;e(d,function(D,q){z=F(z,D,q,d)});return z}function n(d){function F(S){return p(S,function(Q,K){var aa=K.pattern||g(K);!Q&&(Q=RegExp("\\b"+aa+" *\\d+[.\\w_]*","i").exec(d)||RegExp("\\b"+aa+" *\\w+-[\\w]*","i").exec(d)||RegExp("\\b"+aa+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(d))&&((Q=String(K.label&&!RegExp(aa,"i").test(K.label)?K.label:Q).split("/"))[1]&&!/[\d.]+/.test(Q[0])&&
(Q[0]+=" "+Q[1]),K=K.label||K,Q=h(Q[0].replace(RegExp(aa,"i"),K).replace(RegExp("; *(?:"+K+"[_-])?","i")," ").replace(RegExp("("+K+")[-_.]?(\\w)","i"),"$1 $2")));return Q})}function z(S){return p(S,function(Q,K){return Q||(RegExp(K+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(d)||0)[1]||null})}var D=v,q=d&&"object"==typeof d&&"String"!=l(d);q&&(D=d,d=null);var I=D.navigator||{},A=I.userAgent||"";d||(d=A);var H=q?!!I.likeChrome:/\bChrome\b/.test(d)&&!/internal|\n/i.test(u.toString()),
E=q?"Object":"ScriptBridgingProxyObject",L=q?"Object":"Environment",N=q&&D.java?"JavaPackage":l(D.java),Z=q?"Object":"RuntimeObject";L=(N=/\bJava/.test(N)&&D.java)&&l(D.environment)==L;var W=N?"a":"\u03b1",U=N?"b":"\u03b2",R=D.document||{},P=D.operamini||D.opera,T=x.test(T=q&&P?P["[[Class]]"]:l(P))?T:P=null,t,X=d;q=[];var Y=null,M=d==A;A=M&&P&&"function"==typeof P.version&&P.version();var J=function(S){return p(S,function(Q,K){return Q||RegExp("\\b"+(K.pattern||g(K))+"\\b","i").exec(d)&&(K.label||
K)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),C=function(S){return p(S,function(Q,K){return Q||RegExp("\\b"+(K.pattern||g(K))+"\\b","i").exec(d)&&(K.label||K)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),G=F([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),O=function(S){return p(S,function(Q,K,aa){return Q||(K[G]||K[/^[a-z]+(?: +[a-z]+\b)*/i.exec(G)]||RegExp("\\b"+g(aa)+"(?:\\b|\\w*\\d)","i").exec(d))&&aa})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),w=function(S){return p(S,function(Q,K){var aa=K.pattern||g(K);if(!Q&&(Q=RegExp("\\b"+aa+"(?:/[\\d.]+|[ \\w.]*)","i").exec(d))){var ba=Q,ca=K.label||K,da={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};aa&&ca&&/^Win/i.test(ba)&&!/^Windows Phone /i.test(ba)&&(da=da[/[\d.]+$/.exec(ba)])&&(ba="Windows "+da);ba=String(ba);aa&&ca&&(ba=ba.replace(RegExp(aa,"i"),ca));Q=ba=h(ba.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,
"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return Q})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X",
"Macintosh","Mac","Windows 98;","Windows "]);J&&(J=[J]);O&&!G&&(G=F([O]));if(t=/\bGoogle TV\b/.exec(G))G=t[0];/\bSimulator\b/i.test(d)&&(G=(G?G+" ":"")+"Simulator");"Opera Mini"==C&&/\bOPiOS\b/.test(d)&&q.push("running in Turbo/Uncompressed mode");"IE"==C&&/\blike iPhone OS\b/.test(d)?(t=n(d.replace(/like iPhone OS/,"")),O=t.manufacturer,G=t.product):/^iP/.test(G)?(C||(C="Safari"),w="iOS"+((t=/ OS ([\d_]+)/i.exec(d))?" "+t[1].replace(/_/g,"."):"")):"Konqueror"!=C||/buntu/i.test(w)?O&&"Google"!=O&&
(/Chrome/.test(C)&&!/\bMobile Safari\b/i.test(d)||/\bVita\b/.test(G))||/\bAndroid\b/.test(w)&&/^Chrome/.test(C)&&/\bVersion\//i.test(d)?(C="Android Browser",w=/\bAndroid\b/.test(w)?w:"Android"):"Silk"==C?(/\bMobi/i.test(d)||(w="Android",q.unshift("desktop mode")),/Accelerated *= *true/i.test(d)&&q.unshift("accelerated")):"PaleMoon"==C&&(t=/\bFirefox\/([\d.]+)\b/.exec(d))?q.push("identifying as Firefox "+t[1]):"Firefox"==C&&(t=/\b(Mobile|Tablet|TV)\b/i.exec(d))?(w||(w="Firefox OS"),G||(G=t[1])):!C||
(t=!/\bMinefield\b/i.test(d)&&/\b(?:Firefox|Safari)\b/.exec(C))?(C&&!G&&/[\/,]|^[^(]+?\)/.test(d.slice(d.indexOf(t+"/")+8))&&(C=null),(t=G||O||w)&&(G||O||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(w))&&(C=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(w)?w:t)+" Browser")):"Electron"==C&&(t=(/\bChrome\/([\d.]+)\b/.exec(d)||0)[1])&&q.push("Chromium "+t):w="Kubuntu";A||(A=z(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",g(C),
"(?:Firefox|Minefield|NetFront)"]));if(t="iCab"==J&&3<parseFloat(A)&&"WebKit"||/\bOpera\b/.test(C)&&(/\bOPR\b/.test(d)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(d)&&!/^(?:Trident|EdgeHTML)$/.test(J)&&"WebKit"||!J&&/\bMSIE\b/i.test(d)&&("Mac OS"==w?"Tasman":"Trident")||"WebKit"==J&&/\bPlayStation\b(?! Vita\b)/i.test(C)&&"NetFront")J=[t];"IE"==C&&(t=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(d)||0)[1])?(C+=" Mobile",w="Windows Phone "+(/\+$/.test(t)?t:t+".x"),q.unshift("desktop mode")):/\bWPDesktop\b/i.test(d)?
(C="IE Mobile",w="Windows Phone 8.x",q.unshift("desktop mode"),A||(A=(/\brv:([\d.]+)/.exec(d)||0)[1])):"IE"!=C&&"Trident"==J&&(t=/\brv:([\d.]+)/.exec(d))&&(C&&q.push("identifying as "+C+(A?" "+A:"")),C="IE",A=t[1]);if(M){if(m(D,"global"))if(N&&(t=N.lang.System,X=t.getProperty("os.arch"),w=w||t.getProperty("os.name")+" "+t.getProperty("os.version")),L){try{A=D.require("ringo/engine").version.join("."),C="RingoJS"}catch(S){(t=D.system)&&t.global.system==D.system&&(C="Narwhal",w||(w=t[0].os||null))}C||
(C="Rhino")}else"object"==typeof D.process&&!D.process.browser&&(t=D.process)&&("object"==typeof t.versions&&("string"==typeof t.versions.electron?(q.push("Node "+t.versions.node),C="Electron",A=t.versions.electron):"string"==typeof t.versions.nw&&(q.push("Chromium "+A,"Node "+t.versions.node),C="NW.js",A=t.versions.nw)),C||(C="Node.js",X=t.arch,w=t.platform,A=(A=/[\d.]+/.exec(t.version))?A[0]:null));else l(t=D.runtime)==E?(C="Adobe AIR",w=t.flash.system.Capabilities.os):l(t=D.phantom)==Z?(C="PhantomJS",
A=(t=t.version||null)&&t.major+"."+t.minor+"."+t.patch):"number"==typeof R.documentMode&&(t=/\bTrident\/(\d+)/i.exec(d))?(A=[A,R.documentMode],(t=+t[1]+4)!=A[1]&&(q.push("IE "+A[1]+" mode"),J&&(J[1]=""),A[1]=t),A="IE"==C?String(A[1].toFixed(1)):A[0]):"number"==typeof R.documentMode&&/^(?:Chrome|Firefox)\b/.test(C)&&(q.push("masking as "+C+" "+A),C="IE",A="11.0",J=["Trident"],w="Windows");w=w&&h(w)}A&&(t=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(A)||/(?:alpha|beta)(?: ?\d)?/i.exec(d+";"+(M&&I.appMinorVersion))||
/\bMinefield\b/i.test(d)&&"a")&&(Y=/b/i.test(t)?"beta":"alpha",A=A.replace(RegExp(t+"\\+?$"),"")+("beta"==Y?U:W)+(/\d+\+?/.exec(t)||""));if("Fennec"==C||"Firefox"==C&&/\b(?:Android|Firefox OS)\b/.test(w))C="Firefox Mobile";else if("Maxthon"==C&&A)A=A.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(G))"Xbox 360"==G&&(w=null),"Xbox 360"==G&&/\bIEMobile\b/.test(d)&&q.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(C)&&(!C||G||/Browser|Mobi/.test(C))||"Windows CE"!=w&&!/Mobi/i.test(d))if("IE"==
C&&M)try{null===D.external&&q.unshift("platform preview")}catch(S){q.unshift("embedded")}else(/\bBlackBerry\b/.test(G)||/\bBB10\b/.test(d))&&(t=(RegExp(G.replace(/ +/g," *")+"/([.\\d]+)","i").exec(d)||0)[1]||A)?(t=[t,/BB10/.test(d)],w=(t[1]?(G=null,O="BlackBerry"):"Device Software")+" "+t[0],A=null):this!=f&&"Wii"!=G&&(M&&P||/Opera/.test(C)&&/\b(?:MSIE|Firefox)\b/i.test(d)||"Firefox"==C&&/\bOS X (?:\d+\.){2,}/.test(w)||"IE"==C&&(w&&!/^Win/.test(w)&&5.5<A||/\bWindows XP\b/.test(w)&&8<A||8==A&&!/\bTrident\b/.test(d)))&&
!x.test(t=n.call(f,d.replace(x,"")+";"))&&t.name&&(t="ing as "+t.name+((t=t.version)?" "+t:""),x.test(C)?(/\bIE\b/.test(t)&&"Mac OS"==w&&(w=null),t="identify"+t):(t="mask"+t,C=T?h(T.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(t)&&(w=null),M||(A=null)),J=["Presto"],q.push(t));else C+=" Mobile";if(t=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(d)||0)[1]){t=[parseFloat(t.replace(/\.(\d)$/,".0$1")),t];if("Safari"==C&&"+"==t[1].slice(-1))C="WebKit Nightly",Y="alpha",A=t[1].slice(0,-1);else if(A==
t[1]||A==(t[2]=(/\bSafari\/([\d.]+\+?)/i.exec(d)||0)[1]))A=null;t[1]=(/\bChrome\/([\d.]+)/i.exec(d)||0)[1];537.36==t[0]&&537.36==t[2]&&28<=parseFloat(t[1])&&"WebKit"==J&&(J=["Blink"]);M&&(H||t[1])?(J&&(J[1]="like Chrome"),t=t[1]||(t=t[0],530>t?1:532>t?2:532.05>t?3:533>t?4:534.03>t?5:534.07>t?6:534.1>t?7:534.13>t?8:534.16>t?9:534.24>t?10:534.3>t?11:535.01>t?12:535.02>t?"13+":535.07>t?15:535.11>t?16:535.19>t?17:536.05>t?18:536.1>t?19:537.01>t?20:537.11>t?"21+":537.13>t?23:537.18>t?24:537.24>t?25:537.36>
t?26:"Blink"!=J?"27":"28")):(J&&(J[1]="like Safari"),t=(t=t[0],400>t?1:500>t?2:526>t?3:533>t?4:534>t?"4+":535>t?5:537>t?6:538>t?7:601>t?8:"8"));J&&(J[1]+=" "+(t+="number"==typeof t?".x":/[.+]/.test(t)?"":"+"));"Safari"==C&&(!A||45<parseInt(A))&&(A=t)}"Opera"==C&&(t=/\bzbov|zvav$/.exec(w))?(C+=" ",q.unshift("desktop mode"),"zvav"==t?(C+="Mini",A=null):C+="Mobile",w=w.replace(RegExp(" *"+t+"$"),"")):"Safari"==C&&/\bChrome\b/.exec(J&&J[1])&&(q.unshift("desktop mode"),C="Chrome Mobile",A=null,/\bOS X\b/.test(w)?
(O="Apple",w="iOS 4.3+"):w=null);A&&0==A.indexOf(t=/[\d.]+$/.exec(w))&&-1<d.indexOf("/"+t+"-")&&(w=String(w.replace(t,"")).replace(/^ +| +$/g,""));J&&!/\b(?:Avant|Nook)\b/.test(C)&&(/Browser|Lunascape|Maxthon/.test(C)||"Safari"!=C&&/^iOS/.test(w)&&/\bSafari\b/.test(J[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(C)&&J[1])&&(t=J[J.length-1])&&q.push(t);q.length&&(q=["("+q.join("; ")+")"]);O&&G&&0>G.indexOf(O)&&q.push("on "+O);G&&q.push((/^on /.test(q[q.length-
1])?"":"on ")+G);if(w){var V=(t=/ ([\d.+]+)$/.exec(w))&&"/"==w.charAt(w.length-t[0].length-1);w={architecture:32,family:t&&!V?w.replace(t[0],""):w,version:t?t[1]:null,toString:function(){var S=this.version;return this.family+(S&&!V?" "+S:"")+(64==this.architecture?" 64-bit":"")}}}(t=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(X))&&!/\bi686\b/i.test(X)?(w&&(w.architecture=64,w.family=w.family.replace(RegExp(" *"+t),"")),C&&(/\bWOW64\b/i.test(d)||M&&/\w(?:86|32)$/.test(I.cpuClass||I.platform)&&!/\bWin64; x64\b/i.test(d))&&
q.unshift("32-bit")):w&&/^OS X/.test(w.family)&&"Chrome"==C&&39<=parseFloat(A)&&(w.architecture=64);d||(d=null);D={};D.description=d;D.layout=J&&J[0];D.manufacturer=O;D.name=C;D.prerelease=Y;D.product=G;D.ua=d;D.version=C&&A;D.os=w||{architecture:null,family:null,version:null,toString:function(){return"null"}};D.parse=n;D.toString=function(){return this.description||""};D.version&&q.unshift(A);D.name&&q.unshift(C);w&&C&&(w!=String(w).split(" ")[0]||w!=C.split(" ")[0]&&!G)&&q.push(G?"("+w+")":"on "+
w);q.length&&(D.description=q.join(" "));return D}var a={"function":!0,object:!0},v=a[typeof window]&&window||this,r=a[typeof exports]&&exports;a=a[typeof module]&&module&&!module.nodeType&&module;var c=r&&a&&"object"==typeof global&&global;!c||c.global!==c&&c.window!==c&&c.self!==c||(v=c);var k=Math.pow(2,53)-1,x=/\bOpera/;c=Object.prototype;var y=c.hasOwnProperty,u=c.toString,B=n();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(v.platform=B,define(function(){return B})):r&&
a?f(B,function(d,F){r[F]=d}):v.platform=B}).call(this);
function buildIOSMeta(){for(var b=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],e=0;e<b.length;e++){var h=document.createElement("meta");h.name=b[e].name;h.content=b[e].content;var f=window.document.head.querySelector('meta[name="'+h.name+'"]');f&&f.parentNode.removeChild(f);window.document.head.appendChild(h)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);console.log(window.devicePixelRatio);console.log(window.innerWidth);console.log(window.innerHeight);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();
break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}
function iosInIframe(){try{return window.self!==window.top}catch(b){return!0}}function isIOSLessThen13(){var b=platform.os,e=b.family.toLowerCase();b=parseFloat(b.version);return"ios"===e&&13>b?!0:!1}$(document).ready(function(){platform&&"iPhone"===platform.product&&"safari"===platform.name.toLowerCase()&&isIOSLessThen13()&&!iosInIframe()&&(buildIOSFullscreenPanel(),buildIOSMeta())});
jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&"safari"===platform.name.toLowerCase()&&isIOSLessThen13()&&!iosInIframe()&&iosResize()});var s_iScaleFactor=1,s_bIsIphone=!1,s_iOffsetX,s_iOffsetY,s_bFocus=!0;
(function(b){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function trace(b){console.log(b)}function isIOS(){for(var b="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");b.length;)if(navigator.platform===b.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}
function isIpad(){var b=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!b&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:b}function isMobile(){return isIpad()?!0:jQuery.browser.mobile}
function getSize(b){var e=b.toLowerCase(),h=window.document,f=h.documentElement;if(void 0===window["inner"+b])b=f["client"+b];else if(window["inner"+b]!=f["client"+b]){var l=h.createElement("body");l.id="vpw-test-b";l.style.cssText="overflow:scroll";var m=h.createElement("div");m.id="vpw-test-d";m.style.cssText="position:absolute;top:-1000px";m.innerHTML="<style>@media("+e+":"+f["client"+b]+"px){body#vpw-test-b div#vpw-test-d{"+e+":7px!important}}</style>";l.appendChild(m);f.insertBefore(l,h.head);
b=7==m["offset"+b]?f["client"+b]:window["inner"+b];f.removeChild(l)}else b=window["inner"+b];return b}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}
function getHeightOfIOSToolbars(){var b=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<b?b:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var b=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var e=getSize("Width");s_bFocus&&_checkOrientation(e,b);var h=Math.min(b/CANVAS_HEIGHT,e/CANVAS_WIDTH),f=Math.round(CANVAS_WIDTH*h);h=Math.round(CANVAS_HEIGHT*h);if(h<b){var l=b-h;h+=l;f+=CANVAS_WIDTH/CANVAS_HEIGHT*l}else f<e&&(l=e-f,f+=l,h+=CANVAS_HEIGHT/CANVAS_WIDTH*l);l=b/2-h/2;var m=e/2-f/2,g=CANVAS_WIDTH/f;if(m*g<-EDGEBOARD_X||
l*g<-EDGEBOARD_Y)h=Math.min(b/(CANVAS_HEIGHT-2*EDGEBOARD_Y),e/(CANVAS_WIDTH-2*EDGEBOARD_X)),f=Math.round(CANVAS_WIDTH*h),h=Math.round(CANVAS_HEIGHT*h),l=(b-h)/2,m=(e-f)/2,g=CANVAS_WIDTH/f;s_iOffsetX=-1*m*g;s_iOffsetY=-1*l*g;0<=l&&(s_iOffsetY=0);0<=m&&(s_iOffsetX=0);null!==s_oGame&&s_oGame.refreshButtonPos();null!==s_oMenu&&s_oMenu.refreshButtonPos();null!==s_oLevelMenu&&s_oLevelMenu.refreshButtonPos();null!=s_oMenuSelect&&s_oMenuSelect.refreshButtonPos();s_bMobile?($("#canvas").css("width",f+"px"),
$("#canvas").css("height",h+"px")):s_oStage&&(s_oStage.canvas.width=f,s_oStage.canvas.height=h,s_iScaleFactor=Math.min(f/CANVAS_WIDTH,h/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor);0>l||(l=(b-h)/2);$("#canvas").css("top",l+"px");$("#canvas").css("left",m+"px");fullscreenHandler()}}
function _checkOrientation(b,e){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(b>e?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function createBitmap(b,e,h){var f=new createjs.Bitmap(b),l=new createjs.Shape;e&&h?l.graphics.beginFill("#fff").drawRect(0,0,e,h):l.graphics.beginFill("#ff0").drawRect(0,0,b.width,b.height);f.hitArea=l;return f}function createSprite(b,e,h,f,l,m){b=null!==e?new createjs.Sprite(b,e):new createjs.Sprite(b);e=new createjs.Shape;e.graphics.beginFill("#000000").drawRect(-h,-f,l,m);b.hitArea=e;return b}
function randomFloatBetween(b,e,h){"undefined"===typeof h&&(h=2);return parseFloat(Math.min(b+Math.random()*(e-b),e).toFixed(h))}function shuffle(b){for(var e=b.length,h,f;0!==e;)f=Math.floor(Math.random()*e),--e,h=b[e],b[e]=b[f],b[f]=h;return b}function formatTime(b,e,h){b/=1E3;var f=Math.floor(b/60);b=parseFloat(b-60*f).toFixed(h);h="";e||(h=10>f?h+("0"+f+":"):h+(f+":"));return 10>b?h+("0"+b):h+b}
function NoClickDelay(b){this.element=b;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(b){for(var e=b.length,h,f;0<e;)f=Math.floor(Math.random()*e),e--,h=b[e],b[e]=b[f],b[f]=h;return b}
NoClickDelay.prototype={handleEvent:function(b){switch(b.type){case "touchstart":this.onTouchStart(b);break;case "touchmove":this.onTouchMove(b);break;case "touchend":this.onTouchEnd(b)}},onTouchStart:function(b){b.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(b){this.moved=!0},onTouchEnd:function(b){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){b=document.elementFromPoint(b.changedTouches[0].clientX,b.changedTouches[0].clientY);3==b.nodeType&&(b=b.parentNode);var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0);b.dispatchEvent(e)}}};
(function(){function b(h){var f={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};h=h||window.event;h.type in f?document.body.className=f[h.type]:(document.body.className=this[e]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var e="hidden";e in document?document.addEventListener("visibilitychange",b):(e="mozHidden")in document?document.addEventListener("mozvisibilitychange",
b):(e="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",b):(e="msHidden")in document?document.addEventListener("msvisibilitychange",b):"onfocusin"in document?document.onfocusin=document.onfocusout=b:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=b})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(b){for(var e=window.location.search.substring(1).split("&"),h=0;h<e.length;h++){var f=e[h].split("=");if(f[0]==b)return f[1]}}function playSfxSound(b,e,h){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[b].play(),s_aSounds[b].volume(e),s_aSounds[b].loop(h),s_aSounds[b]):null}function playMusicSound(b,e,h){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aMusic[b].play(),s_aMusic[b].volume(e),s_aMusic[b].loop(h),s_aMusic[b]):null}
function stopSfxSound(b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].stop()}function stopMusicound(b){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aMusic[b].stop()}function setSfxVolume(b,e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].volume(e)}function setMusicVolume(b,e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aMusic[b].volume(e)}function setSfxMute(b,e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[b].mute(e)}
function setMusicMute(b,e){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aMusic[b].mute(e)}function isSoundPlaying(b){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?s_aSounds[b].playing():!1}function isMusicPlaying(b){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?s_aMusic[b].playing():!1}function muteAllSfx(b){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)for(var e in s_aSounds)s_aSounds[e].mute(b)}
function muteAllMusic(b){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)for(var e in s_aMusic)s_aMusic[e].mute(b)}function saveItem(b,e){s_bStorageAvailable&&localStorage.setItem(b,e)}function getItem(b){return s_bStorageAvailable?localStorage.getItem(b):null}
function fullscreenHandler(){ENABLE_FULLSCREEN&&!1!==screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut(),null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut(),null!==s_oMenuSelect&&s_oMenuSelect.resetFullscreenBut())}
if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut();null!==s_oLevelMenu&&s_oLevelMenu.resetFullscreenBut();null!==s_oMenuSelect&&s_oMenuSelect.resetFullscreenBut()});
function CSpriteLibrary(){var b={},e,h,f,l,m,g;this.init=function(p,n,a){e={};f=h=0;l=p;m=n;g=a};this.addSprite=function(p,n){if(!b.hasOwnProperty(p)){var a=new Image;b[p]=e[p]={szPath:n,oSprite:a,bLoaded:!1};h++}};this.getSprite=function(p){return b.hasOwnProperty(p)?b[p].oSprite:null};this._onSpritesLoaded=function(){h=0;m.call(g)};this._onSpriteLoaded=function(){l.call(g);++f===h&&this._onSpritesLoaded()};this.loadSprites=function(){for(var p in e)e[p].oSprite.oSpriteLibrary=this,e[p].oSprite.szKey=
p,e[p].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},e[p].oSprite.onerror=function(n){var a=n.currentTarget;setTimeout(function(){e[a.szKey].oSprite.src=e[a.szKey].szPath},500)},e[p].oSprite.src=e[p].szPath};this.setLoaded=function(p){b[p].bLoaded=!0};this.isLoaded=function(p){return b[p].bLoaded};this.getNumSprites=function(){return h}}
var CANVAS_WIDTH=1500,CANVAS_HEIGHT=768,EDGEBOARD_X=180,EDGEBOARD_Y=20,FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,FONT_GAME="TradeGothic",STATE_LOADING=0,STATE_MENU=1,STATE_MENU_SELECT=2,STATE_MENU_LEVEL=3,STATE_GAME=4,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_BUT_YES_DOWN=6,ON_PLAYER_ARRIVAL=7,ON_PLAYER_FALL=8,ON_GATE_HIDE=9,ON_GATE_CHECK_COLLISION=10,ON_READY_FOR_PLAYER_ARRIVAL=11,ON_BACK_MENU=12,ON_RESTART=13,ON_NEXT_LEVEL=14,ON_BUT_END_TWEEN_X=
15,ON_END_COUNTDOWN=16,PLAYER_ANIM_RUN=0,PLAYER_ANIM_FALL=1,PLAYER_ANIM_ARRIVAL=2,PLAYER_ANIM_LEFT=3,PLAYER_ANIM_LEFT_OUT=4,PLAYER_ANIM_RIGHT=5,PLAYER_ANIM_RIGHT_OUT=6,PLAYER_MALE="male",PLAYER_FEMALE="female",STARTING_STANDS_SCALE_BONUS=.74,NUM_LEVELS,GATE_FINAL_Y=1200,TIME_GATE_RUN_0=2600,TIME_GATE_RUN_1=800,TIME_GATE_RUN=3E3,HERO_ACCELERATION,HERO_FRICTION,MAX_HERO_SPEED,MIN_START_X=CANVAS_WIDTH/2-50,MAX_START_X=CANVAS_WIDTH/2+50,MIN_ARRIVAL_X=-300,START_X_INTERVAL=MAX_START_X-MIN_START_X,MAX_ARRIVAL_X=
CANVAS_WIDTH+300,ARRIVAL_X_INTERVAL=MAX_ARRIVAL_X-MIN_ARRIVAL_X,MIN_PLAYER_X=180,MAX_PLAYER_X=CANVAS_WIDTH-180,NUM_INTERVAL=3,DIST_X_FOR_GATE_ANIM=200,MAX_ROT_FIELD=4,NUM_COLS_PAGE_LEVEL=6,NUM_ROWS_PAGE_LEVEL=2,GAME_NAME="slalom_ski",ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION,SOUNDTRACK_VOLUME_IN_GAME=.4,TEXT_SCORE="SCORE",TEXT_TOT_SCORE="TOTAL SCORE",TEXT_LEVEL_SCORE="LEVEL SCORE",TEXT_GAME_OVER="GAME OVER",TEXT_JUMP_GATE="YOU JUMPED A GATE!",TEXT_CONGRATS="YOU WON!!",TEXT_ERR_LS="YOUR WEB BROWSER DOES NOT SUPPORT STORING SETTING LOCALLY. IN SAFARI, THE MOST COMMON CAUSE OF THIS IS USING 'PRIVATE BROWSING MODE'. SOME INFO MAY NOT SAVE OR SOME FEATURE MAY NOT WORK PROPERLY.",
TEXT_CREDITS_DEVELOPED="DEVELOPED BY",TEXT_PRELOADER_CONTINUE="START",TEXT_ARE_SURE="ARE YOU SURE?",TEXT_TIME_TRACK="TRACK TIME",TEXT_BEST_TIME="BEST TIME",TEXT_SELECT_LEVEL="SELECT A LEVEL",TEXT_LEVEL="LEVEL",TEXT_CLEARED="CLEARED",TEXT_ENCOURAGEMENT=["GREAT!","WOW","WONDERFUL"],TEXT_GO_RIGHT="GO RIGHT",TEXT_GO_LEFT="GO LEFT",TEXT_CONFIRM_CLEAR_SAVINGS="ALL YOUR SAVINGS WILL BE DELETED.ARE YOU SURE?",TEXT_HELP1_DESKTOP="USE ARROWS TO MOVE RIGHT/LEFT",TEXT_HELP1_MOBILE="USE BUTTONS TO MOVE RIGHT/LEFT",
TEXT_HELP2="GO AROUND THE SLALOM GATES IN THE SHORTEST TIME POSSIBLE",TEXT_SHARE_IMAGE="200x200.jpg",TEXT_SHARE_TITLE="Congratulations!",TEXT_SHARE_MSG1="You collected <strong>",TEXT_SHARE_MSG2=" points</strong>!<br><br>Share your score with your friends!",TEXT_SHARE_SHARE1="My score is ",TEXT_SHARE_SHARE2=" points! Can you do better";
function CPreloader(){var b,e,h,f,l,m,g,p,n;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.loadSprites();n=new createjs.Container;s_oStage.addChild(n)};this.unload=function(){n.removeAllChildren()};this._onImagesLoaded=function(){};this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};
this.attachSprites=function(){var a=new createjs.Shape;a.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n.addChild(a);a=s_oSpriteLibrary.getSprite("200x200");g=createBitmap(a);g.regX=.5*a.width;g.regY=.5*a.height;g.x=CANVAS_WIDTH/2;g.y=CANVAS_HEIGHT/2-80;n.addChild(g);p=new createjs.Shape;p.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(g.x-100,g.y-100,200,200,10);n.addChild(p);g.mask=p;a=s_oSpriteLibrary.getSprite("progress_bar");f=createBitmap(a);f.x=CANVAS_WIDTH/2-a.width/
2;f.y=CANVAS_HEIGHT/2+70;n.addChild(f);b=a.width;e=a.height;l=new createjs.Shape;l.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(f.x,f.y,1,e);n.addChild(l);f.mask=l;h=new createjs.Text("","30px "+FONT_GAME,"#fff");h.x=CANVAS_WIDTH/2;h.y=CANVAS_HEIGHT/2+120;h.textBaseline="alphabetic";h.textAlign="center";n.addChild(h);m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n.addChild(m);createjs.Tween.get(m).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(m);
n.removeChild(m)})};this.refreshLoader=function(a){h.text=a+"%";100===a&&(s_oMain._allResourcesLoaded(),h.visible=!1,f.visible=!1);l.graphics.clear();a=Math.floor(a*b/100);l.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(f.x,f.y,a,e)};this._init()}
function CMain(b){var e,h,f=0,l=0,m=STATE_LOADING,g,p,n;this.initContainer=function(){var a=document.getElementById("canvas");s_oStage=new createjs.Stage(a);s_oStage.preventSelection=!1;createjs.Touch.enable(s_oStage,!0);s_bMobile=isMobile();!1===s_bMobile&&s_oStage.enableMouseOver(20);s_iPrevTime=(new Date).getTime();createjs.Ticker.framerate=FPS;createjs.Ticker.on("tick",this._update);navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=new CSpriteLibrary;s_oLevelSettings=
new CLevelSettings;g=new CPreloader};this.setLocalStorageLevel=function(a){var v=getItem(GAME_NAME+"_level");if(null===v||v<a)s_iLastLevel=a,saveItem(GAME_NAME+"_level",s_iLastLevel)};this.setLocalStorageScore=function(a,v){saveItem(GAME_NAME+"_score_level_"+v,a)};this.setLocalStoragePlayer=function(a){saveItem(GAME_NAME+"_player",a)};this.setBestTime=function(a,v){saveItem(GAME_NAME+"_best_level_"+a,JSON.stringify(v))};this.clearLocalStorage=function(){s_iLastLevel=1;if(s_bStorageAvailable)for(var a=
0;a<localStorage.length;){var v=localStorage.key(a);-1!==v.indexOf(GAME_NAME)?localStorage.removeItem(v):a++}};this.getScoreTillLevel=function(a){if(!s_bStorageAvailable)return 0;for(var v=0,r=0;r<a-1;r++)v+=parseInt(getItem(GAME_NAME+"_score_level_"+(r+1)));return v};this.getScoreLevel=function(a){return getItem(GAME_NAME+"_score_level_"+a)};this.getSavedLevel=function(){if(!s_bStorageAvailable)return 1;var a=getItem(GAME_NAME+"_level");return null===a?1:a};this.getSavedPlayerType=function(){if(!s_bStorageAvailable)return 0;
var a=getItem(GAME_NAME+"_player");return null===a?0:a};this.getBestIntervalsPerLevel=function(a){if(!s_bStorageAvailable)return[];a=getItem(GAME_NAME+"_best_level_"+a);return null===a?[]:JSON.parse(a)};this.getTotBestTimePerLevel=function(a){if(!s_bStorageAvailable)return null;a=getItem(GAME_NAME+"_best_level_"+a);if(null===a)return null;a=JSON.parse(a);return formatTime(a[a.length-1],!1,3)};this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();this._loadImages();
e=h=!0};this.soundLoaded=function(){f++;g.refreshLoader(Math.floor(f/l*100))};this._initSounds=function(){s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",filename:"crowd_idle",loop:!1,volume:1,ingamename:"crowd_idle"});s_aSoundsInfo.push({path:"./sounds/",filename:"skiing_direction",loop:!1,volume:1,ingamename:"skiing_direction"});s_aSoundsInfo.push({path:"./sounds/",filename:"falling",loop:!1,volume:1,
ingamename:"falling"});s_aSoundsInfo.push({path:"./sounds/",filename:"countdown",loop:!1,volume:1,ingamename:"countdown"});s_aSoundsInfo.push({path:"./sounds/",filename:"go",loop:!1,volume:1,ingamename:"go"});s_aSoundsInfo.push({path:"./sounds/",filename:"arrival",loop:!1,volume:1,ingamename:"arrival"});s_aSoundsInfo.push({path:"./sounds/",filename:"hit_gate",loop:!1,volume:1,ingamename:"hit_gate"});s_aSoundsInfo.push({path:"./sounds/",filename:"skiing",loop:!1,volume:1,ingamename:"skiing"});l+=s_aSoundsInfo.length;
s_aSounds=[];for(var a=0;a<s_aSoundsInfo.length;a++)this.tryToLoadSound(s_aSoundsInfo[a],!1);s_aMusicInfo=[];s_aMusicInfo.push({path:"./sounds/",filename:"level_win",loop:!1,volume:1,ingamename:"level_win"});s_aMusicInfo.push({path:"./sounds/",filename:"game_over",loop:!1,volume:1,ingamename:"game_over"});s_aMusicInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});l+=s_aMusicInfo.length;s_aMusic=[];for(a=0;a<s_aMusicInfo.length;a++)this.tryToLoadMusic(s_aMusicInfo[a],
!1)};this.tryToLoadSound=function(a,v){setTimeout(function(){s_aSounds[a.ingamename]=new Howl({src:[a.path+a.filename+".mp3"],autoplay:!1,preload:!0,loop:a.loop,volume:a.volume,onload:s_oMain.soundLoaded,onloaderror:function(r,c){for(var k=0;k<s_aSoundsInfo.length;k++)if(r===s_aSounds[s_aSoundsInfo[k].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[k],!0);break}},onplayerror:function(r){for(var c=0;c<s_aSoundsInfo.length;c++)if(r===s_aSounds[s_aSoundsInfo[c].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[c].ingamename].once("unlock",
function(){s_aSounds[s_aSoundsInfo[c].ingamename].play()});break}}})},v?200:0)};this.tryToLoadMusic=function(a,v){setTimeout(function(){s_aMusic[a.ingamename]=new Howl({src:[a.path+a.filename+".mp3"],autoplay:!1,preload:!0,loop:a.loop,volume:a.volume,onload:s_oMain.soundLoaded,onloaderror:function(r,c){for(var k=0;k<s_aMusicInfo.length;k++)if(r===s_aMusic[s_aMusicInfo[k].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aMusicInfo[k],!0);break}},onplayerror:function(r){for(var c=0;c<s_aMusicInfo.length;c++)if(r===
s_aMusic[s_aMusicInfo[c].ingamename]._sounds[0]._id){s_aMusic[s_aMusicInfo[c].ingamename].once("unlock",function(){s_aMusic[s_aMusicInfo[c].ingamename].play();"soundtrack"===s_aMusicInfo[c].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},v?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("but_next","./sprites/but_next.png");
s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("bg_level","./sprites/bg_level.jpg");s_oSpriteLibrary.addSprite("but_female","./sprites/but_female.png");s_oSpriteLibrary.addSprite("but_male","./sprites/but_male.png");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("music_icon","./sprites/music_icon.png");s_oSpriteLibrary.addSprite("msg_box_wide","./sprites/msg_box_wide.png");
s_oSpriteLibrary.addSprite("msg_box_help","./sprites/msg_box_help.png");s_oSpriteLibrary.addSprite("msg_box_small","./sprites/msg_box_small.png");s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.jpg");s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png");s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.png");s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.png");s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.png");s_oSpriteLibrary.addSprite("but_fullscreen",
"./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("but_settings","./sprites/but_settings.png");s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.png");s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.png");s_oSpriteLibrary.addSprite("but_pause","./sprites/but_pause.png");s_oSpriteLibrary.addSprite("key_0","./sprites/key_0.png");s_oSpriteLibrary.addSprite("key_1","./sprites/key_1.png");s_oSpriteLibrary.addSprite("but_left","./sprites/but_left.png");s_oSpriteLibrary.addSprite("but_right",
"./sprites/but_right.png");s_oSpriteLibrary.addSprite("but_level","./sprites/but_level.png");s_oSpriteLibrary.addSprite("logo_menu","./sprites/logo_menu.png");s_oSpriteLibrary.addSprite("time_panel","./sprites/time_panel.png");s_oSpriteLibrary.addSprite("score_panel","./sprites/score_panel.png");s_oSpriteLibrary.addSprite("level_panel","./sprites/level_panel.png");s_oSpriteLibrary.addSprite("sponsor_0","./sprites/sponsor_0.png");s_oSpriteLibrary.addSprite("sponsor_1","./sprites/sponsor_1.png");s_oSpriteLibrary.addSprite("countdown_0",
"./sprites/countdown_0.png");s_oSpriteLibrary.addSprite("countdown_1","./sprites/countdown_1.png");s_oSpriteLibrary.addSprite("countdown_2","./sprites/countdown_2.png");s_oSpriteLibrary.addSprite("countdown_3","./sprites/countdown_3.png");s_oSpriteLibrary.addSprite("but_clear_save","./sprites/but_clear_save.png");s_oSpriteLibrary.addSprite("gate_blue-0","./sprites/gate_blue-0.png");s_oSpriteLibrary.addSprite("gate_blue-1","./sprites/gate_blue-1.png");s_oSpriteLibrary.addSprite("gate_red-0","./sprites/gate_red-0.png");
s_oSpriteLibrary.addSprite("gate_red-1","./sprites/gate_red-1.png");s_oSpriteLibrary.addSprite("interval_time","./sprites/interval_time.png");s_oSpriteLibrary.addSprite("hand_direction","./sprites/hand_direction.png");s_oSpriteLibrary.addSprite("help_male","./sprites/help_male.jpg");s_oSpriteLibrary.addSprite("help_female","./sprites/help_female.jpg");s_oSpriteLibrary.addSprite("map_bg","./sprites/map_bg.png");s_oSpriteLibrary.addSprite("map_player","./sprites/map_player.png");s_oSpriteLibrary.addSprite("parallax_0",
"./sprites/parallax_0.png");s_oSpriteLibrary.addSprite("parallax_1","./sprites/parallax_1.png");for(var a=0;87>a;a++)s_oSpriteLibrary.addSprite("field_loop_"+a,"./sprites/field_loop/field_loop_"+a+".png");for(a=0;42>a;a++)s_oSpriteLibrary.addSprite("arrive_"+a,"./sprites/arrive/arrive_"+a+".png");for(a=0;30>a;a++)s_oSpriteLibrary.addSprite("male_falling_"+a,"./sprites/player_male/falling/male_falling_"+a+".png"),s_oSpriteLibrary.addSprite("female_falling_"+a,"./sprites/player_female/falling/female_falling_"+
a+".png");for(a=0;70>a;a++)s_oSpriteLibrary.addSprite("male_arrival_"+a,"./sprites/player_male/arrival/male_arrival_"+a+".png"),s_oSpriteLibrary.addSprite("female_arrival_"+a,"./sprites/player_female/arrival/female_arrival_"+a+".png");for(a=0;19>a;a++)s_oSpriteLibrary.addSprite("male_running_"+a,"./sprites/player_male/running/male_running_"+a+".png"),s_oSpriteLibrary.addSprite("female_running_"+a,"./sprites/player_female/running/female_running_"+a+".png");for(a=0;8>a;a++)s_oSpriteLibrary.addSprite("male_left_"+
a,"./sprites/player_male/turn_left/male_left_"+a+".png"),s_oSpriteLibrary.addSprite("male_right_"+a,"./sprites/player_male/turn_right/male_right_"+a+".png"),s_oSpriteLibrary.addSprite("female_left_"+a,"./sprites/player_female/turn_left/female_left_"+a+".png"),s_oSpriteLibrary.addSprite("female_right_"+a,"./sprites/player_female/turn_right/female_right_"+a+".png");for(a=0;7>a;a++)s_oSpriteLibrary.addSprite("male_left_out_"+a,"./sprites/player_male/turn_left_out/male_left_out_"+a+".png"),s_oSpriteLibrary.addSprite("male_right_out_"+
a,"./sprites/player_male/turn_right_out/male_right_out_"+a+".png"),s_oSpriteLibrary.addSprite("female_left_out_"+a,"./sprites/player_female/turn_left_out/female_left_out_"+a+".png"),s_oSpriteLibrary.addSprite("female_right_out_"+a,"./sprites/player_female/turn_right_out/female_right_out_"+a+".png");for(a=0;45>a;a++)s_oSpriteLibrary.addSprite("help_male_"+a,"./sprites/help/help_male_"+a+".jpg"),s_oSpriteLibrary.addSprite("help_female_"+a,"./sprites/help/help_female_"+a+".jpg");l+=s_oSpriteLibrary.getNumSprites();
s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){f++;g.refreshLoader(Math.floor(f/l*100))};this._onAllImagesLoaded=function(){};this._allResourcesLoaded=function(){muteAllMusic(!s_bMusicActive);muteAllSfx(!s_bAudioActive);g.unload();try{saveItem("ls_available","ok"),s_iLastLevel=this.getSavedLevel(),s_szPlayerType=this.getSavedPlayerType()}catch(a){s_bStorageAvailable=!1}s_oSoundTrack=playMusicSound("soundtrack",1,!0);s_oMain.gotoMenu()};this.gotoMenu=function(){new CMenu;m=STATE_MENU};
this.gotoSelectPlayer=function(){new CMenuSelect;m=STATE_MENU_SELECT};this.gotoLevelMenu=function(){p=new CLevelMenu;m=STATE_MENU_LEVEL};this.gotoGame=function(){n=new CGame;m=STATE_GAME};this.levelSelected=function(a){s_iLevelSelected=a;p.unload();a>=s_iLastLevel&&(s_iLastLevel=a);s_oMain.gotoGame()};this.stopUpdateNoBlockAndTick=function(){h=!1};this.startUpdateNoBlockAndTick=function(){h=!0};this.stopUpdateNoBlock=function(){e=!1;createjs.Ticker.paused=!0};this.startUpdateNoBlock=function(){s_iPrevTime=
(new Date).getTime();e=!0;createjs.Ticker.paused=!1};this.stopUpdate=function(){e=!1;createjs.Ticker.paused=!0;$("#block_game").css("display","block");if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)muteAllSfx(!0),muteAllMusic(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();e=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)s_bAudioActive&&muteAllSfx(!1),s_bMusicActive&&muteAllMusic(!1)};this.isUpdating=function(){return e};
this._update=function(a){if(!1!==e){var v=(new Date).getTime();s_iTimeElaps=v-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=v;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,s_iCntFps=0);m===STATE_GAME&&h&&n.update();void 0!==s_oStage&&s_oStage.update(a)}};s_oMain=this;HERO_ACCELERATION=b.hero_acceleration;HERO_FRICTION=b.hero_friction;MAX_HERO_SPEED=b.max_hero_speed;ENABLE_FULLSCREEN=b.fullscreen;ENABLE_CHECK_ORIENTATION=b.check_orientation;s_bAudioActive=b.audio_enable_on_startup;
s_bMusicActive=b.music_enable_on_startup;this.initContainer()}var s_bMobile,s_bAudioActive=!0,s_bMusicActive=!0,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oSoundTrack=null,s_oDrawLayer,s_oStage,s_oMain=null,s_oSpriteLibrary,s_oLevelSettings,s_iLastLevel,s_szPlayerType,s_iLevelSelected=1,s_bFullscreen=!1,s_bStorageAvailable=!0,s_aMusicInfo,s_aSoundsInfo,s_aSounds,s_aMusic;
function CTextButton(b,e,h,f,l,m,g,p){var n,a,v,r,c,k,x,y,u,B,d;this._init=function(F,z,D,q,I,A,H,E){n=!1;r=[];c=[];d=createBitmap(D);a=D.width;v=D.height;B=new createjs.Text(q,H+"px "+I,A);B.textAlign="center";B.textBaseline="alphabetic";B.lineWidth=.9*a;B.x=D.width/2;B.y=Math.floor(D.height/2)+15;u=new createjs.Container;u.x=F;u.y=z;u.regX=D.width/2;u.regY=D.height/2;s_bMobile||(u.cursor="pointer");u.addChild(d,B);!1!==E&&s_oStage.addChild(u);this._initListener()};this.unload=function(){u.off("mousedown",
x);u.off("pressup",y);s_oStage.removeChild(u)};this.setVisible=function(F){u.visible=F};this.setAlign=function(F){B.textAlign=F};this.enable=function(){n=!1;d.filters=[];d.cache(0,0,a,v)};this.disable=function(){n=!0;var F=(new createjs.ColorMatrix).adjustSaturation(-100).adjustBrightness(40);d.filters=[new createjs.ColorMatrixFilter(F)];d.cache(0,0,a,v)};this._initListener=function(){x=u.on("mousedown",this.buttonDown);y=u.on("pressup",this.buttonRelease)};this.addEventListener=function(F,z,D){r[F]=
z;c[F]=D};this.addEventListenerWithParams=function(F,z,D,q){r[F]=z;c[F]=D;k=q};this.buttonRelease=function(){n||(playSfxSound("click",1,!1),u.scaleX=1,u.scaleY=1,r[ON_MOUSE_UP]&&r[ON_MOUSE_UP].call(c[ON_MOUSE_UP],k))};this.buttonDown=function(){n||(u.scaleX=.9,u.scaleY=.9,r[ON_MOUSE_DOWN]&&r[ON_MOUSE_DOWN].call(c[ON_MOUSE_DOWN]))};this.setPosition=function(F,z){u.x=F;u.y=z};this.changeText=function(F){B.text=F};this.setX=function(F){u.x=F};this.setY=function(F){u.y=F};this.getButtonImage=function(){return u};
this.getX=function(){return u.x};this.getY=function(){return u.y};this.getSprite=function(){return u};this._init(b,e,h,f,l,m,g,p);return this}
function CGfxButton(b,e,h,f){var l,m,g,p,n=[],a,v,r;this._init=function(c,k,x){l=!1;m=1;g=[];p=[];r=createBitmap(x);r.x=c;r.y=k;r.regX=x.width/2;r.regY=x.height/2;r.cursor="pointer";f.addChild(r);this._initListener()};this.unload=function(){r.off("mousedown",a);r.off("pressup",v);f.removeChild(r)};this.setVisible=function(c){r.visible=c};this._initListener=function(){a=r.on("mousedown",this.buttonDown);v=r.on("pressup",this.buttonRelease)};this.addEventListener=function(c,k,x){g[c]=k;p[c]=x};this.addEventListenerWithParams=
function(c,k,x,y){g[c]=k;p[c]=x;n=y};this.enable=function(){l=!1};this.disable=function(){l=!0};this.buttonRelease=function(){l||(playSfxSound("click",1,!1),r.scaleX=m,r.scaleY=m,g[ON_MOUSE_UP]&&g[ON_MOUSE_UP].call(p[ON_MOUSE_UP],n))};this.buttonDown=function(){l||(r.scaleX=.9*m,r.scaleY=.9*m,g[ON_MOUSE_DOWN]&&g[ON_MOUSE_DOWN].call(p[ON_MOUSE_DOWN],n))};this.setPosition=function(c,k){r.x=c;r.y=k};this.setX=function(c){r.x=c};this.setY=function(c){r.y=c};this.setScale=function(c){m=c;r.scaleX=r.scaleY=
c};this.getButtonImage=function(){return r};this.getX=function(){return r.x};this.getY=function(){return r.y};this._init(b,e,h)}
function CSideGfxButton(b,e,h,f,l){var m,g=e,p,n,a,v,r=[],c,k,x;this._init=function(y,u,B,d){m=!1;a=[];v=[];x=createBitmap(d);x.y=B;n=d.width;y?(x.x=-d.width,x.regX=0):(x.x=CANVAS_WIDTH+d.width,x.regX=d.width);p=x.x;x.regY=d.height/2;x.cursor="pointer";l.addChild(x);this._initListener()};this.unload=function(){x.off("mousedown",c);x.off("pressup",k);l.removeChild(x)};this.setVisible=function(y){x.visible=y};this._initListener=function(){c=x.on("mousedown",this.buttonDown);k=x.on("pressup",this.buttonRelease)};
this.addEventListener=function(y,u,B){a[y]=u;v[y]=B};this.addEventListenerWithParams=function(y,u,B,d){a[y]=u;v[y]=B;r=d};this.enable=function(){m=!1};this.disable=function(){m=!0};this.buttonRelease=function(){m||(playSfxSound("click",1,!1),x.scaleX=1,x.scaleY=1,a[ON_MOUSE_UP]&&a[ON_MOUSE_UP].call(v[ON_MOUSE_UP],r))};this.buttonDown=function(){m||(x.scaleX=.9,x.scaleY=.9,a[ON_MOUSE_DOWN]&&a[ON_MOUSE_DOWN].call(v[ON_MOUSE_DOWN],r))};this.setPosition=function(y,u){x.x=y;x.y=u};this.setX=function(y){x.x=
y};this.setY=function(y){x.y=y};this.resetX=function(){x.x=b?-n:CANVAS_WIDTH+n};this.setFinalX=function(y){g=y;p=b?g-n:g+n};this.tweenFinalX=function(){createjs.Tween.get(x).to({x:g},300,createjs.Ease.quartOut).call(function(){a[ON_BUT_END_TWEEN_X]&&a[ON_BUT_END_TWEEN_X].call(v[ON_BUT_END_TWEEN_X])})};this.tweenStartX=function(y){createjs.Tween.get(x).wait(y).to({x:p},300,createjs.Ease.quartOut)};this.getButtonImage=function(){return x};this.getX=function(){return x.x};this.getY=function(){return x.y};
this._init(b,e,h,f);return this}
function CSideToggle(b,e,h,f,l,m,g){var p,n=h,a,v,r,c;this._init=function(k,x,y,u,B){v=[];r=[];x=0;!1===k&&(x=u.width/2);var d=new createjs.SpriteSheet({images:[u],frames:{width:u.width/2,height:u.height,regX:x,regY:u.height/2},animations:{state_true:[0],state_false:[1]}});p=B;c=createSprite(d,"state_"+p,x,u.height/2,u.width/2,u.height);c.x=k?-u.width/2:CANVAS_WIDTH+u.width/2;a=c.x;c.y=y;c.stop();c.cursor="pointer";g.addChild(c);this._initListener()};this.unload=function(){c.off("mousedown",this.buttonDown);
c.off("pressup",this.buttonRelease);g.removeChild(c)};this._initListener=function(){c.on("mousedown",this.buttonDown);c.on("pressup",this.buttonRelease)};this.addEventListener=function(k,x,y){v[k]=x;r[k]=y};this.setActive=function(k){p=k;c.gotoAndStop("state_"+p)};this.buttonRelease=function(){c.scaleX=1;c.scaleY=1;playSfxSound("click",1,!1);p=!p;c.gotoAndStop("state_"+p);v[ON_MOUSE_UP]&&v[ON_MOUSE_UP].call(r[ON_MOUSE_UP],p)};this.buttonDown=function(){c.scaleX=.9;c.scaleY=.9;v[ON_MOUSE_DOWN]&&v[ON_MOUSE_DOWN].call(r[ON_MOUSE_DOWN])};
this.setPosition=function(k,x){c.x=k;c.y=x};this.setY=function(k){c.y=k};this.setFinalX=function(k){n=k};this.tweenFinalX=function(){createjs.Tween.get(c).wait(e).to({x:n},300,createjs.Ease.quartOut).call(function(){v[ON_BUT_END_TWEEN_X]&&v[ON_BUT_END_TWEEN_X].call(r[ON_BUT_END_TWEEN_X])})};this.tweenStartX=function(k){createjs.Tween.get(c).wait(k).to({x:a},300,createjs.Ease.quartOut)};this.getButtonImage=function(){return c};this._init(b,h,f,l,m)}
function CMenu(){var b,e,h,f,l,m,g,p,n,a,v,r,c,k,x,y,u,B,d,F,z=null,D=null;this._init=function(){v=!0;r=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(r);c=new CGfxButton(CANVAS_WIDTH/2+350,CANVAS_HEIGHT/2+200,s_oSpriteLibrary.getSprite("but_play"),s_oStage);c.addEventListener(ON_MOUSE_UP,this._onButPlaySingle,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){var q=s_oSpriteLibrary.getSprite("audio_icon");n=CANVAS_WIDTH;a=q.height/2+10;k=new CSideToggle(!1,0,n-s_iOffsetX,
a+s_iOffsetY,q,s_bAudioActive,s_oStage);k.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);g=CANVAS_WIDTH;p=a+q.height+10;x=new CSideToggle(!1,0,g-s_iOffsetX,p+s_iOffsetY,s_oSpriteLibrary.getSprite("music_icon"),s_bMusicActive,s_oStage);x.addEventListener(ON_MOUSE_UP,this._onMusicToggle,this);h=CANVAS_WIDTH;f=p+q.height+10;k.tweenFinalX();x.tweenFinalX()}else h=CANVAS_WIDTH,f=q.height/2+10;q=s_oSpriteLibrary.getSprite("but_credits");l=0;m=q.height/2+10;y=new CSideGfxButton(!0,l+s_iOffsetX,m+
s_iOffsetY,q,s_oStage);y.addEventListener(ON_MOUSE_UP,this._onButCreditsRelease,this);y.addEventListener(ON_BUT_END_TWEEN_X,this._onButEndTween,this);b=0;e=CANVAS_HEIGHT-q.height/2-10;u=new CSideGfxButton(!0,b+s_iOffsetX,e-s_iOffsetY,s_oSpriteLibrary.getSprite("but_clear_save"),s_oStage);u.addEventListener(ON_MOUSE_UP,this._onButClearRelease,this);q=window.document;var I=q.documentElement;z=I.requestFullscreen||I.mozRequestFullScreen||I.webkitRequestFullScreen||I.msRequestFullscreen;D=q.exitFullscreen||
q.mozCancelFullScreen||q.webkitExitFullscreen||q.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(z=!1);z&&screenfull.isEnabled&&(q=s_oSpriteLibrary.getSprite("but_fullscreen"),d=new CSideToggle(!1,200,h-s_iOffsetX,f+s_iOffsetY,q,s_bFullscreen,s_oStage),d.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this),d.tweenFinalX());q=s_oSpriteLibrary.getSprite("logo_menu");I=createBitmap(q);I.regX=q.width/2;I.x=CANVAS_WIDTH/2;I.y=40;s_oStage.addChild(I);F=new CAreYouSurePanel;F.addEventListener(ON_BUT_YES_DOWN,
this._onConfirmClear,this);s_bStorageAvailable||new CAlertSavingBox(TEXT_ERR_LS,s_oStage);B=new createjs.Shape;B.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(B);createjs.Tween.get(B).to({alpha:0},400).call(function(){B.visible=!1});y.tweenFinalX();u.tweenFinalX();setMusicVolume("soundtrack",1)};this.unload=function(){c.unload();y.unload();u.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)k.unload(),k=null,x.unload();z&&screenfull.isEnabled&&d.unload();
s_oStage.removeAllChildren();s_oMenu=null};this.refreshButtonPos=function(){if(!v){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)k.setPosition(n-s_iOffsetX,s_iOffsetY+a),x.setPosition(g-s_iOffsetX,s_iOffsetY+p);z&&screenfull.isEnabled&&d.setPosition(h-s_iOffsetX,f+s_iOffsetY);y.setPosition(l+s_iOffsetX,m+s_iOffsetY);u.setPosition(b+s_iOffsetX,e-s_iOffsetY)}};this._onButPlaySingle=function(){s_oMenu.unload();s_oMain.gotoSelectPlayer();$(s_oMain).trigger("start_session")};this._onButCreditsRelease=function(){new CCreditsPanel};
this._onButClearRelease=function(){F.show(TEXT_CONFIRM_CLEAR_SAVINGS)};this._onButEndTween=function(){v=!1};this._onAudioToggle=function(){muteAllSfx(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onMusicToggle=function(){muteAllMusic(s_bMusicActive);s_bMusicActive=!s_bMusicActive};this.resetFullscreenBut=function(){z&&screenfull.isEnabled&&d.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?D.call(window.document):z.call(window.document.documentElement);sizeHandler()};
this._onConfirmClear=function(){s_oMain.clearLocalStorage()};s_oMenu=this;this._init()}var s_oMenu=null;
function CMenuSelect(){var b,e,h,f,l,m,g=null,p=null,n,a,v,r,c,k,x;this._init=function(){x=new createjs.Container;s_oStage.addChild(x);var y=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));x.addChild(y);y=new createjs.Shape;y.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);y.alpha=.7;x.addChild(y);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){var u=s_oSpriteLibrary.getSprite("audio_icon");l=CANVAS_WIDTH;m=u.height/2+10;a=new CSideToggle(!1,0,l-s_iOffsetX,m+s_iOffsetY,u,s_bAudioActive,
s_oStage);a.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);b=CANVAS_WIDTH;e=m+u.height+10;v=new CSideToggle(!1,0,b-s_iOffsetX,e+s_iOffsetY,s_oSpriteLibrary.getSprite("music_icon"),s_bMusicActive,s_oStage);v.addEventListener(ON_MOUSE_UP,this._onMusicToggle,this);h=CANVAS_WIDTH;f=e+u.height+10;a.tweenFinalX();v.tweenFinalX()}else h=CANVAS_WIDTH,f=u.height/2+10;u=window.document;y=u.documentElement;g=y.requestFullscreen||y.mozRequestFullScreen||y.webkitRequestFullScreen||y.msRequestFullscreen;
p=u.exitFullscreen||u.mozCancelFullScreen||u.webkitExitFullscreen||u.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(g=!1);g&&screenfull.isEnabled&&(u=s_oSpriteLibrary.getSprite("but_fullscreen"),n=new CSideToggle(!1,200,h-s_iOffsetX,f+s_iOffsetY,u,s_bFullscreen,s_oStage),n.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this),n.tweenFinalX());r=new CButSelectPlayer(CANVAS_WIDTH/2+200,CANVAS_HEIGHT/2,s_oSpriteLibrary.getSprite("but_male"),s_oStage);r.addEventListener(ON_MOUSE_UP,this._onMaleSelected,
this);c=new CButSelectPlayer(CANVAS_WIDTH/2-200,CANVAS_HEIGHT/2,s_oSpriteLibrary.getSprite("but_female"),s_oStage);c.addEventListener(ON_MOUSE_UP,this._onFemaleSelected,this);k=new createjs.Shape;k.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(k);createjs.Tween.get(k).to({alpha:0},400).call(function(){k.visible=!1})};this.unload=function(){c.unload();r.unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)a.unload(),a=null,v.unload();g&&screenfull.isEnabled&&
n.unload();s_oStage.removeAllChildren();s_oMenuSelect=null};this.refreshButtonPos=function(){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)a.setPosition(l-s_iOffsetX,s_iOffsetY+m),v.setPosition(b-s_iOffsetX,s_iOffsetY+e);g&&screenfull.isEnabled&&n.setPosition(h-s_iOffsetX,f+s_iOffsetY)};this._onMaleSelected=function(){s_oMenuSelect.unload();s_szPlayerType=PLAYER_MALE;s_oMain.setLocalStoragePlayer(PLAYER_MALE);s_oMain.gotoLevelMenu()};this._onFemaleSelected=function(){s_oMenuSelect.unload();s_szPlayerType=
PLAYER_FEMALE;s_oMain.setLocalStoragePlayer(PLAYER_FEMALE);s_oMain.gotoLevelMenu()};this.resetFullscreenBut=function(){g&&screenfull.isEnabled&&n.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?p.call(window.document):g.call(window.document.documentElement);sizeHandler()};this._onAudioToggle=function(){muteAllSfx(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onMusicToggle=function(){muteAllMusic(s_bMusicActive);s_bMusicActive=!s_bMusicActive};s_oMenuSelect=this;
this._init()}var s_oMenuSelect=null;
function CGame(){var b=!1,e,h,f,l,m,g,p,n,a,v,r,c,k,x,y,u,B,d,F,z,D,q,I,A,H,E,L,N,Z,W,U,R,P,T,t,X,Y,M,J,C,G,O;this._init=function(){c=s_iLevelSelected;a=s_oMain.getScoreTillLevel(c);L=[{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0},{x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0}];var w=s_oSpriteLibrary.getSprite("bg_game");t=new createjs.Container;t.x=w.width/2;t.y=CANVAS_HEIGHT/2;t.regX=w.width/2;t.regY=420;s_oStage.addChild(t);W=createBitmap(w);W.x=
-50;t.addChild(W);U=new createjs.Container;t.addChild(U);w=createBitmap(s_oSpriteLibrary.getSprite("parallax_0"));w.x=-15;w.y=100;U.addChild(w);w=createBitmap(s_oSpriteLibrary.getSprite("parallax_1"));w.x=825;w.y=150;U.addChild(w);R=new CField(-50,131,t);R.addEventListener(ON_READY_FOR_PLAYER_ARRIVAL,this.playArrival,this);X=new createjs.Container;t.addChild(X);M=new CPlayer(CANVAS_WIDTH/2,850,X);M.addEventListener(ON_PLAYER_ARRIVAL,this._onWinLevel,this);M.addEventListener(ON_PLAYER_FALL,this._onEndLevel,
this);Y=new CCountdownController(CANVAS_WIDTH/2,CANVAS_HEIGHT/2-150,s_oStage);Y.addEventListener(ON_END_COUNTDOWN,this.startRace,this);P=new CInterface(a);T=new CMap(CANVAS_WIDTH-150,200,s_oStage);this.reset();J=new CHelpPanel;J.show();C=new CEndPanel;C.addEventListener(ON_RESTART,this.restart,this);C.addEventListener(ON_BACK_MENU,this.onExit,this);G=new CNextLevelPanel;G.addEventListener(ON_RESTART,this.restart,this);G.addEventListener(ON_BACK_MENU,this.onExit,this);G.addEventListener(ON_NEXT_LEVEL,
this._onNextLevel,this);var V=new createjs.Shape;V.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(V);createjs.Tween.get(V).to({alpha:0},400).call(function(){V.visible=!1})};this.unload=function(){b=!1;P.unload();s_oStage.removeAllChildren();s_oGame=null};this.reset=function(){f=h=n=m=l=p=!1;e=g=!0;y=F=q=D=x=r=0;k="red";Z=[];O=0;H=[];N=s_oMain.getBestIntervalsPerLevel(c);E=s_oLevelSettings.getGateInfos(c);B=0;d=E[B].time_next;u=Math.round(E.length/NUM_INTERVAL);
a=s_oMain.getScoreTillLevel(c);z=parseFloat((-200/E.length).toFixed(2));v=s_oMain.getTotBestTimePerLevel(c);null===v&&(v="00:00:00");W.y=-50;U.y=200;M.reset();P.reset(a,c,v);Y.reset();R.reset();T.reset(E.length+1);setMusicVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);$(s_oMain).trigger("start_level",c)};this.restart=function(){$(s_oMain).trigger("restart_level",c);for(var w=0;w<H.length;w++)H[w].unload();this.reset();this.startCountdown()};this.refreshButtonPos=function(){P.refreshButtonPos();T.refreshButtonPos()};
this.onKeyDown=function(w){if(!b||n||M.getCurAnim()===PLAYER_ANIM_ARRIVAL)return w.preventDefault(),!1;w||(w=window.event);M.resetMovGates();switch(w.keyCode){case 37:m=!1;l=!0;M.moveLeft(!0);break;case 39:l=!1,m=!0,M.moveRight(!0)}w.preventDefault();return!1};this.onKeyUp=function(w){if(!b||n||M.getCurAnim()===PLAYER_ANIM_ARRIVAL)return w.preventDefault(),!1;w||(w=window.event);m=l=!1;switch(w.keyCode){case 37:M.moveLeft(!1);break;case 39:M.moveRight(!1)}w.preventDefault();return!1};this.moveLeft=
function(w){!b||w&&l||n||M.getCurAnim()===PLAYER_ANIM_ARRIVAL||(l=w,M.moveLeft(w))};this.moveRight=function(w){!b||w&&m||n||M.getCurAnim()===PLAYER_ANIM_ARRIVAL||(m=w,M.moveRight(w))};this.startCountdown=function(){M.show();R.show();Y.start();b=!0};this.startRace=function(){this._spawnEnemy();f=!0};this.onExitFromHelp=function(){this.startCountdown()};this._spawnEnemy=function(){h=!0;if(B===E.length)T.reachFinalPos(d+F);else{3>B?(P.showHandCursor(e),e=!e):P.hideHandCursor();B++;var w=!1;B===E.length?
(p=w=!0,T.refreshPlayerPos(d+F,!0)):(B===E.length-2&&R.prepareSponsorsForStop(),T.refreshPlayerPos(d+F,!1));y++;y===u&&(y=0,0<N.length&&q<N.length-1&&(P.showNextInterval(q,D-N[q]),q++),Z.push(D));var V=E[B-1].final_x;w=new CGate(w,(V-MIN_ARRIVAL_X)/ARRIVAL_X_INTERVAL*START_X_INTERVAL+MIN_START_X,500,V,k,X);w.addEventListener(ON_GATE_HIDE,this.checkArrival,this);w.addEventListener(ON_GATE_CHECK_COLLISION,this.checkCollision,this);H.push(w);w=W.y+z;(new createjs.Tween.get(W)).to({y:w},d);w=U.y+1.5*
z;(new createjs.Tween.get(U)).to({y:w},d);d=E[B-1].time_next;k="red"===k?"blue":"red"}};this.checkArrival=function(w){w&&!n&&(R.readyForArrival(),playSfxSound("crowd_idle",1,!1))};this.checkCollision=function(w,V){if(!n){var S=M.getRect();if(S.intersects(w)){n=!0;f=!1;I=0;var Q=this;A=setInterval(function(){Q.tremble()},20);M.changeAnim(PLAYER_ANIM_FALL);V.playAnim(w.x>S.x?"left":"right")}else{var K=Math.abs(w.x-S.x);K<DIST_X_FOR_GATE_ANIM&&V.playAnim(w.x>S.x?"left":"right");g&&S.x<w.x||!1===g&&S.x>
w.x?(n=!0,f=!1,stopSfxSound("skiing"),this._onEndLevel(TEXT_JUMP_GATE)):(K<DIST_X_FOR_GATE_ANIM&&new CEncouragement(w.x,400,TEXT_ENCOURAGEMENT[Math.floor(Math.random()*TEXT_ENCOURAGEMENT.length)],s_oStage),K=Math.abs(K),this.refreshScore(DIST_X_FOR_GATE_ANIM-K));g=!g}X.swapChildren(V.getContainer(),M.getContainer())}};this.tremble=function(){var w=L[I];t.x+=w.x;t.y+=w.y;I++;I===L.length&&(I=0,clearInterval(A))};this.refreshScore=function(w){w=0>w?0:parseInt(w);r+=w;a+=w;P.refreshScore(a)};this.playArrival=
function(){m=l=!1;M.changeAnim(PLAYER_ANIM_ARRIVAL)};this._manageGateDepth=function(){X.sortChildren(function(w,V,S){return w.y>V.y?1:w.y<V.y?-1:0})};this.endTrack=function(){f=!1;Z[NUM_INTERVAL-1]=D;0<N.length&&P.showNextInterval(NUM_INTERVAL-1,D-N[NUM_INTERVAL-1]);(0===N.length||N[N.length-1]>D)&&s_oMain.setBestTime(c,Z)};this._onEndLevel=function(w){$(s_oMain).trigger("end_level",c);P.hideHandCursor();setTimeout(function(){M.stopAnim();R.stopAnim();for(var V=0;V<H.length;V++)H[V].stopUpdate();
C.show(a,w)},500)};this._onWinLevel=function(){$(s_oMain).trigger("end_level",c);$(s_oMain).trigger("save_score",a);c===NUM_LEVELS?setTimeout(function(){C.show(a,TEXT_CONGRATS)},500):(s_oMain.setLocalStorageLevel(c+1),setTimeout(function(){G.show(D,v,r,a,c)},500));s_oMain.setLocalStorageScore(r,c)};this._onNextLevel=function(){c++;this.reset();this.startCountdown()};this.onExit=function(){this.unload();s_oMain.gotoMenu();$(s_oMain).trigger("show_interlevel_ad");$(s_oMain).trigger("end_session");$(s_oMain).trigger("share_event",
a)};this.getPlayerX=function(){return M.getX()};this.update=function(){J.isVisible()&&J.update();if(!1!==b){f&&(D+=s_iTimeElaps,P.refreshTime(D));l&&t.rotation>-MAX_ROT_FIELD?(O-=.4,O<-MAX_ROT_FIELD&&(O=-MAX_ROT_FIELD)):m&&t.rotation<MAX_ROT_FIELD?(O+=.4,O>MAX_ROT_FIELD&&(O=MAX_ROT_FIELD)):!1===l&&!1===m&&(O/=1.1);t.rotation=O;var w=M.update();d+=w;R.update();this._manageGateDepth();for(w=0;w<H.length;w++)H[w].update();!n&&h&&(x+=s_iTimeElaps,!p&&x>d&&(x=0,F=d-E[B-1].time_next,this._spawnEnemy()))}};
s_oGame=this;this._init()}var s_oGame=null;
function CInterface(b){var e,h,f,l,m,g,p,n,a,v,r,c,k,x,y,u,B,d,F,z,D,q,I,A,H,E,L,N,Z,W,U,R=null,P=null,T,t,X,Y,M,J;this._init=function(C){if(s_bMobile){var G=s_oSpriteLibrary.getSprite("but_left");m=G.width/2+150;g=CANVAS_HEIGHT-G.height/2-50;W=createBitmap(G);W.regX=G.width/2;W.regY=G.height/2;W.x=m;W.y=g;s_oStage.addChild(W);G=s_oSpriteLibrary.getSprite("but_right");f=CANVAS_WIDTH-G.width/2-150;l=CANVAS_HEIGHT-G.height/2-50;U=createBitmap(G);U.regX=G.width/2;U.regY=G.height/2;U.x=f;U.y=l;s_oStage.addChild(U);
J=new createjs.Shape;J.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);F=J.on("mousedown",this._onHitAreaPress,this);z=J.on("click",this._onHitAreaRelease,this);s_oStage.addChild(J)}else document.onkeydown=s_oGame.onKeyDown,document.onkeyup=s_oGame.onKeyUp;G=s_oSpriteLibrary.getSprite("but_settings");var O=CANVAS_WIDTH,w=G.height/2+10;T=new CGUIExpandible(O,w,G,s_oStage);G=s_oSpriteLibrary.getSprite("but_exit");k=O;x=w+G.height+10;H=new CSideGfxButton(!1,k-s_iOffsetX,
x,G,s_oStage);H.addEventListener(ON_MOUSE_UP,this._onExit,this);G=s_oSpriteLibrary.getSprite("but_pause");e=CANVAS_WIDTH;h=x+G.height+10;Z=new CSideGfxButton(!1,e-s_iOffsetX,h,G,s_oStage);Z.addEventListener(ON_MOUSE_UP,this._onPause,this);O=100;!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(G=s_oSpriteLibrary.getSprite("audio_icon"),B=CANVAS_WIDTH,d=h+G.height+10,E=new CSideToggle(!1,O,B-s_iOffsetX,d,G,s_bAudioActive,s_oStage),E.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),O+=100,y=CANVAS_WIDTH,
u=d+G.height+10,L=new CSideToggle(!1,O,y-s_iOffsetX,u,s_oSpriteLibrary.getSprite("music_icon"),s_bMusicActive,s_oStage),L.addEventListener(ON_MOUSE_UP,this._onMusicToggle,this),p=CANVAS_WIDTH,n=u+G.height+10,O+=100):(p=CANVAS_WIDTH,n=h+G.height+10);G=window.document;w=G.documentElement;R=w.requestFullscreen||w.mozRequestFullScreen||w.webkitRequestFullScreen||w.msRequestFullscreen;P=G.exitFullscreen||G.mozCancelFullScreen||G.webkitExitFullscreen||G.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(R=!1);R&&
screenfull.isEnabled&&(G=s_oSpriteLibrary.getSprite("but_fullscreen"),N=new CSideToggle(!1,O,p-s_iOffsetX,n+s_iOffsetY,G,s_bFullscreen,s_oStage),N.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this));T.addButton(H);T.addButton(Z);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)T.addButton(E),T.addButton(L);R&&screenfull.isEnabled&&T.addButton(N);A=new CTimePanel;G=s_oSpriteLibrary.getSprite("score_panel");r=0;c=CANVAS_HEIGHT-G.height-10;Y=new createjs.Container;Y.x=r;Y.y=c;s_oStage.addChild(Y);
G=createBitmap(G);Y.addChild(G);new CTLText(Y,10,10,150,30,30,"left","#fff",FONT_GAME,1,0,0,TEXT_SCORE,!0,!0,!1,!1);I=new CTLText(Y,180,10,100,30,30,"right","#fff",FONT_GAME,1,0,0,C,!0,!0,!1,!1);C=s_oSpriteLibrary.getSprite("level_panel");a=CANVAS_WIDTH-C.width;v=CANVAS_HEIGHT-C.height-10;X=new createjs.Container;X.x=a;X.y=v;s_oStage.addChild(X);C=createBitmap(C);X.addChild(C);q=new CTLText(X,10,10,270,30,30,"right","#fff",FONT_GAME,1,0,0,TEXT_LEVEL+" "+s_iLevelSelected,!0,!0,!1,!1);M=new CHandCursor;
t=new CAreYouSurePanel;t.addEventListener(ON_BUT_YES_DOWN,this._onExitYes,this);D=new CRollingScore;this.refreshButtonPos()};this.unload=function(){H.unload();H=null;T.unload();t.unload();!1===DISABLE_SOUND_MOBILE&&(E.unload(),E=null,L.unload());R&&screenfull.isEnabled&&N.unload();s_bMobile?(J.off("mousedown",F),J.off("click",z)):(document.onkeydown=null,document.onkeyup=null);s_oStage.removeAllChildren();s_oInterface=null};this.reset=function(C,G,O){I.refreshText(C);q.refreshText(TEXT_LEVEL+" "+
G);A.reset(O)};this.refreshButtonPos=function(){A.refreshButtonPos();X.x=a-s_iOffsetX;X.y=v-s_iOffsetY;Y.x=r+s_iOffsetX;Y.y=c-s_iOffsetY;T.refreshPos();if(T.isExpanded()){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)E.setPosition(B-s_iOffsetX,s_iOffsetY+d),L.setPosition(y-s_iOffsetX,s_iOffsetY+u);R&&screenfull.isEnabled&&N.setPosition(p-s_iOffsetX,n+s_iOffsetY);H.setPosition(k-s_iOffsetX,x+s_iOffsetY);Z.setPosition(e-s_iOffsetX,h+s_iOffsetY)}else{if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)E.setY(s_iOffsetY+
d),L.setY(s_iOffsetY+u);R&&screenfull.isEnabled&&N.setY(n+s_iOffsetY);H.setY(x+s_iOffsetY);Z.setY(h+s_iOffsetY);H.resetX();Z.resetX()}s_bMobile&&(W.x=m+s_iOffsetX,W.y=g-s_iOffsetY,U.x=f-s_iOffsetX,U.y=l-s_iOffsetY)};this.refreshScore=function(C){D.rolling(I.getText(),null,C)};this.refreshTime=function(C){A.refreshTime(C)};this.showNextInterval=function(C,G){A.showNextInterval(C,G)};this.showHandCursor=function(C){M.show(C)};this.hideHandCursor=function(){M.hide()};this._onLeftDown=function(){s_oGame.moveLeft(!0)};
this._onRightDown=function(){s_oGame.moveRight(!0)};this._onHitAreaPress=function(C){C.stageX<CANVAS_WIDTH/2?s_oGame.moveLeft(!0):s_oGame.moveRight(!0)};this._onHitAreaRelease=function(C){C.stageX<CANVAS_WIDTH/2?s_oGame.moveLeft(!1):s_oGame.moveRight(!1)};this._onLeftUp=function(){s_oGame.moveLeft(!1)};this._onRightUp=function(){s_oGame.moveRight(!1)};this._onExit=function(){t.show(TEXT_ARE_SURE)};this._onAudioToggle=function(){muteAllSfx(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onMusicToggle=
function(){muteAllMusic(s_bMusicActive);s_bMusicActive=!s_bMusicActive};this._onPause=function(){s_oMain.isUpdating()?s_oMain.stopUpdateNoBlock():s_oMain.startUpdateNoBlock()};this.resetFullscreenBut=function(){R&&screenfull.isEnabled&&N.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?P.call(window.document):R.call(window.document.documentElement);sizeHandler()};this._onExitYes=function(){s_oGame.onExit()};s_oInterface=this;this._init(b);return this}var s_oInterface=null;
function CHelpPanel(){var b,e,h,f,l,m,g,p,n,a=this;this._init=function(){n=new createjs.Container;n.visible=!1;s_oStage.addChild(n);f=new createjs.Shape;f.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);h=f.on("click",function(){});n.addChild(f);var v=s_oSpriteLibrary.getSprite("msg_box_help"),r=createBitmap(v);r.regX=v.width/2;r.regY=v.height/2;r.x=CANVAS_WIDTH/2;r.y=CANVAS_HEIGHT/2;n.addChild(r);r=[];if(s_szPlayerType===PLAYER_MALE){var c="help_male_";v=s_oSpriteLibrary.getSprite("help_male")}else c=
"help_female_",v=s_oSpriteLibrary.getSprite("help_female");for(var k=0;45>k;k++)r.push(s_oSpriteLibrary.getSprite(c+k));c=r[0].width;k=r[0].height;r=new createjs.SpriteSheet({images:r,framerate:15,frames:{width:c,height:k,regX:c/2},animations:{start:0,anim:[0,r.length-1]}});g=createSprite(r,"start",c/2,0,c,k);g.x=CANVAS_WIDTH/2-230;g.y=140;n.addChild(g);e=[];s_bMobile?(r=s_oSpriteLibrary.getSprite("but_left"),c=s_oSpriteLibrary.getSprite("but_right"),k=TEXT_HELP1_MOBILE):(r=s_oSpriteLibrary.getSprite("key_0"),
c=s_oSpriteLibrary.getSprite("key_1"),k=TEXT_HELP1_DESKTOP);new CTLText(n,320,380,400,120,34,"center","#fff",FONT_GAME,1,0,0,k,!0,!1,!0,!1);new CTLText(n,780,380,400,120,34,"center","#fff",FONT_GAME,1,0,0,TEXT_HELP2,!0,!1,!0,!1);l=createBitmap(r);l.regX=r.width/2;l.regY=r.height/2;l.x=CANVAS_WIDTH/2-370;l.y=CANVAS_HEIGHT/2-60;n.addChild(l);e.push(l);m=createBitmap(c);m.regX=c.width/2;m.regY=c.height/2;m.x=CANVAS_WIDTH/2-90;m.y=CANVAS_HEIGHT/2-60;n.addChild(m);e.push(m);r=createBitmap(v);r.x=CANVAS_WIDTH/
2+230;r.y=140;r.regX=v.width/2;n.addChild(r);p=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2+180,s_oSpriteLibrary.getSprite("but_next"),n);p.addEventListener(ON_MOUSE_UP,this._onStart,this)};this.unload=function(){f.off("click",h)};this.show=function(){b=0;m.scaleX=m.scaleY=.9;g.gotoAndPlay("anim");n.alpha=0;n.visible=!0;createjs.Tween.get(n).to({alpha:1},500)};this.hide=function(){createjs.Tween.get(n).to({alpha:0},500,createjs.Ease.cubicOut).call(function(){n.visible=!1})};this._attachPlayer=function(v,
r,c,k){c=[];for(var x=0;18>x;x++)c.push(s_oSpriteLibrary.getSprite("player_running_"+x));x=c[0].width;var y=c[0].height;c=new createjs.SpriteSheet({images:c,frames:{width:x,height:y,regX:x/2,regY:y},animations:{start:0,anim:[0,c.length-1,k]}});c=createSprite(c,"start",x/2,y,x,y);c.scaleX=c.scaleY=.7;c.x=v;c.y=r;n.addChild(c);return c};this._toggleKeyAnims=function(){.9===m.scaleX?(m.scaleX=m.scaleY=1,l.scaleX=l.scaleY=.9):(l.scaleX=l.scaleY=1,m.scaleX=m.scaleY=.9)};this._onStart=function(){p.disable();
a.hide();s_oGame.onExitFromHelp()};this.isVisible=function(){return n.visible};this.update=function(){b+=s_iTimeElaps;1500<b&&(b=0,this._toggleKeyAnims())};this._init()}
function CLevelSettings(){var b;this._init=function(){b=[];b[0]=[{final_x:CANVAS_WIDTH/2+600,time_next:4E3},{final_x:CANVAS_WIDTH/2-600,time_next:3E3},{final_x:CANVAS_WIDTH/2+600,time_next:3E3},{final_x:CANVAS_WIDTH/2-600,time_next:3E3},{final_x:CANVAS_WIDTH/2+600,time_next:3E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/
2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:0}];b[1]=[{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},
{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-200,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-300,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-400,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-500,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/
2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+200,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+200,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+300,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+300,time_next:1500},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1500},
{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+300,time_next:0}];b[2]=[{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-200,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-300,time_next:1200},{final_x:CANVAS_WIDTH/2+600,time_next:1200},{final_x:CANVAS_WIDTH/
2-400,time_next:1200},{final_x:CANVAS_WIDTH/2+600,time_next:1200},{final_x:CANVAS_WIDTH/2-500,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+200,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+300,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},
{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+300,time_next:1500},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1500},{final_x:CANVAS_WIDTH/2-300,time_next:1200},{final_x:CANVAS_WIDTH/2+600,time_next:1200},{final_x:CANVAS_WIDTH/2-400,time_next:1200},{final_x:CANVAS_WIDTH/2+600,time_next:1200},{final_x:CANVAS_WIDTH/2-500,time_next:0}];b[3]=[{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/
2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-200,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-300,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-400,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/
2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+300,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-200,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-300,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-400,time_next:1500},{final_x:CANVAS_WIDTH/
2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:0}];b[4]=[{final_x:CANVAS_WIDTH/2+600,time_next:2E3},{final_x:CANVAS_WIDTH/2-600,time_next:2E3},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-100,time_next:1500},{final_x:CANVAS_WIDTH/2+1E3,time_next:1500},{final_x:CANVAS_WIDTH/2-1E3,time_next:1500},{final_x:CANVAS_WIDTH/2+900,time_next:1E3},{final_x:CANVAS_WIDTH/2-300,time_next:1500},
{final_x:CANVAS_WIDTH/2,time_next:800},{final_x:CANVAS_WIDTH/2-200,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-100,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+300,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,
time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/2+1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+300,time_next:1E3},{final_x:CANVAS_WIDTH/2-200,time_next:1500},{final_x:CANVAS_WIDTH/2+1E3,time_next:0}];b[5]=[{final_x:CANVAS_WIDTH/2+200,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/
2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2,time_next:1E3},{final_x:CANVAS_WIDTH/2+600,time_next:600},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:1E3},{final_x:CANVAS_WIDTH/2-300,time_next:1E3},{final_x:CANVAS_WIDTH/2,time_next:800},{final_x:CANVAS_WIDTH/2-200,time_next:1E3},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/
2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2-200,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/2-400,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/
2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+600,time_next:600},{final_x:CANVAS_WIDTH/2+600,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+300,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/
2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:0}];b[6]=[{final_x:CANVAS_WIDTH/2,time_next:1500},{final_x:CANVAS_WIDTH/2-1E3,time_next:1500},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2+600,time_next:600},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/
2+100,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:1E3},{final_x:CANVAS_WIDTH/2-300,time_next:1E3},{final_x:CANVAS_WIDTH/2,time_next:500},{final_x:CANVAS_WIDTH/2-200,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:500},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2,time_next:1500},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2-300,time_next:1500},{final_x:CANVAS_WIDTH/2+600,time_next:1E3},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/
2-200,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/2-400,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:1E3},{final_x:CANVAS_WIDTH/2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+600,time_next:800},{final_x:CANVAS_WIDTH/
2+500,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:1E3},{final_x:CANVAS_WIDTH/2,time_next:1E3},{final_x:CANVAS_WIDTH/2-300,time_next:1E3},{final_x:CANVAS_WIDTH/2+600,time_next:600},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:1E3},{final_x:CANVAS_WIDTH/2,time_next:1E3},{final_x:CANVAS_WIDTH/
2-300,time_next:0}];b[7]=[{final_x:CANVAS_WIDTH/2,time_next:1500},{final_x:CANVAS_WIDTH/2-200,time_next:1500},{final_x:CANVAS_WIDTH/2,time_next:1E3},{final_x:CANVAS_WIDTH/2-200,time_next:1E3},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:800},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/
2,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:800},{final_x:CANVAS_WIDTH/2-200,time_next:500},{final_x:CANVAS_WIDTH/
2+100,time_next:800},{final_x:CANVAS_WIDTH/2-200,time_next:1E3},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:800},{final_x:CANVAS_WIDTH/2+200,time_next:500},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:1200},{final_x:CANVAS_WIDTH/2-1E3,time_next:1500},{final_x:CANVAS_WIDTH/2+1E3,time_next:1500},{final_x:CANVAS_WIDTH/
2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:800},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:800},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:800},{final_x:CANVAS_WIDTH/
2,time_next:1E3},{final_x:CANVAS_WIDTH/2+1E3,time_next:1500},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:0}];b[8]=[{final_x:CANVAS_WIDTH/2+200,time_next:1500},{final_x:CANVAS_WIDTH/2-1100,time_next:1500},{final_x:CANVAS_WIDTH/2+300,time_next:1E3},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2+100,time_next:600},{final_x:CANVAS_WIDTH/2-300,time_next:800},{final_x:CANVAS_WIDTH/
2,time_next:500},{final_x:CANVAS_WIDTH/2,time_next:500},{final_x:CANVAS_WIDTH/2,time_next:500},{final_x:CANVAS_WIDTH/2+200,time_next:1E3},{final_x:CANVAS_WIDTH/2+900,time_next:600},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:800},{final_x:CANVAS_WIDTH/2+300,time_next:800},{final_x:CANVAS_WIDTH/2-600,time_next:800},{final_x:CANVAS_WIDTH/2+700,time_next:1E3},{final_x:CANVAS_WIDTH/2-1E3,time_next:800},{final_x:CANVAS_WIDTH/2+
200,time_next:800},{final_x:CANVAS_WIDTH/2-500,time_next:800},{final_x:CANVAS_WIDTH/2+700,time_next:1E3},{final_x:CANVAS_WIDTH/2-900,time_next:1E3},{final_x:CANVAS_WIDTH/2+1E3,time_next:1200},{final_x:CANVAS_WIDTH/2-1100,time_next:1200},{final_x:CANVAS_WIDTH/2+800,time_next:1E3},{final_x:CANVAS_WIDTH/2-1E3,time_next:1200},{final_x:CANVAS_WIDTH/2+1100,time_next:1200},{final_x:CANVAS_WIDTH/2-900,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:800},{final_x:CANVAS_WIDTH/2-800,time_next:1500},{final_x:CANVAS_WIDTH/
2+1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1200},{final_x:CANVAS_WIDTH/2+1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2-800,time_next:1200},{final_x:CANVAS_WIDTH/2+800,time_next:1500},{final_x:CANVAS_WIDTH/2-900,time_next:1E3},{final_x:CANVAS_WIDTH/2+800,time_next:1200},{final_x:CANVAS_WIDTH/2-900,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:1E3}];b[9]=[{final_x:CANVAS_WIDTH/2+200,time_next:1500},{final_x:CANVAS_WIDTH/2-600,time_next:1500},{final_x:CANVAS_WIDTH/
2+300,time_next:500},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2+200,time_next:500},{final_x:CANVAS_WIDTH/2+100,time_next:500},{final_x:CANVAS_WIDTH/2,time_next:800},{final_x:CANVAS_WIDTH/2-800,time_next:1E3},{final_x:CANVAS_WIDTH/2+800,time_next:600},{final_x:CANVAS_WIDTH/2+900,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:600},{final_x:CANVAS_WIDTH/
2+300,time_next:900},{final_x:CANVAS_WIDTH/2-600,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:1E3},{final_x:CANVAS_WIDTH/2-1100,time_next:1E3},{final_x:CANVAS_WIDTH/2+700,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:800},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2-100,time_next:500},{final_x:CANVAS_WIDTH/2+200,time_next:500},{final_x:CANVAS_WIDTH/2+100,time_next:500},{final_x:CANVAS_WIDTH/
2,time_next:800},{final_x:CANVAS_WIDTH/2-800,time_next:1E3},{final_x:CANVAS_WIDTH/2+800,time_next:600},{final_x:CANVAS_WIDTH/2+600,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:600},{final_x:CANVAS_WIDTH/2+300,time_next:900},{final_x:CANVAS_WIDTH/2-600,time_next:800},{final_x:CANVAS_WIDTH/2+100,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:800},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/
2+300,time_next:500},{final_x:CANVAS_WIDTH/2+200,time_next:500},{final_x:CANVAS_WIDTH/2+100,time_next:500},{final_x:CANVAS_WIDTH/2,time_next:1E3},{final_x:CANVAS_WIDTH/2+1E3,time_next:1500},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+700,time_next:1200},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+700,time_next:1200},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:0}];b[10]=[{final_x:CANVAS_WIDTH/2+200,time_next:1500},{final_x:CANVAS_WIDTH/
2-600,time_next:1E3},{final_x:CANVAS_WIDTH/2+700,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+400,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+600,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+100,time_next:500},{final_x:CANVAS_WIDTH/2+500,time_next:500},{final_x:CANVAS_WIDTH/2+700,time_next:800},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+800,time_next:1E3},{final_x:CANVAS_WIDTH/
2-900,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:800},{final_x:CANVAS_WIDTH/2-800,time_next:1200},{final_x:CANVAS_WIDTH/2+1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1E3},{final_x:CANVAS_WIDTH/2+1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2-800,time_next:1E3},{final_x:CANVAS_WIDTH/2+800,time_next:1E3},{final_x:CANVAS_WIDTH/2-900,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:800},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+700,time_next:1200},{final_x:CANVAS_WIDTH/
2-1E3,time_next:1200},{final_x:CANVAS_WIDTH/2+700,time_next:1E3},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+200,time_next:500},{final_x:CANVAS_WIDTH/2+100,time_next:500},{final_x:CANVAS_WIDTH/2+500,time_next:500},{final_x:CANVAS_WIDTH/2+400,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/
2+200,time_next:500},{final_x:CANVAS_WIDTH/2+100,time_next:500},{final_x:CANVAS_WIDTH/2,time_next:1E3},{final_x:CANVAS_WIDTH/2+1E3,time_next:1500},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+700,time_next:1200},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+700,time_next:1200},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:1E3},{final_x:CANVAS_WIDTH/2-500,time_next:1200},{final_x:CANVAS_WIDTH/2+1E3,time_next:1200},{final_x:CANVAS_WIDTH/
2-800,time_next:1200},{final_x:CANVAS_WIDTH/2+800,time_next:1200},{final_x:CANVAS_WIDTH/2-900,time_next:0}];b[11]=[{final_x:CANVAS_WIDTH/2+1E3,time_next:1500},{final_x:CANVAS_WIDTH/2-500,time_next:1200},{final_x:CANVAS_WIDTH/2+1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2-800,time_next:1E3},{final_x:CANVAS_WIDTH/2+800,time_next:1E3},{final_x:CANVAS_WIDTH/2-900,time_next:500},{final_x:CANVAS_WIDTH/2-1E3,time_next:500},{final_x:CANVAS_WIDTH/2-1E3,time_next:1200},{final_x:CANVAS_WIDTH/2+700,time_next:1E3},
{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+1E3,time_next:1100},{final_x:CANVAS_WIDTH/2-800,time_next:1E3},{final_x:CANVAS_WIDTH/2+800,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:500},{final_x:CANVAS_WIDTH/2+400,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:800},{final_x:CANVAS_WIDTH/2+1E3,time_next:1200},
{final_x:CANVAS_WIDTH/2-800,time_next:1E3},{final_x:CANVAS_WIDTH/2+800,time_next:1E3},{final_x:CANVAS_WIDTH/2-900,time_next:500},{final_x:CANVAS_WIDTH/2-1E3,time_next:500},{final_x:CANVAS_WIDTH/2-800,time_next:1200},{final_x:CANVAS_WIDTH/2+700,time_next:1E3},{final_x:CANVAS_WIDTH/2-1E3,time_next:1E3},{final_x:CANVAS_WIDTH/2+400,time_next:800},{final_x:CANVAS_WIDTH/2,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:500},{final_x:CANVAS_WIDTH/2+200,time_next:800},{final_x:CANVAS_WIDTH/2+1E3,time_next:1200},
{final_x:CANVAS_WIDTH/2-800,time_next:1E3},{final_x:CANVAS_WIDTH/2+800,time_next:1E3},{final_x:CANVAS_WIDTH/2+500,time_next:500},{final_x:CANVAS_WIDTH/2+400,time_next:500},{final_x:CANVAS_WIDTH/2+300,time_next:800},{final_x:CANVAS_WIDTH/2+1E3,time_next:1200},{final_x:CANVAS_WIDTH/2-800,time_next:2E3}];NUM_LEVELS=b.length};this.getGateInfos=function(e){return b[e-1]};this._init()}
function CLevelMenu(){var b,e,h,f,l,m,g,p,n,a,v,r,c,k,x,y,u,B,d,F,z,D,q,I=null,A=null;this._init=function(){n=!0;a=0;D=new createjs.Container;s_oStage.addChild(D);var H=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));D.addChild(H);u=new createjs.Shape;u.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);u.alpha=.5;D.addChild(u);B=new createjs.Container;B.x=CANVAS_WIDTH/2;D.addChild(B);y=s_oSpriteLibrary.getSprite("msg_box_wide");H=createBitmap(y);B.addChild(H);new CTLText(B,
y.width/2-350,50,700,70,70,"center","#fff",FONT_GAME,1,0,0,TEXT_SELECT_LEVEL,!0,!0,!1,!1);var E=s_oSpriteLibrary.getSprite("but_exit");g=CANVAS_WIDTH;p=E.height/2+10;d=new CSideGfxButton(!1,g-s_iOffsetX,p+s_iOffsetY,E,s_oStage);d.addEventListener(ON_MOUSE_UP,this._onExit,this);d.addEventListener(ON_BUT_END_TWEEN_X,this._onButEndTween,this);B.regX=y.width/2;B.regY=y.height/2;v=-y.height/2;r=E.height;H=100;!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(E=s_oSpriteLibrary.getSprite("audio_icon"),l=CANVAS_WIDTH,
m=p+E.height+10,F=new CSideToggle(!1,H,l-s_iOffsetX,m+s_iOffsetY,E,s_bAudioActive,s_oStage),F.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),b=CANVAS_WIDTH,e=m+E.height+10,z=new CSideToggle(!1,0,b-s_iOffsetX,e+s_iOffsetY,s_oSpriteLibrary.getSprite("music_icon"),s_bMusicActive,s_oStage),z.addEventListener(ON_MOUSE_UP,this._onMusicToggle,this),h=CANVAS_WIDTH,f=e+E.height+10,H+=100,F.tweenFinalX(),z.tweenFinalX()):(h=CANVAS_WIDTH,f=p+E.height+10);E=window.document;var L=E.documentElement;I=L.requestFullscreen||
L.mozRequestFullScreen||L.webkitRequestFullScreen||L.msRequestFullscreen;A=E.exitFullscreen||E.mozCancelFullScreen||E.webkitExitFullscreen||E.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(I=!1);I&&screenfull.isEnabled&&(E=s_oSpriteLibrary.getSprite("but_fullscreen"),q=new CSideToggle(!1,H,h-s_iOffsetX,f+s_iOffsetY,E,s_bFullscreen,s_oStage),q.addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this),q.tweenFinalX());this._checkBoundLimits();k=[];H=Math.floor((y.width-100)/NUM_COLS_PAGE_LEVEL)/2;for(L=
E=0;L<NUM_COLS_PAGE_LEVEL;L++)k.push(E),E+=2*H;x=[];this._createNewLevelPage(0,NUM_LEVELS);this.refreshButtonPos();u.alpha=0;B.y=v;D.visible=!0;d.tweenFinalX();createjs.Tween.get(u).to({alpha:.7},500);createjs.Tween.get(B).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.quartOut)};this.unload=function(){for(var H=0;H<c.length;H++)c[H].unload();if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)F.unload(),z.unload();I&&screenfull.isEnabled&&q.unload();d.unload();s_oStage.removeAllChildren();s_oLevelMenu=null};
this.refreshButtonPos=function(){if(!n){d.setPosition(g-s_iOffsetX,p+s_iOffsetY);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)F.setPosition(l-s_iOffsetX,s_iOffsetY+m),z.setPosition(b-s_iOffsetX,s_iOffsetY+e);I&&screenfull.isEnabled&&q.setPosition(h-s_iOffsetX,f+s_iOffsetY)}};this._checkBoundLimits=function(){for(var H=s_oSpriteLibrary.getSprite("but_level"),E=0,L=CANVAS_HEIGHT-2*EDGEBOARD_Y-2*r,N=0;E<L;)E+=H.height+20,N++;NUM_ROWS_PAGE_LEVEL>N&&(NUM_ROWS_PAGE_LEVEL=N);L=E=0;N=CANVAS_WIDTH-2*EDGEBOARD_X;
for(H=s_oSpriteLibrary.getSprite("but_level");L<N;)L+=H.width/2+5,E++;NUM_COLS_PAGE_LEVEL>E&&(NUM_COLS_PAGE_LEVEL=E)};this._createNewLevelPage=function(H,E){var L=new createjs.Container;B.addChild(L);x.push(L);c=[];for(var N=0,Z=0,W=1,U=!1,R=s_oSpriteLibrary.getSprite("but_level"),P=H;P<E;P++){var T=null;if(P+1>s_iLastLevel)var t=!1;else t=!0,T=s_oMain.getTotBestTimePerLevel(P+1);t=new CLevelBut(k[N]+R.width/4,Z+R.height/2,P+1,T,R,t,L);t.addEventListenerWithParams(ON_MOUSE_UP,this._onButLevelRelease,
this,P);c.push(t);N++;if(N===k.length&&(N=0,Z+=R.height+70,W++,W>NUM_ROWS_PAGE_LEVEL&&P!==E-1)){U=!0;break}}L.x=y.width/2;L.y=y.height/2;L.regX=L.getBounds().width/2;L.regY=L.getBounds().height/2;U&&this._createNewLevelPage(P+1,E)};this._onRight=function(){x[a].visible=!1;a++;a>=x.length&&(a=0);x[a].visible=!0};this._onLeft=function(){x[a].visible=!1;a--;0>a&&(a=x.length-1);x[a].visible=!0};this._onButLevelRelease=function(H){s_oLevelMenu.unload();s_oMain.levelSelected(H+1)};this._onAudioToggle=function(){muteAllSfx(s_bAudioActive);
s_bAudioActive=!s_bAudioActive};this._onMusicToggle=function(){muteAllMusic(s_bMusicActive);s_bMusicActive=!s_bMusicActive};this.resetFullscreenBut=function(){I&&screenfull.isEnabled&&q.setActive(s_bFullscreen)};this._onFullscreenRelease=function(){s_bFullscreen?A.call(window.document):I.call(window.document.documentElement);sizeHandler()};this._onButEndTween=function(){n=!1};this._onExit=function(){s_oLevelMenu.unload();s_oMain.gotoMenu()};s_oLevelMenu=this;this._init()}var s_oLevelMenu=null;
function CLevelBut(b,e,h,f,l,m,g){var p,n,a,v=[],r=[],c,k,x,y,u;this._init=function(d,F,z,D,q,I){n=[];a=[];u=new createjs.Container;B.addChild(u);var A=new createjs.SpriteSheet({images:[q],frames:{width:q.width/2,height:q.height,regX:q.width/2/2,regY:q.height/2},animations:{state_true:[0],state_false:[1]}});p=I;y=createSprite(A,"state_"+p,q.width/2/2,q.height/2,q.width/2,q.height);y.mouseEnabled=I;y.x=d;y.y=F;y.stop();s_bMobile||(u.cursor="pointer");u.addChild(y);v.push(y);k=new createjs.Text(z,"50px "+
FONT_GAME,"#01295b");k.x=d;k.y=F+2;k.textAlign="center";k.textBaseline="alphabetic";k.outline=3;u.addChild(k);c=new createjs.Text(z,"50px "+FONT_GAME,"#fff");c.x=d;c.y=F+2;c.textAlign="center";c.textBaseline="alphabetic";u.addChild(c);null===D&&(D=I?"00:00:000":" ");x=new CTLText(u,d-24,F+22,70,18,18,"left","#fff",FONT_GAME,1,0,0,D,!0,!0,!1,!1);I||(c.color="#b4b4b4",k.color="#365976",x.setColor("#b4b4b4"));this._initListener()};this.unload=function(){u.off("mousedown",this.buttonDown);u.off("pressup",
this.buttonRelease);u.removeChild(y)};this._initListener=function(){u.on("mousedown",this.buttonDown);u.on("pressup",this.buttonRelease)};this.viewBut=function(d){u.addChild(d)};this.addEventListener=function(d,F,z){n[d]=F;a[d]=z};this.addEventListenerWithParams=function(d,F,z,D){n[d]=F;a[d]=z;r=D};this.ifClickable=function(){return!0===u.mouseEnabled?1:0};this.setActive=function(d,F){p=F;v[d].gotoAndStop("state_"+p);v[d].mouseEnabled=!0;p?(c.color="#fff",k.color="#01295b",x.setColor("#fff")):(c.color=
"#b4b4b4",k.color="#365976",x.setColor("#b4b4b4"))};this.buttonRelease=function(){p&&(playSfxSound("click",1,!1),n[ON_MOUSE_UP]&&n[ON_MOUSE_UP].call(a[ON_MOUSE_UP],r))};this.buttonDown=function(){n[ON_MOUSE_DOWN]&&n[ON_MOUSE_DOWN].call(a[ON_MOUSE_DOWN],r)};this.setPosition=function(d,F){u.x=d;u.y=F};this.setVisible=function(d){u.visible=d};var B=g;this._init(b,e,h,f,l,m,g)}
function CCreditsPanel(){var b,e,h,f,l,m,g;this._init=function(){g=new createjs.Container;s_oStage.addChild(g);var p=new createjs.Shape;p.graphics.beginFill("rgba(0,0,0,0.7)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.addChild(p);p=s_oSpriteLibrary.getSprite("msg_box_small");b=createBitmap(p);b.regX=p.width/2;b.regY=p.height/2;b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2;g.addChild(b);l=new createjs.Shape;l.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.alpha=.01;l.on("click",
this._onLogoButRelease);g.addChild(l);p=s_oSpriteLibrary.getSprite("but_no");h=new CGfxButton(980,246,p,g);h.setScale(.6);h.addEventListener(ON_MOUSE_UP,this.unload,this);f=new createjs.Text(TEXT_CREDITS_DEVELOPED,"26px "+FONT_GAME,"#fff");f.textAlign="center";f.textBaseline="alphabetic";f.x=CANVAS_WIDTH/2;f.y=330;g.addChild(f);p=s_oSpriteLibrary.getSprite("logo_ctl");e=createBitmap(p);e.regX=p.width/2;e.regY=p.height/2;e.x=CANVAS_WIDTH/2;e.y=CANVAS_HEIGHT/2;g.addChild(e);m=new createjs.Text("www.codethislab.com",
"26px "+FONT_GAME,"#fff");m.textAlign="center";m.textBaseline="alphabetic";m.x=CANVAS_WIDTH/2;m.y=450;g.addChild(m)};this.unload=function(){l.off("click",this._onLogoButRelease);h.unload();h=null;s_oStage.removeChild(g)};this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en","_blank")};this._init()}
function CAlertSavingBox(b,e){var h,f;this._init=function(g){f=new createjs.Container;m.addChild(f);var p=new createjs.Shape;p.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);p.alpha=.5;p.on("click",function(){});f.addChild(p);p=s_oSpriteLibrary.getSprite("msg_box_small");var n=createBitmap(p);n.x=.5*CANVAS_WIDTH;n.y=.5*CANVAS_HEIGHT;n.regX=.5*p.width;n.regY=.5*p.height;f.addChild(n);new CTLText(f,CANVAS_WIDTH/2-250,300,500,250,28,"center","#fff",FONT_GAME,1,0,0,g,!0,!0,!0,!1);
h=new CSideGfxButton(!1,1025,245,s_oSpriteLibrary.getSprite("but_exit"),f);h.addEventListener(ON_MOUSE_UP,this._onButOk,this);h.tweenFinalX()};this._onButOk=function(){l.unload()};this.unload=function(){h.unload();m.removeChild(f)};var l=this;var m=e;this._init(b)}
function CAreYouSurePanel(){var b,e,h,f,l,m,g,p,n=this;this._init=function(){b=[];e=[];g=new createjs.Container;g.visible=!1;s_oStage.addChild(g);p=new createjs.Shape;p.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);p.alpha=.5;p.on("click",function(){});g.addChild(p);var a=s_oSpriteLibrary.getSprite("msg_box_small");h=createBitmap(a);h.x=CANVAS_WIDTH/2;h.y=CANVAS_HEIGHT/2;h.regX=.5*a.width;h.regY=.5*a.height;g.addChild(h);f=new CTLText(g,CANVAS_WIDTH/2-250,CANVAS_HEIGHT/2-150,
500,140,66,"center","#fff",FONT_GAME,1,0,0,TEXT_ARE_SURE,!0,!0,!0,!1);l=new CGfxButton(CANVAS_WIDTH/2+150,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_yes"),g);l.addEventListener(ON_MOUSE_UP,this._onButYes,this);m=new CGfxButton(CANVAS_WIDTH/2-150,.5*CANVAS_HEIGHT+70,s_oSpriteLibrary.getSprite("but_no"),g);m.addEventListener(ON_MOUSE_UP,this._onButNo,this)};this.addEventListener=function(a,v,r){b[a]=v;e[a]=r};this.show=function(a){f.refreshText(a);g.alpha=0;g.visible=!0;createjs.Tween.get(g).to({alpha:1},
300,createjs.Ease.quartOut).call(function(){s_oMain.stopUpdateNoBlock()})};this.hide=function(){s_oMain.startUpdateNoBlock();createjs.Tween.get(g).to({alpha:0},500,createjs.Ease.quartOut).call(function(){g.visible=!1})};this.unload=function(){m.unload();l.unload()};this._onButYes=function(){n.hide();b[ON_BUT_YES_DOWN]&&b[ON_BUT_YES_DOWN].call(e[ON_BUT_YES_DOWN])};this._onButNo=function(){n.hide()};this._init()}
function CGUIExpandible(b,e,h,f){var l,m,g,p,n;this._init=function(v,r,c,k){m=[];p=new createjs.Container;p.x=v;p.y=r;k.addChild(p);n=new createjs.Container;p.addChild(n);l=!1;g=new CSideGfxButton(!1,0,0,c,n);g.addEventListener(ON_MOUSE_UP,this._onMenu,this);g.tweenFinalX()};this.unload=function(){g.unload();f.removeChild(p)};this.refreshPos=function(){p.x=b-s_iOffsetX;p.y=e+s_iOffsetY;for(var v=0;v<m.length;v++)m[v].setFinalX(p.x)};this.addButton=function(v){m.push(v)};this._onMenu=function(){(l=
!l)?a._expand():a._collapse()};this._expand=function(){for(var v=0;v<m.length;v++)m[v].tweenFinalX()};this._collapse=function(){for(var v=100*m.length,r=0;r<m.length;r++)m[r].tweenStartX(v),v-=100};this.isExpanded=function(){return l};var a=this;this._init(b,e,h,f)}
function CField(b,e,h){var f,l,m,g,p,n,a,v,r,c,k,x,y,u=this;this._init=function(d,F){r=[];c=[];k=new createjs.Container;k.x=d;k.y=F;B.addChild(k);for(var z=[],D=0;87>D;D++){var q=s_oSpriteLibrary.getSprite("field_loop_"+D);z.push(q)}z={images:z,framerate:20,frames:{width:1600,height:q.height},animations:{start:0,anim:[0,29,"anim"],arrival:[30,86,"end"],end:86}};z=new createjs.SpriteSheet(z);y=createSprite(z,"start",0,0,1600,q.height);y.on("animationend",this._onAnimEnd,this);y.on("change",this._onAnimChange,
this);k.addChild(y);z=[];for(D=0;42>D;D++)q=s_oSpriteLibrary.getSprite("arrive_"+D),z.push(q);a=[];v=[];for(D=0;2>D;D++)q=new CSponsor(510,345,!0,k),a.push(q),q=new CSponsor(1070,345,!1,k),v.push(q);z={images:z,framerate:15,frames:{width:1600,height:539},animations:{start:0,anim:[0,41,"end"],end:42}};z=new createjs.SpriteSheet(z);x=createSprite(z,"start",0,0,1600,624);x.y=-F-18;k.addChild(x)};this.reset=function(){for(var d=0;d<a.length;d++)a[d].reset(),v[d].reset();x.visible=!1;y.framerate=20;m=
l=g=!1;n=p=0};this.show=function(){f=!1;y.gotoAndPlay("anim");g=!0};this.hide=function(){y.gotoAndStop("start");k.visible=!1};this.addEventListener=function(d,F,z){r[d]=F;c[d]=z};this.readyForArrival=function(){f=!0};this._playArrival=function(){y.framerate=15;y.gotoAndPlay("arrival")};this.stopAnim=function(){y.stop();this.stopSponsors()};this.prepareSponsorsForStop=function(){for(var d=0;d<a.length;d++)a[d].readyForRemoval(),v[d].readyForRemoval()};this.stopSponsors=function(){for(var d=0;d<a.length;d++)a[d].stopTween(),
v[d].stopTween()};this._onAnimEnd=function(d){"anim"===d.currentTarget.currentAnimation&&f&&(f=!1,u._playArrival())};this._onAnimChange=function(d){"arrival"===d.currentTarget.currentAnimation&&(75<=d.currentTarget.currentFrame&&!l?(l=!0,r[ON_READY_FOR_PLAYER_ARRIVAL]&&r[ON_READY_FOR_PLAYER_ARRIVAL].call(c[ON_READY_FOR_PLAYER_ARRIVAL])):31<=d.currentTarget.currentFrame&&!1===x.visible?(x.gotoAndPlay("anim"),x.visible=!0):81<=d.currentTarget.currentFrame&&!m&&(m=!0,s_oGame.endTrack()))};this.update=
function(){g&&(p+=s_iTimeElaps,2E3<p&&(p=0,a[n].startAnim(),v[n].startAnim(),n++,n===a.length&&(g=!1)))};var B=h;this._init(b,e)}
function CPlayer(b,e,h){var f=!1,l=!1,m=!1,g,p,n,a,v,r,c,k,x,y,u,B,d,F,z;this._init=function(q,I){a=q;v=I;k=0;r=HERO_ACCELERATION;c=MAX_HERO_SPEED;d=[];F=[];z=new createjs.Container;z.x=q;z.y=I;D.addChild(z);B=[];B[PLAYER_ANIM_RUN]=19;B[PLAYER_ANIM_FALL]=30;B[PLAYER_ANIM_ARRIVAL]=70;B[PLAYER_ANIM_LEFT]=8;B[PLAYER_ANIM_RIGHT]=8;B[PLAYER_ANIM_LEFT_OUT]=7;B[PLAYER_ANIM_RIGHT_OUT]=7;u=[];u[PLAYER_ANIM_RUN]=[];for(var A=0;A<B[PLAYER_ANIM_RUN];A++){var H=s_oSpriteLibrary.getSprite(s_szPlayerType+"_running_"+
A),E=createBitmap(H);E.visible=!1;E.regX=H.width/2;E.regY=H.height;z.addChild(E);u[PLAYER_ANIM_RUN].push(E)}u[PLAYER_ANIM_FALL]=[];for(A=0;A<B[PLAYER_ANIM_FALL];A++)H=s_oSpriteLibrary.getSprite(s_szPlayerType+"_falling_"+A),E=createBitmap(H),E.visible=!1,E.regX=H.width/2,E.regY=H.height,z.addChild(E),u[PLAYER_ANIM_FALL].push(E);u[PLAYER_ANIM_ARRIVAL]=[];for(A=0;A<B[PLAYER_ANIM_ARRIVAL];A++)H=s_oSpriteLibrary.getSprite(s_szPlayerType+"_arrival_"+A),E=createBitmap(H),E.visible=!1,E.regX=H.width/2,E.regY=
H.height,z.addChild(E),u[PLAYER_ANIM_ARRIVAL].push(E);u[PLAYER_ANIM_LEFT]=[];for(A=0;A<B[PLAYER_ANIM_LEFT];A++)H=s_oSpriteLibrary.getSprite(s_szPlayerType+"_left_"+A),E=createBitmap(H),E.visible=!1,E.regX=H.width/2,E.regY=H.height,z.addChild(E),u[PLAYER_ANIM_LEFT].push(E);u[PLAYER_ANIM_RIGHT]=[];for(A=0;A<B[PLAYER_ANIM_RIGHT];A++)H=s_oSpriteLibrary.getSprite(s_szPlayerType+"_right_"+A),E=createBitmap(H),E.visible=!1,E.regX=H.width/2,E.regY=H.height,z.addChild(E),u[PLAYER_ANIM_RIGHT].push(E);u[PLAYER_ANIM_LEFT_OUT]=
[];for(A=0;A<B[PLAYER_ANIM_LEFT_OUT];A++)H=s_oSpriteLibrary.getSprite(s_szPlayerType+"_left_out_"+A),E=createBitmap(H),E.visible=!1,E.regX=H.width/2,E.regY=H.height,z.addChild(E),u[PLAYER_ANIM_LEFT_OUT].push(E);u[PLAYER_ANIM_RIGHT_OUT]=[];for(A=0;A<B[PLAYER_ANIM_RIGHT_OUT];A++)H=s_oSpriteLibrary.getSprite(s_szPlayerType+"_right_out_"+A),E=createBitmap(H),E.visible=!1,E.regX=H.width/2,E.regY=H.height,z.addChild(E),u[PLAYER_ANIM_RIGHT_OUT].push(E);g=PLAYER_ANIM_RUN};this.addEventListener=function(q,
I,A){d[q]=I;F[q]=A};this.show=function(){p=B[g];u[g][0].visible=!0;n=0;z.visible=!0;x=z.getBounds().width-450;y=z.getBounds().height-200;playSfxSound("skiing",1,!0);f=!0};this.hide=function(){f=!1;z.visible=!1};this.reset=function(){m=l=f=!1;k=0;r=HERO_ACCELERATION;c=MAX_HERO_SPEED;z.alpha=1;z.x=a;z.y=v;for(var q=0;q<B[PLAYER_ANIM_RUN];q++)u[PLAYER_ANIM_RUN][q].visible=!1;for(q=0;q<B[PLAYER_ANIM_FALL];q++)u[PLAYER_ANIM_FALL][q].visible=!1;for(q=0;q<B[PLAYER_ANIM_ARRIVAL];q++)u[PLAYER_ANIM_ARRIVAL][q].visible=
!1;for(q=0;q<B[PLAYER_ANIM_LEFT];q++)u[PLAYER_ANIM_LEFT][q].visible=!1;for(q=0;q<B[PLAYER_ANIM_RIGHT];q++)u[PLAYER_ANIM_RIGHT][q].visible=!1;g=PLAYER_ANIM_RUN};this.changeAnim=function(q){q!==g&&(f=!1,u[g][n].visible=!1,g=q,u[g][0].visible=!0,n=0,p=B[g],f=!0,q===PLAYER_ANIM_LEFT||q===PLAYER_ANIM_RIGHT?playSfxSound("skiing_direction",1,!1):q===PLAYER_ANIM_FALL?(stopSfxSound("skiing"),playSfxSound("falling",1,!1)):q===PLAYER_ANIM_ARRIVAL&&(stopSfxSound("skiing"),playSfxSound("arrival",1,!1)))};this.playToFrame=
function(q){u[g][n].visible=!1;n=q;u[g][n].visible=!0};this.nextFrame=function(){u[g][n].visible=!1;n++;u[g][n].visible=!0};this.moveLeft=function(q){z.x===MIN_PLAYER_X?(l=!1,k=0):(q?this.changeAnim(PLAYER_ANIM_LEFT):this.changeAnim(PLAYER_ANIM_LEFT_OUT),l=q)};this.moveRight=function(q){z.x===MAX_PLAYER_X?(m=!1,k=0):(q?this.changeAnim(PLAYER_ANIM_RIGHT):this.changeAnim(PLAYER_ANIM_RIGHT_OUT),m=q)};this.resetMovGates=function(){m=l=!1};this.setAcceleration=function(q,I){r=q;c=I};this.stopAnim=function(){f=
!1};this.setY=function(q){z.y=q};this.getRect=function(){var q=-x/2;switch(g){case PLAYER_ANIM_LEFT:q+=14*n;break;case PLAYER_ANIM_LEFT_OUT:q+=14*(6-n);break;case PLAYER_ANIM_RIGHT:q+=-14*n;break;case PLAYER_ANIM_RIGHT_OUT:q+=-14*(6-n)}return new createjs.Rectangle(z.x+q,z.y-y,x,y)};this.getCurAnim=function(){return g};this.getX=function(){return z.x};this.getContainer=function(){return z};this._updateMove=function(){if(g!==PLAYER_ANIM_FALL&&g!==PLAYER_ANIM_ARRIVAL){l&&(k-=r);m&&(k+=r);z.x+=k;k*=
HERO_FRICTION;k>c&&(k=c);k<-c&&(k=-c);.1>Math.abs(k)&&(k=0);z.x+k>=MAX_PLAYER_X?(z.x=MAX_PLAYER_X,g===PLAYER_ANIM_RIGHT&&this.changeAnim(PLAYER_ANIM_RIGHT_OUT)):z.x-k<=MIN_PLAYER_X&&(z.x=MIN_PLAYER_X,g===PLAYER_ANIM_LEFT&&this.changeAnim(PLAYER_ANIM_LEFT_OUT));var q=50;q=z.x>CANVAS_WIDTH/2?q*this.easeInQuart(z.x-CANVAS_WIDTH/2,0,1,MAX_PLAYER_X-CANVAS_WIDTH/2):q*(1-this.easeOutQuart(z.x-MIN_PLAYER_X,0,1,CANVAS_WIDTH/2-MIN_PLAYER_X));z.y=v-q;z.setTransform(z.x,z.y,1,1,0,-(z.x-CANVAS_WIDTH/2)/50)}};
this.easeInQuart=function(q,I,A,H){return A*(q/=H)*q*q*q+I};this.easeOutQuart=function(q,I,A,H){return-A*((q=q/H-1)*q*q*q-1)+I};this.easeInCubic=function(q,I,A,H){return A*(q/=H)*q*q+I};this.easeOutCubic=function(q,I,A,H){return A*((q=q/H-1)*q*q+1)+I};this.update=function(){if(!1!==f){this._updateMove();if(n===p-1)switch(g){case PLAYER_ANIM_RUN:this.playToFrame(0);break;case PLAYER_ANIM_FALL:this.hide();d[ON_PLAYER_FALL]&&d[ON_PLAYER_FALL].call(F[ON_PLAYER_FALL],TEXT_GAME_OVER);break;case PLAYER_ANIM_ARRIVAL:f=
!1;d[ON_PLAYER_ARRIVAL]&&d[ON_PLAYER_ARRIVAL].call(F[ON_PLAYER_ARRIVAL]);break;case PLAYER_ANIM_LEFT_OUT:case PLAYER_ANIM_RIGHT_OUT:this.changeAnim(PLAYER_ANIM_RUN)}else this.nextFrame();var q=FPS;15<Math.abs(k)?q-=6:10<Math.abs(k)?q-=4:5<Math.abs(k)&&(q-=2);createjs.Ticker.framerate=q;return Math.abs(k)}};var D=h;this._init(b,e)}
function CGate(b,e,h,f,l,m){var g,p,n=!1,a,v,r,c,k,x,y=this,u;y=this;this._init=function(d,F,z){r=[];c=[];g=d;p=F;u=new createjs.Container;u.x=d;u.y=F;u.scaleX=u.scaleY=.05;B.addChild(u);a=135;v=366;d={images:[s_oSpriteLibrary.getSprite("gate_"+z+"-0"),s_oSpriteLibrary.getSprite("gate_"+z+"-1")],frames:[[1,1,542,366,0,0,0],[545,1,542,366,0,0,0],[1089,1,542,366,0,0,0],[1,369,542,366,0,0,0],[545,369,542,366,0,0,0],[1089,369,542,366,0,0,0],[1,737,542,366,0,0,0],[545,737,542,366,0,0,0],[1089,737,542,
366,0,0,0],[1,1105,542,366,0,0,0],[545,1105,542,366,0,0,0],[1089,1105,542,366,0,0,0],[1,1473,542,366,0,0,0],[545,1473,542,366,0,0,0],[1089,1473,542,366,0,0,0],[1,1,542,366,1,0,0],[545,1,542,366,1,0,0],[1089,1,542,366,1,0,0],[1,369,542,366,1,0,0],[545,369,542,366,1,0,0],[1089,369,542,366,1,0,0],[1,737,542,366,1,0,0],[545,737,542,366,1,0,0],[1089,737,542,366,1,0,0],[1,1105,542,366,1,0,0],[545,1105,542,366,1,0,0],[1089,1105,542,366,1,0,0]],animations:{start:0,anim_right:[0,13,"start"],anim_left:[14,
26,"start"]}};d=new createjs.SpriteSheet(d);x=new createjs.Sprite(d,"start");u.addChild(x);u.regX=271;u.regY=v;this.show()};this.addEventListener=function(d,F,z){r[d]=F;c[d]=z};this.reset=function(){u.x=g;u.y=p;u.scaleX=u.scaleY=.05;x.visible=!1};this.unload=function(){B.removeChild(u)};this.show=function(){n=!1;this.reset();y._startRun()};this._startRun=function(){x.visible=!0;u.alpha=0;u.visible=!0;(new createjs.Tween.get(u)).to({alpha:1},1200);k=(new createjs.Tween.get(u)).to({x:f},TIME_GATE_RUN,
createjs.Ease.quintIn);(new createjs.Tween.get(u)).to({y:GATE_FINAL_Y},TIME_GATE_RUN,createjs.Ease.quintIn);(new createjs.Tween.get(u)).to({scaleX:1.4,scaleY:1.4},TIME_GATE_RUN,createjs.Ease.quartIn).call(function(){y.hide()});n=!0};this.hide=function(){n=!1;u.visible=!1;r[ON_GATE_HIDE]&&r[ON_GATE_HIDE].call(c[ON_GATE_HIDE],b)};this.stopUpdate=function(){createjs.Tween.removeTweens(u);n=!1};this.playAnim=function(d){x.gotoAndPlay("anim_"+d);playSfxSound("hit_gate",1,!1)};this.getContainer=function(){return u};
this.update=function(){if(n&&k.position>.79*TIME_GATE_RUN&&(n=!1,r[ON_GATE_CHECK_COLLISION])){var d=new createjs.Rectangle(u.x-a*u.scaleX/2,u.y-v*u.scaleY,a*u.scaleX,v*u.scaleY);r[ON_GATE_CHECK_COLLISION].call(c[ON_GATE_CHECK_COLLISION],d,this)}};var B=m;this._init(e,h,l)}
function CEndPanel(){var b,e,h,f,l,m,g,p,n,a,v,r,c=this;this._init=function(){h=[];f=[];v=new createjs.Container;v.visible=!1;s_oStage.addChild(v);m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);m.alpha=0;l=m.on("click",function(){});v.addChild(m);r=new createjs.Container;r.x=CANVAS_WIDTH/2;v.addChild(r);var k=s_oSpriteLibrary.getSprite("msg_box_small"),x=createBitmap(k);r.addChild(x);g=new CTLText(r,k.width/2-250,k.height/2-140,500,60,60,"center","#ff7800",
FONT_GAME,1,0,0," ",!0,!0,!1,!1);p=new CTLText(r,k.width/2-250,k.height/2-40,500,40,40,"center","#fff",FONT_GAME,1,0,0," ",!0,!0,!1,!1);n=new CGfxButton(k.width/2-200,k.height/2+110,s_oSpriteLibrary.getSprite("but_home"),r);n.addEventListener(ON_MOUSE_UP,this._onHome,this);a=new CGfxButton(k.width/2+200,k.height/2+110,s_oSpriteLibrary.getSprite("but_restart"),r);a.addEventListener(ON_MOUSE_UP,this._onRestart,this);b=-k.height/2;r.regX=k.width/2;r.regY=k.height/2};this.unload=function(){n.unload();
a.unload();m.off("click",l)};this.addEventListener=function(k,x,y){h[k]=x;f[k]=y};this.show=function(k,x){setMusicVolume("soundtrack",0);(x===TEXT_CONGRATS?playMusicSound("level_win",1,!1):playMusicSound("game_over",1,!1)).on("end",function(){setMusicVolume("soundtrack",1)});g.refreshText(x);p.refreshText(TEXT_TOT_SCORE+": "+k);m.alpha=0;r.y=b;v.visible=!0;createjs.Tween.get(m).to({alpha:.7},500);createjs.Tween.get(r).wait(400).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.quartOut).call(function(){c.enableButtons()})};
this.hide=function(){createjs.Tween.get(r).to({y:b},500,createjs.Ease.quartOut).call(function(){v.visible=!1;h[e]&&h[e].call(f[e])})};this.enableButtons=function(){n.enable();a.enable()};this.disableButtons=function(){n.disable();a.disable()};this._onHome=function(){c.disableButtons();e=ON_BACK_MENU;c.hide()};this._onRestart=function(){c.disableButtons();$(s_oMain).trigger("show_interlevel_ad");e=ON_RESTART;c.hide()};this._init()}
function CNextLevelPanel(){var b,e,h,f,l,m,g,p,n,a,v,r,c,k,x,y,u=this;this._init=function(){h=[];f=[];x=new createjs.Container;x.visible=!1;s_oStage.addChild(x);m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);m.alpha=0;l=m.on("click",function(){});x.addChild(m);y=new createjs.Container;y.x=CANVAS_WIDTH/2;x.addChild(y);var B=s_oSpriteLibrary.getSprite("msg_box_wide"),d=createBitmap(B);y.addChild(d);p=new CTLText(y,B.width/2-350,B.height/2-240,700,80,80,"center",
"#ff7800",FONT_GAME,1,0,0," ",!0,!0,!1,!1);a=new CTLText(y,B.width/2-350,B.height/2-115,700,50,50,"center","#fff",FONT_GAME,1,0,0," ",!0,!0,!1,!1);v=new CTLText(y,B.width/2-350,B.height/2-60,700,50,50,"center","#ff7800",FONT_GAME,1,0,0," ",!0,!0,!1,!1);g=new CTLText(y,B.width/2-350,B.height/2+10,700,40,40,"center","#fff",FONT_GAME,1,0,0," ",!0,!0,!1,!1);n=new CTLText(y,B.width/2-350,B.height/2+50,700,40,40,"center","#fff",FONT_GAME,1,0,0," ",!0,!0,!1,!1);r=new CGfxButton(B.width/2-250,B.height/2+
190,s_oSpriteLibrary.getSprite("but_home"),y);r.addEventListener(ON_MOUSE_UP,this._onHome,this);c=new CGfxButton(B.width/2,B.height/2+190,s_oSpriteLibrary.getSprite("but_restart"),y);c.addEventListener(ON_MOUSE_UP,this._onRestart,this);k=new CGfxButton(B.width/2+250,B.height/2+190,s_oSpriteLibrary.getSprite("but_next"),y);k.addEventListener(ON_MOUSE_UP,this._onNext,this);b=-B.height/2;y.regX=B.width/2;y.regY=B.height/2};this.unload=function(){r.unload();c.unload();m.off("click",l)};this.addEventListener=
function(B,d,F){h[B]=d;f[B]=F};this.show=function(B,d,F,z,D){setMusicVolume("soundtrack",0);playMusicSound("level_win",1,!1).on("end",function(){setMusicVolume("soundtrack",1)});a.refreshText(TEXT_TIME_TRACK+" "+formatTime(B,!1,3));v.refreshText(TEXT_BEST_TIME+" "+d);p.refreshText(TEXT_LEVEL+" "+D+" "+TEXT_CLEARED);g.refreshText(TEXT_LEVEL_SCORE+": "+F);n.refreshText(TEXT_TOT_SCORE+": "+z);m.alpha=0;y.y=b;x.visible=!0;createjs.Tween.get(m).to({alpha:.7},500);createjs.Tween.get(y).wait(400).to({y:CANVAS_HEIGHT/
2},500,createjs.Ease.quartOut).call(function(){u.enableButtons()})};this.hide=function(){createjs.Tween.get(y).to({y:b},500,createjs.Ease.quartOut).call(function(){x.visible=!1;h[e]&&h[e].call(f[e])})};this.enableButtons=function(){r.enable();k.enable();c.enable()};this.disableButtons=function(){r.disable();k.disable();c.disable()};this._onHome=function(){u.disableButtons();e=ON_BACK_MENU;u.hide()};this._onRestart=function(){u.disableButtons();$(s_oMain).trigger("show_interlevel_ad");e=ON_RESTART;
u.hide()};this._onNext=function(){u.disableButtons();$(s_oMain).trigger("show_interlevel_ad");e=ON_NEXT_LEVEL;u.hide()};this._init()}var MS_ROLLING_SCORE=400;
function CRollingScore(){var b=null,e=null;this.rolling=function(h,f,l){b=createjs.Tween.get(h).to({text:l},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(b);h.color="#fff"}).addEventListener("change",function(){h.text=Math.floor(h.text)});null!==f&&(e=createjs.Tween.get(f).to({text:l},MS_ROLLING_SCORE,createjs.Ease.cubicOut).call(function(){createjs.Tween.removeTweens(e)}).addEventListener("change",function(){f.text=Math.floor(f.text)}))};return this}
function CCountdownController(b,e,h){var f,l,m,g,p,n=this;this._init=function(a,v){m=[];g=[];p=new createjs.Container;p.x=a;p.y=v;h.addChild(p);l=[];for(var r=0;4>r;r++){var c=s_oSpriteLibrary.getSprite("countdown_"+(4-r-1)),k=createBitmap(c);k.regX=c.width/2;k.regY=c.height/2;p.addChild(k);l.push(k)}};this.addEventListener=function(a,v,r){m[a]=v;g[a]=r};this.reset=function(){for(var a=0;a<l.length;a++)l[a].scaleX=l[a].scaleY=.1,l[a].alpha=0};this.start=function(){f=0;this._playAnim()};this._playAnim=
function(){0<f&&createjs.Tween.get(l[f-1]).to({alpha:0},300,createjs.Ease.cubicOut);f===l.length?m[ON_END_COUNTDOWN]&&m[ON_END_COUNTDOWN].call(g[ON_END_COUNTDOWN]):(createjs.Tween.get(l[f]).to({alpha:1},300,createjs.Ease.cubicOut).call(function(){f===l.length-1?playSfxSound("go",1,!1):playSfxSound("countdown",1,!1)}),createjs.Tween.get(l[f]).to({scaleX:1,scaleY:1},1E3,createjs.Ease.quartOut).call(function(){f++;n._playAnim()}))};this._init(b,e)}
function CSponsor(b,e,h,f){var l,m,g,p,n,a,v=this;this._init=function(r,c){l=!1;m=r;g=c;a=new createjs.Container;a.visible=!1;a.x=r;a.y=c;a.scaleX=a.scaleY=.1;f.addChild(a);var k=s_oSpriteLibrary.getSprite("sponsor_"+(h?0:1)),x=createBitmap(k);x.regX=k.width/2;x.regY=k.height/2;a.addChild(x);h?(x.rotation=5,p=-k.width/2):(x.rotation=-5,p=CANVAS_WIDTH+k.width/2);n=c-40};this.reset=function(){a.visible=!1;this._resetAnim()};this.startAnim=function(){a.visible=!0;a.alpha=0;(new createjs.Tween.get(a)).to({alpha:1},
1E3);(new createjs.Tween.get(a)).to({x:p,y:n},TIME_GATE_RUN,createjs.Ease.quintIn).call(function(){l?a.visible=!1:(v._resetAnim(),v.startAnim())});(new createjs.Tween.get(a)).to({scaleX:1,scaleY:1},TIME_GATE_RUN,createjs.Ease.quartIn)};this._resetAnim=function(){l=!1;a.x=m;a.y=g;a.scaleX=a.scaleY=.1};this.readyForRemoval=function(){l=!0};this.stopTween=function(){createjs.Tween.removeTweens(a)};this._init(b,e)}
function CButSelectPlayer(b,e,h,f){var l,m,g,p=[],n,a,v,r,c;this._init=function(k,x,y){l=!1;m=[];g=[];c=new createjs.Container;c.x=k;c.y=x;f.addChild(c);k=new createjs.SpriteSheet({images:[y],frames:{width:y.width/2,height:y.height,regX:y.width/2/2,regY:y.height/2},animations:{state_start:[0],state_select:[1]}});v=createSprite(k,"state_start",y.width/2/2,y.height/2,y.width/2,y.height);c.addChild(v);r=createSprite(k,"state_select",y.width/2/2,y.height/2,y.width/2,y.height);r.alpha=0;c.addChild(r);
c.cursor="pointer";f.addChild(c);this._initListener()};this.unload=function(){c.off("mousedown",n);c.off("pressup",a);f.removeChild(c)};this.setVisible=function(k){c.visible=k};this._initListener=function(){n=c.on("mousedown",this.buttonDown);a=c.on("pressup",this.buttonRelease)};this.addEventListener=function(k,x,y){m[k]=x;g[k]=y};this.addEventListenerWithParams=function(k,x,y,u){m[k]=x;g[k]=y;p=u};this.enable=function(){l=!1};this.disable=function(){l=!0};this.buttonRelease=function(){l||(l=!0,
playSfxSound("click",1,!1),createjs.Tween.get(r).to({alpha:1},500).wait(500).call(function(){m[ON_MOUSE_UP]&&m[ON_MOUSE_UP].call(g[ON_MOUSE_UP],p)}))};this.buttonDown=function(){l||m[ON_MOUSE_DOWN]&&m[ON_MOUSE_DOWN].call(g[ON_MOUSE_DOWN],p)};this.setPosition=function(k,x){c.x=k;c.y=x};this.setX=function(k){c.x=k};this.setY=function(k){c.y=k};this.getButtonImage=function(){return c};this.getX=function(){return c.x};this.getY=function(){return c.y};this._init(b,e,h)}
function CTimePanel(){var b,e,h,f,l,m;this._init=function(){var g=s_oSpriteLibrary.getSprite("time_panel");b=0;e=10;m=new createjs.Container;m.x=b;m.y=e;s_oStage.addChild(m);var p=createBitmap(g);m.addChild(p);f=new CTLText(m,40,42,150,30,30,"left","#fff",FONT_GAME,1,0,0,"00:00:00",!0,!0,!1,!1);l=new CTLText(m,40,8,150,24,24,"left","#ff7800",FONT_GAME,1,0,0," ",!0,!0,!1,!1);p=s_oSpriteLibrary.getSprite("interval_time");var n=oFade=new createjs.Shape;n.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(0,
g.height-1,p.width/2,3*p.height);m.addChild(n);h=[];for(g=0;g<NUM_INTERVAL;g++){var a=new CBestIntervalPanel(0,33,p,m);a.setMask(n);h.push(a)}};this.refreshButtonPos=function(){m.x=b+s_iOffsetX;m.y=e+s_iOffsetY};this.reset=function(g){f.refreshText("00:00:00");l.refreshText(g);for(g=0;g<NUM_INTERVAL;g++)h[g].reset()};this.refreshTime=function(g){f.refreshText(formatTime(g,!1,3))};this.showNextInterval=function(g,p){h[g].show(g+1,p)};this._init()}
function CBestIntervalPanel(b,e,h,f){var l,m,g,p,n,a;this._init=function(v,r,c){m=c.height;a=new createjs.Container;a.x=v;a.y=r;f.addChild(a);v=new createjs.SpriteSheet({images:[c],frames:{width:c.width/2,height:c.height},animations:{state_green:[0],state_red:[1]}});n=createSprite(v,"state_red",0,0,c.width/2,c.height);a.addChild(n);g=new createjs.Text("","34px "+FONT_GAME,"#fff");g.x=20;g.y=32;g.textBaseline="alphabetic";g.textAlign="center";a.addChild(g);p=new createjs.Text("","28px "+FONT_GAME,
"#fff");p.x=60;p.y=32;p.textBaseline="alphabetic";p.textAlign="left";a.addChild(p)};this.setMask=function(v){a.mask=v};this.reset=function(){a.y=e};this.show=function(v,r){l=e+m*v;var c=formatTime(Math.abs(r),!0,3);0<r?(c="+"+c,n.gotoAndStop("state_red")):(c="-"+c,n.gotoAndStop("state_green"));g.text=v;p.text=c;createjs.Tween.get(a).to({y:l},300,createjs.Ease.quartOut)};this._init(b,e,h)}
function CEncouragement(b,e,h,f){var l,m,g;this._init=function(p,n,a){l=new createjs.Container;l.x=n;l.y=a;l.alpha=0;f.addChild(l);m=new createjs.Text(p," 50px "+FONT_GAME,"#01295b");m.textAlign="center";m.outline=3;l.addChild(m);g=new createjs.Text(p," 50px "+FONT_GAME,"#fff");g.textAlign="center";l.addChild(g);var v=this;createjs.Tween.get(l).to({alpha:1},200,createjs.Ease.quadIn).call(function(){v.moveUp()})};this.moveUp=function(){var p=l.y-400,n=this;createjs.Tween.get(l).to({y:p},1500,createjs.Ease.sineIn).call(function(){n.unload()});
createjs.Tween.get(l).wait(800).to({alpha:0},500)};this.unload=function(){f.removeChild(g)};this._init(h,b,e)}
function CHandCursor(){var b,e,h,f;this._init=function(){f=new createjs.Container;f.x=CANVAS_WIDTH/2;f.y=100;f.visible=!1;s_oStage.addChild(f);h=new CTLText(f,-250,0,200,40,50,"center","#fff",FONT_GAME,1,0,0," ",!0,!0,!1,!1);h.setShadow("#000",2,2,2);b=createBitmap(s_oSpriteLibrary.getSprite("hand_direction"));b.y=50;f.addChild(b);e=createBitmap(s_oSpriteLibrary.getSprite("hand_direction"));e.y=50;e.scaleX*=-1;f.addChild(e)};this.reset=function(){b.x=0;e.x=0};this.show=function(l){l?(h.setX(150),
e.visible=!1,b.visible=!0,h.refreshText(TEXT_GO_RIGHT),b.x=0,createjs.Tween.get(b,{loop:-1}).to({x:80},500,createjs.Ease.cubicOut).to({x:0},500,createjs.Ease.cubicIn)):(h.setX(-150),e.visible=!0,b.visible=!1,h.refreshText(TEXT_GO_LEFT),e.x=0,createjs.Tween.get(e,{loop:-1}).to({x:-80},500,createjs.Ease.cubicOut).to({x:0},500,createjs.Ease.cubicIn));f.visible=!0};this.hide=function(){createjs.Tween.removeTweens(b);createjs.Tween.removeTweens(e);f.visible=!1;this.reset()};this._init()}
function CMap(b,e,h){var f,l,m,g,p,n,a;this._init=function(v,r){f=v;l=r;a=new createjs.Container;a.x=v;a.y=r;h.addChild(a);var c=s_oSpriteLibrary.getSprite("map_bg"),k=createBitmap(c);k.regX=c.width/2;a.addChild(k);k=s_oSpriteLibrary.getSprite("map_player");n=createBitmap(k);n.regX=k.width/2;n.regY=k.height/2;a.addChild(n);m=c.height;this.refreshButtonPos()};this.refreshButtonPos=function(){a.x=f-s_iOffsetX;a.y=l+s_iOffsetY};this.reset=function(v){n.y=m-30;g=Math.floor(n.y/(v+1));p=n.y};this.refreshPlayerPos=
function(v,r){p-=g;createjs.Tween.removeTweens(n);createjs.Tween.get(n).to({y:p},v).call(function(){r&&createjs.Tween.get(n).to({y:10},6E3)})};this._init(b,e)}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var b=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(b--,this._oText.font=b+"px "+this._szFont,this._oText.lineHeight=Math.round(b*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>b););this._iFontSize=b}},__verticalAlign:function(){if(this._bVerticalAlign){var b=this._oText.getBounds().height;this._oText.y-=
(b-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(b){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(b,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(b)},setVerticalAlign:function(b){this._bVerticalAlign=b},setOutline:function(b){null!==this._oText&&(this._oText.outline=b)},setShadow:function(b,e,h,f){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(b,e,h,f))},setColor:function(b){this._oText.color=b},setAlpha:function(b){this._oText.alpha=b},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},setX:function(b){this._oText.x=b},getText:function(){return this._oText},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},
refreshText:function(b){""===b&&(b=" ");null===this._oText&&this.__createText(b);this._oText.text=b;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(b,e,h,f,l,m,g,p,n,a,v,r,c,k,x,y,u){this._oContainer=b;this._x=e;this._y=h;this._iWidth=f;this._iHeight=l;this._bMultiline=y;this._iFontSize=m;this._szAlign=g;this._szColor=p;this._szFont=n;this._iPaddingH=v;this._iPaddingV=r;this._bVerticalAlign=x;this._bFitText=k;this._bDebug=u;this._oDebugShape=null;this._fLineHeightFactor=a;this._oText=null;c&&this.__createText(c)};